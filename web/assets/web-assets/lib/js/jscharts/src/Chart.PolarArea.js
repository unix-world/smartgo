// JS-Script (UM): Chart.PolarArea.js @ 2025-01-07 23:40:32 +0000
(function(){"use strict";var t=this,e=t.Chart,i=e.helpers;var s={scaleShowLabelBackdrop:true,scaleBackdropColor:"rgba(255,255,255,0.75)",scaleBeginAtZero:true,scaleBackdropPaddingY:2,scaleBackdropPaddingX:2,scaleShowLine:true,segmentShowStroke:true,segmentStrokeColor:"#fff",segmentStrokeWidth:2,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:true,animateScale:false,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>'};e.Type.extend({name:"PolarArea",defaults:s,initialize:function(t){this.segments=[];this.SegmentArc=e.Arc.extend({showStroke:this.options.segmentShowStroke,strokeWidth:this.options.segmentStrokeWidth,strokeColor:this.options.segmentStrokeColor,ctx:this.chart.ctx,innerRadius:0,x:this.chart.width/2,y:this.chart.height/2});this.scale=new e.RadialScale({display:this.options.showScale,fontStyle:this.options.scaleFontStyle,fontSize:this.options.scaleFontSize,fontFamily:this.options.scaleFontFamily,fontColor:this.options.scaleFontColor,showLabels:this.options.scaleShowLabels,showLabelBackdrop:this.options.scaleShowLabelBackdrop,backdropColor:this.options.scaleBackdropColor,backdropPaddingY:this.options.scaleBackdropPaddingY,backdropPaddingX:this.options.scaleBackdropPaddingX,lineWidth:this.options.scaleShowLine?this.options.scaleLineWidth:0,lineColor:this.options.scaleLineColor,lineArc:true,width:this.chart.width,height:this.chart.height,xCenter:this.chart.width/2,yCenter:this.chart.height/2,ctx:this.chart.ctx,templateString:this.options.scaleLabel,valuesCount:t.length});this.updateScaleRange(t);this.scale.update();i.each(t,function(t,e){this.addData(t,e,true)},this);if(this.options.showTooltips){i.bindEvents(this,this.options.tooltipEvents,function(t){var e=t.type!=="mouseout"?this.getSegmentsAtEvent(t):[];i.each(this.segments,function(t){t.restore(["fillColor"])});i.each(e,function(t){t.fillColor=t.highlightColor});this.showTooltip(e)})}this.render()},getSegmentsAtEvent:function(t){var e=[];var s=i.getRelativePosition(t);i.each(this.segments,function(t){if(t.inRange(s.x,s.y)){e.push(t)}},this);return e},addData:function(t,e,s){var i=e||this.segments.length;this.segments.splice(i,0,new this.SegmentArc({fillColor:t.color,highlightColor:t.highlight||t.color,label:t.label,value:t.value,outerRadius:this.options.animateScale?0:this.scale.calculateCenterOffset(t.value),circumference:this.options.animateRotate?0:this.scale.getCircumference(),startAngle:Math.PI*1.5}));if(!s){this.reflow();this.update()}},removeData:function(t){var e=i.isNumber(t)?t:this.segments.length-1;this.segments.splice(e,1);this.reflow();this.update()},calculateTotal:function(t){this.total=0;i.each(t,function(t){this.total+=t.value},this);this.scale.valuesCount=this.segments.length},updateScaleRange:function(t){var e=[];i.each(t,function(t){e.push(t.value)});var s=this.options.scaleOverride?{steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}:i.calculateScaleRange(e,i.min([this.chart.width,this.chart.height])/2,this.options.scaleFontSize,this.options.scaleBeginAtZero,this.options.scaleIntegersOnly);i.extend(this.scale,s,{size:i.min([this.chart.width,this.chart.height]),xCenter:this.chart.width/2,yCenter:this.chart.height/2})},update:function(){this.calculateTotal(this.segments);i.each(this.segments,function(t){t.save()});this.render()},reflow:function(){i.extend(this.SegmentArc.prototype,{x:this.chart.width/2,y:this.chart.height/2});this.updateScaleRange(this.segments);this.scale.update();i.extend(this.scale,{xCenter:this.chart.width/2,yCenter:this.chart.height/2});i.each(this.segments,function(t){t.update({outerRadius:this.scale.calculateCenterOffset(t.value)})},this)},draw:function(t){var s=t||1;this.clear();i.each(this.segments,function(t,e){t.transition({circumference:this.scale.getCircumference(),outerRadius:this.scale.calculateCenterOffset(t.value)},s);t.endAngle=t.startAngle+t.circumference;if(e===0){t.startAngle=Math.PI*1.5}if(e<this.segments.length-1){this.segments[e+1].startAngle=t.endAngle}t.draw()},this);this.scale.draw()}})}).call(this);
// #END
