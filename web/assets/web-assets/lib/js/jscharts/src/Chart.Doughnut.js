// JS-Script (UM): Chart.Doughnut.js @ 2025-01-07 23:40:32 +0000
(function(){"use strict";var t=this,e=t.Chart,s=e.helpers;var i={segmentShowStroke:true,segmentStrokeColor:"#fff",segmentStrokeWidth:2,percentageInnerCutout:50,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:true,animateScale:false,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>'};e.Type.extend({name:"Doughnut",defaults:i,initialize:function(t){this.segments=[];this.outerRadius=(s.min([this.chart.width,this.chart.height])-this.options.segmentStrokeWidth/2)/2;this.SegmentArc=e.Arc.extend({ctx:this.chart.ctx,x:this.chart.width/2,y:this.chart.height/2});if(this.options.showTooltips){s.bindEvents(this,this.options.tooltipEvents,function(t){var e=t.type!=="mouseout"?this.getSegmentsAtEvent(t):[];s.each(this.segments,function(t){t.restore(["fillColor"])});s.each(e,function(t){t.fillColor=t.highlightColor});this.showTooltip(e)})}this.calculateTotal(t);s.each(t,function(t,e){this.addData(t,e,true)},this);this.render()},getSegmentsAtEvent:function(t){var e=[];var i=s.getRelativePosition(t);s.each(this.segments,function(t){if(t.inRange(i.x,i.y)){e.push(t)}},this);return e},addData:function(t,e,i){var s=e||this.segments.length;this.segments.splice(s,0,new this.SegmentArc({value:t.value,outerRadius:this.options.animateScale?0:this.outerRadius,innerRadius:this.options.animateScale?0:this.outerRadius/100*this.options.percentageInnerCutout,fillColor:t.color,highlightColor:t.highlight||t.color,showStroke:this.options.segmentShowStroke,strokeWidth:this.options.segmentStrokeWidth,strokeColor:this.options.segmentStrokeColor,startAngle:Math.PI*1.5,circumference:this.options.animateRotate?0:this.calculateCircumference(t.value),label:t.label}));if(!i){this.reflow();this.update()}},calculateCircumference:function(t){return Math.PI*2*(t/this.total)},calculateTotal:function(t){this.total=0;s.each(t,function(t){this.total+=t.value},this)},update:function(){this.calculateTotal(this.segments);s.each(this.activeElements,function(t){t.restore(["fillColor"])});s.each(this.segments,function(t){t.save()});this.render()},removeData:function(t){var e=s.isNumber(t)?t:this.segments.length-1;this.segments.splice(e,1);this.reflow();this.update()},reflow:function(){s.extend(this.SegmentArc.prototype,{x:this.chart.width/2,y:this.chart.height/2});this.outerRadius=(s.min([this.chart.width,this.chart.height])-this.options.segmentStrokeWidth/2)/2;s.each(this.segments,function(t){t.update({outerRadius:this.outerRadius,innerRadius:this.outerRadius/100*this.options.percentageInnerCutout})},this)},draw:function(t){var i=t?t:1;this.clear();s.each(this.segments,function(t,e){t.transition({circumference:this.calculateCircumference(t.value),outerRadius:this.outerRadius,innerRadius:this.outerRadius/100*this.options.percentageInnerCutout},i);t.endAngle=t.startAngle+t.circumference;t.draw();if(e===0){t.startAngle=Math.PI*1.5}if(e<this.segments.length-1){this.segments[e+1].startAngle=t.endAngle}},this)}});e.types.Doughnut.extend({name:"Pie",defaults:s.merge(i,{percentageInnerCutout:0})})}).call(this);
// #END
