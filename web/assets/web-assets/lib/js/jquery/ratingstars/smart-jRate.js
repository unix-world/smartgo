// JS-Script (UM): smart-jRate.js @ 2023-12-03 00:04:21 +0000
const smartjRate=(t,e)=>{const o=console;const s="ERROR:";const n="Rating Stars";if(typeof t=="undefined"){o.error(s,n,"Page is undefined");return}if(typeof e=="undefined"){o.error(s,n,"URL is undefined");return}const C=jQuery;const h=smartJ$Utils;const w=h.stringPureVal;const E=h.escape_html;const r=h.stringContains;const b=h.format_number_dec;const F=h.format_number_int;const l=smartJ$CryptoHash.sha512;const a=smartJ$Browser;const c=a.GrowlNotificationAdd;const g=a.AjaxRequestFromURL;const f=a.getCookie;const u=a.setCookie;const d=w(e,true);if(d==""){o.warn(s,n,"URL is Empty");return}if(r(d,"//",0)){o.warn(s,n,"URL is Disallowed");return}const m=w(t,true);if(m==""){o.warn(s,n,"Area is Empty");return}const D=e=>{const s="*Ratings";const n="Ratings_"+l(d);const t=w(f(n),true);const r=l(location.href||"");const a="lib/framework/img/";if(t===r){c(String(s),"<h5>Already Rated ...</h5>",a+"sign-notice.svg",2500,false,"light");return}let i=false;g(String(d),"POST","json",{frm:{"form:action":"rating-stars","form#url":String(m),"rating/value":String(e)}}).done(t=>{if(t&&t.status&&t.status==="OK"){c(String(s),t.message||"",a+"sign-ok.svg",3e3,false,"info");i=true}else{if(t.status=="WARN"){c(String(s),"<h5>"+(t.message||"")+"</h5>",a+"sign-notice.svg",2500,false,"light");i=true}else{o.warn("ERR:",t.status,C("<div>"+String(t.message||"")+"</div>").text(),"rating:",e);c(String(s)+(t.status||""),t.message||"",a+"sign-warn.svg",3500,false,"colored")}}if(!!i){u(n,r)}}).fail(t=>{o.warn("FAIL:","Rating Failed: Invalid Server Response !",t.status||0,"rating:",e);c("Request FAILED","Invalid Server Response !",a+"sign-error.svg",3500,false,"error")})};const y=(t,e,s,n,r,a,i,o,l,c)=>{setTimeout(()=>{C("#"+String(e)+" > div#"+String(s)).jRate({readOnly:!n,rating:r,transparency:1,backgroundColor:String(a),strokeColor:String(a),startColor:String(i),endColor:String(o),width:l,height:l,precision:.1,minSelected:.1,onSet:c})},t)};C(".rating-stars").each((t,e)=>{$el=C(e);let s=b($el.text(),2,false,false);if(s<0){s=0}else if(s>5){s=5}let n=F($el.attr("data-stars")||"",false);if(n<16||n>96){n=32}let r="#E9EDCA";let a="#5E6885";let i="#4D5774";const o=w($el.attr("data-count")||"",true);let l=false;const c=w($el.attr("data-ratings")||"",true);const g=w($el.attr("data-color")||"",true);if(g=="alt"){r="#CCDDEE";a="#FF4173";i="#FF5273"}switch(c.toLowerCase()){case"true":case"yes":case"1":l=true;break;default:l=false}let f=null;if(!!l){r="#EDEDED";a="#FFDD00";i="#FFCC00";f=D}let u=0;let d="";let m="";const p="Rating";const R="Votes";if(o!=""){u=F(o,false);m=" ; "+E(R)+": "+E(o);d="&nbsp;&middot;&nbsp;"+R+":&nbsp;"+u}const S="rating-stars-area-"+h.uuid().toLowerCase();const v="jRate-stars-"+h.uuid().toLowerCase();$el.parent().append('<div id="'+E(S)+'" class="rating-stars-area" title="'+E(p)+": "+E(s)+m+'"><div id="'+E(v)+'"></div><span>&nbsp;'+E(p)+":&nbsp;<span>"+b(s,1,false,true)+"&nbsp;/&nbsp;5"+d+"</span></span></div>");y(250,S,v,l,s,r,a,i,n,f)})};
// #END
