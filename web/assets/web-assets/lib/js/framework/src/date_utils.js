// JS-Script (UM): date_utils.js @ 2024-01-09 00:38:56 +0000
const smartJ$Date=new class{constructor(){"use strict";const t="smartJ$Date";const e=this;const n=console;let r=false;e.secureClass=()=>{if(r===true){n.warn(t,"Class is already SECURED")}else{r=true;Object.freeze(e)}};const y=smartJ$Utils;const a=(t,e,n)=>{t=y.format_number_int(t);e=y.format_number_int(e,false);n=y.format_number_int(n,false);return D({year:t,month:e,day:n})};e.createSafeDate=a;const o=function(e){if(e instanceof Date){let t=e;e=null;e={year:t.getFullYear(),month:t.getMonth()+1,day:t.getDate()};t=null}return D(e)};e.standardizeDate=o;const s=function(e,n=false){if(e instanceof Date){let t=e;e=null;e={year:t.getFullYear(),month:t.getMonth()+1,day:t.getDate()};if(n===true){e.hour=t.getHours()||0;e.minute=t.getMinutes()||0;e.second=t.getSeconds()||0}t=null}if(n!==true){e=D(e)}const t=t=>{if(t<1){t=1}if(t<10){t="0"+String(t)}return String(t)};const r=t=>{if(t<0){t=0}if(t<10){t="0"+String(t)}return String(t)};let a=String(e.year);let o=String(t(e.month));let s=String(t(e.day));if(n===true){return String(a+"-"+o+"-"+s+" "+r(e.hour||0)+":"+r(e.minute||0)+":"+r(e.second||0))}else{return String(a+"-"+o+"-"+s)}};e.getIsoDate=s;const l=function(t,e){let n=_(t.year,t.month,t.day);let r=_(e.year,e.month,e.day);return r-n};e.calculateDaysOffset=l;const u=(t,e)=>(e.year-t.year)*12+(e.month-t.month);e.calculateMonthsOffset=u;const i=function(t,e){e=y.format_number_int(e);let n=D(t);n.year+=e;n=b(n);return n};e.addYears=i;const c=function(t,e){e=y.format_number_int(e);let n=D(t);n.month+=e;const r=function(t){let e=S(t.month);t.year+=e;t.month-=e*12;return t};n=r(n);n=b(n);return n};e.addMonths=c;const f=function(t,e){e=y.format_number_int(e);let n=D(t);let r=_(n.year,n.month,n.day);return w(r+e)};e.addDays=f;const m=function(t){t=y.format_number_int(t);let e=true;if(t%4!==0){e=false}else if(t%400==0){e=true}else if(t%100==0){e=false}return e};e.isLeapYear=m;const h=function(t,e){t=y.format_number_int(t);e=y.format_number_int(e);const n=[31,28,31,30,31,30,31,31,30,31,30,31];let r=n[e-1];if(e===2&&m(t)){r=29}return r};e.daysInMonth=h;const d=function(n,t,e){n=y.stringPureVal(n,true);if(n==""){n="yy-mm-dd"}if(!t){return""}const r={monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]};let a,o=(e?e.dayNamesShort:null)||r.dayNamesShort,s=(e?e.dayNames:null)||r.dayNames,l=(e?e.monthNamesShort:null)||r.monthNamesShort,u=(e?e.monthNames:null)||r.monthNames,i=((1970-1)*365+Math.floor(1970/4)-Math.floor(1970/100)+Math.floor(1970/400))*24*60*60*1e7,c="",f=false;const m=function(t){let e=a+1<n.length&&n.charAt(a+1)===t;if(e){a++}return e};const h=function(t,e,n){let r=String(e);if(m(t)){while(r.length<n){r="0"+r}}return r};const d=(t,e,n,r)=>m(t)?r[e]:n[e];if(t){for(a=0;a<n.length;a++){if(f){if(n.charAt(a)==="'"&&!m("'")){f=false}else{c+=n.charAt(a)}}else{switch(n.charAt(a)){case"d":c+=h("d",t.getDate(),2);break;case"D":c+=d("D",t.getDay(),o,s);break;case"o":c+=h("o",Math.round((new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(t.getFullYear(),0,0).getTime())/864e5),3);break;case"m":c+=h("m",t.getMonth()+1,2);break;case"M":c+=d("M",t.getMonth(),l,u);break;case"y":c+=m("y")?t.getFullYear():(t.getFullYear()%100<10?"0":"")+t.getFullYear()%100;break;case"@":c+=t.getTime();break;case"!":c+=t.getTime()*1e4+i;break;case"'":if(m("'")){c+="'"}else{f=true}break;default:c+=n.charAt(a)}}}}return String(c)};e.formatDate=d;const g=function(t,l){if(l==undefined||l=="undefined"||l==""||!l){l=null}const e=t=>{if(!t){return null}t.setHours(t.getHours()>12?t.getHours()+2:0);return t};const n=function(t){let e=new Date;e.setDate(e.getDate()+t);return e};const r=function(t){let e=null;if(t){e=l}if(e==null){e=new Date}let n=e.getFullYear(),r=e.getMonth(),a=e.getDate();let o=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,s=o.exec(t);while(s){switch(s[2]||"d"){case"d":case"D":a+=parseInt(s[1],10);break;case"w":case"W":a+=parseInt(s[1],10)*7;break;case"m":case"M":r+=parseInt(s[1],10);a=Math.min(a,new Date(n,r+1,0).getDate());break;case"y":case"Y":n+=parseInt(s[1],10);a=Math.min(a,new Date(n,r+1,0).getDate());break}s=o.exec(t)}return new Date(n,r,a)};let a=t==null||t===""?l:typeof t==="string"?r(t):typeof t==="number"?!y.isFiniteNumber(t)?l:n(t):new Date(t.getTime());a=a&&a.toString()==="Invalid Date"?l:a;if(a){a.setHours(0);a.setMinutes(0);a.setSeconds(0);a.setMilliseconds(0)}return e(a)};e.determineDate=g;const M=t=>{t=y.format_number_int(t,false);if(t<=0){return"Now..."}const e=Math.floor(t/(3600*24));const n=Math.floor(t%(3600*24)/3600);const r=Math.floor(t%3600/60);const a=Math.floor(t%60);let o="";if(e>0){o+=e+"d "}if(n>0){o+=n+"h "}if(r>0){o+=r+"m "}o+=a+"s";return String(o)};e.prettySecondsToDHMS=M;const D=function(t){let e=S(t.month);let n=t.year+e;let r=t.month-e*12;return w(_(n,r,t.day))};const b=t=>{t.day=Math.min(t.day,h(t.year,t.month));return t};const S=function(t){let e=0;if(t>12){e=Math.ceil(t/12)-1}else if(t<1){e=Math.floor((t-1)/12)}return e};const w=function(t){t+=719468;let e=(t>=0?t:t-146096)/146097|0;let n=t-e*146097;let r=Math.floor((n-Math.floor(n/1460)+Math.floor(n/36524)-Math.floor(n/146096))/365);let a=r+e*400;let o=n-(365*r+Math.floor(r/4)-Math.floor(r/100));let s=Math.floor((5*o+2)/153);let l=o-Math.floor((153*s+2)/5)+1;let u=s+(s<10?3:-9);return{year:a+(u<=2),month:u,day:l}};const _=function(t,e,n){t-=e<=2;let r=(t>=0?t:t-399)/400|0;let a=t-r*400;let o=Math.floor((153*(e+(e>2?-3:9))+2)/5)+n-1;let s=a*365+Math.floor(a/4)-Math.floor(a/100)+o;return r*146097+s-719468}}};smartJ$Date.secureClass();if(typeof window!="undefined"){window.smartJ$Date=smartJ$Date}
// #END
