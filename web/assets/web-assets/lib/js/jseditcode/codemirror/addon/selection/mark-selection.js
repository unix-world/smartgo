// JS-Script (UM): mark-selection.js @ 2024-09-27 15:57:07 +0000
(function(e){if(typeof exports=="object"&&typeof module=="object"){e(require("../../lib/codemirror"))}else if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],e)}else{e(CodeMirror)}})(function(n){"use strict";n.defineOption("styleSelectedText",false,function(e,t,i){var r=i&&i!=n.Init;if(t&&!r){e.state.markedSelection=[];e.state.markedSelectionStyle=typeof t=="string"?t:"CodeMirror-selectedtext";c(e);e.on("cursorActivity",o);e.on("change",l)}else if(!t&&r){e.off("cursorActivity",o);e.off("change",l);a(e);e.state.markedSelection=e.state.markedSelectionStyle=null}});function o(e){if(e.state.markedSelection){e.operation(function(){t(e)})}}function l(e){if(e.state.markedSelection&&e.state.markedSelection.length){e.operation(function(){a(e)})}}var u=8;var m=n.Pos;var v=n.cmpPos;function f(e,t,i,r){if(v(t,i)==0){return}var n=e.state.markedSelection;var o=e.state.markedSelectionStyle;for(var l=t.line;;){var f=l==t.line?t:m(l,0);var a=l+u,c=a>=i.line;var s=c?i:m(a,0);var d=e.markText(f,s,{className:o});if(r==null){n.push(d)}else{n.splice(r++,0,d)}if(c){break}l=a}}function a(e){var t=e.state.markedSelection;for(var i=0;i<t.length;++i){t[i].clear()}t.length=0}function c(e){a(e);var t=e.listSelections();for(var i=0;i<t.length;i++){f(e,t[i].from(),t[i].to())}}function t(e){if(!e.somethingSelected()){return a(e)}if(e.listSelections().length>1){return c(e)}var t=e.getCursor("start"),i=e.getCursor("end");var r=e.state.markedSelection;if(!r.length){return f(e,t,i)}var n=r[0].find(),o=r[r.length-1].find();if(!n||!o||i.line-t.line<=u||v(t,o.to)>=0||v(i,n.from)<=0){return c(e)}while(v(t,n.from)>0){r.shift().clear();n=r[0].find()}if(v(t,n.from)<0){if(n.to.line-t.line<u){r.shift().clear();f(e,t,n.to,0)}else{f(e,t,n.from,0)}}while(v(i,o.to)<0){r.pop().clear();o=r[r.length-1].find()}if(v(i,o.to)>0){if(i.line-o.from.line<u){r.pop().clear();f(e,o.from,i)}else{f(e,o.to,i)}}}});
// #END
