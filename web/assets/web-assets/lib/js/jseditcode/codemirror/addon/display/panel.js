// JS-Script (UM): panel.js @ 2024-09-27 15:57:02 +0000
(function(e){if(typeof exports=="object"&&typeof module=="object"){e(require("../../lib/codemirror"))}else if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],e)}else{e(CodeMirror)}})(function(e){e.defineExtension("addPanel",function(e,t){t=t||{};if(!this.state.panels){f(this)}var i=this.state.panels;var r=i.wrapper;var n=this.getWrapperElement();var s=t.replace instanceof a&&!t.replace.cleared;if(t.after instanceof a&&!t.after.cleared){r.insertBefore(e,t.before.node.nextSibling)}else if(t.before instanceof a&&!t.before.cleared){r.insertBefore(e,t.before.node)}else if(s){r.insertBefore(e,t.replace.node);t.replace.clear(true)}else if(t.position=="bottom"){r.appendChild(e)}else if(t.position=="before-bottom"){r.insertBefore(e,n.nextSibling)}else if(t.position=="after-top"){r.insertBefore(e,n)}else{r.insertBefore(e,r.firstChild)}var o=t&&t.height||e.offsetHeight;var l=new a(this,e,t,o);i.panels.push(l);this.setSize();if(t.stable&&p(this,e)){this.scrollTo(null,this.getScrollInfo().top+o)}return l});function a(e,t,i,r){this.cm=e;this.node=t;this.options=i;this.height=r;this.cleared=false}a.prototype.clear=function(e){if(this.cleared){return}this.cleared=true;var t=this.cm.state.panels;t.panels.splice(t.panels.indexOf(this),1);this.cm.setSize();if(this.options.stable&&p(this.cm,this.node)){this.cm.scrollTo(null,this.cm.getScrollInfo().top-this.height)}t.wrapper.removeChild(this.node);if(t.panels.length==0&&!e){i(this.cm)}};a.prototype.changed=function(){this.height=this.node.getBoundingClientRect().height;this.cm.setSize()};function f(n){var e=n.getWrapperElement();var t=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle;var s=parseInt(t.height);var o=n.state.panels={setHeight:e.style.height,panels:[],wrapper:document.createElement("div")};var i=n.hasFocus(),r=n.getScrollInfo();e.parentNode.insertBefore(o.wrapper,e);o.wrapper.appendChild(e);n.scrollTo(r.left,r.top);if(i){n.focus()}n._setSize=n.setSize;if(s!=null){n.setSize=function(e,t){if(!t){t=o.wrapper.offsetHeight}o.setHeight=t;if(typeof t!="number"){var i=/^(\d+\.?\d*)px$/.exec(t);if(i){t=Number(i[1])}else{o.wrapper.style.height=t;t=o.wrapper.offsetHeight}}var r=t-o.panels.map(function(e){return e.node.getBoundingClientRect().height}).reduce(function(e,t){return e+t},0);n._setSize(e,r);s=t}}}function i(e){var t=e.state.panels;e.state.panels=null;var i=e.getWrapperElement();var r=e.hasFocus(),n=e.getScrollInfo();t.wrapper.parentNode.replaceChild(i,t.wrapper);e.scrollTo(n.left,n.top);if(r){e.focus()}i.style.height=t.setHeight;e.setSize=e._setSize;e.setSize()}function p(e,t){for(var i=t.nextSibling;i;i=i.nextSibling){if(i==e.getWrapperElement()){return true}}return false}});
// #END
