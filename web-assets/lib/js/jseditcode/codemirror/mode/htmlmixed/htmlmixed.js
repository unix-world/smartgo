// JS-Script (UM): htmlmixed.js @ 2023-12-03 00:03:40 +0000
(function(t){if(typeof exports=="object"&&typeof module=="object"){t(require("../../lib/codemirror"),require("../xml/xml"),require("../javascript/javascript"),require("../css/css"))}else if(typeof define=="function"&&define.amd){define(["../../lib/codemirror","../xml/xml","../javascript/javascript","../css/css"],t)}else{t(CodeMirror)}})(function(g){"use strict";var l={script:[["lang",/(javascript|babel)/i,"javascript"],["type",/^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^module$|^$/i,"javascript"],["type",/./,"text/plain"],[null,null,"javascript"]],style:[["lang",/^css$/i,"css"],["type",/^(text\/)?(x-)?(stylesheet|css)$/i,"css"],["type",/./,"text/plain"],[null,null,"css"]]};function p(t,e,a){var n=t.current(),l=n.search(e);if(l>-1){t.backUp(n.length-l)}else if(n.match(/<\/?$/)){t.backUp(n.length);if(!t.match(e,false)){t.match(n)}}return a}var a={};function n(t){var e=a[t];if(e){return e}return a[t]=new RegExp("\\s+"+t+"\\s*=\\s*('|\")?([^'\"]+)('|\")?\\s*")}function r(t,e){var a=t.match(n(e));return a?/^\s*(.*?)\s*$/.exec(a[2])[1]:""}function v(t,e){return new RegExp((e?"^":"")+"</s*"+t+"s*>","i")}function i(t,e){for(var a in t){var n=e[a]||(e[a]=[]);var l=t[a];for(var r=l.length-1;r>=0;r--){n.unshift(l[r])}}}function h(t,e){for(var a=0;a<t.length;a++){var n=t[a];if(!n[0]||n[1].test(r(e,n[0]))){return n[2]}}}g.defineMode("htmlmixed",function(u,t){var f=g.getMode(u,{name:"xml",htmlMode:true,multilineTagIndentFactor:t.multilineTagIndentFactor,multilineTagIndentPastTag:t.multilineTagIndentPastTag,allowMissingTagName:t.allowMissingTagName});var m={};var e=t&&t.tags,a=t&&t.scriptTypes;i(l,m);if(e){i(e,m)}if(a){for(var n=a.length-1;n>=0;n--){m.script.unshift(["type",a[n].matches,a[n].mode])}}function d(t,e){var a=f.token(t,e.htmlState),n=/\btag\b/.test(a),l;if(n&&!/[<>\s\/]/.test(t.current())&&(l=e.htmlState.tagName&&e.htmlState.tagName.toLowerCase())&&m.hasOwnProperty(l)){e.inTag=l+" "}else if(e.inTag&&n&&/>$/.test(t.current())){var r=/^([\S]+) (.*)/.exec(e.inTag);e.inTag=null;var i=t.current()==">"&&h(m[r[1]],r[2]);var o=g.getMode(u,i);var c=v(r[1],true),s=v(r[1],false);e.token=function(t,e){if(t.match(c,false)){e.token=d;e.localState=e.localMode=null;return null}return p(t,s,e.localMode.token(t,e.localState))};e.localMode=o;e.localState=g.startState(o,f.indent(e.htmlState,"",""))}else if(e.inTag){e.inTag+=t.current();if(t.eol()){e.inTag+=" "}}return a}return{startState:function(){var t=g.startState(f);return{token:d,inTag:null,localMode:null,localState:null,htmlState:t}},copyState:function(t){var e;if(t.localState){e=g.copyState(t.localMode,t.localState)}return{token:t.token,inTag:t.inTag,localMode:t.localMode,localState:e,htmlState:g.copyState(f,t.htmlState)}},token:function(t,e){return e.token(t,e)},indent:function(t,e,a){if(!t.localMode||/^\s*<\//.test(e)){return f.indent(t.htmlState,e,a)}else if(t.localMode.indent){return t.localMode.indent(t.localState,e,a)}else{return g.Pass}},innerMode:function(t){return{state:t.localState||t.htmlState,mode:t.localMode||f}}}},"xml","javascript","css");g.defineMIME("text/html","htmlmixed")});
// #END
