// JS-Script (UM): xml.js @ 2022-09-20 09:51:27 +0000
(function(e){if(typeof exports=="object"&&typeof module=="object")e(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],e);else e(CodeMirror)})(function(z){"use strict";var C={autoSelfClosers:{area:true,base:true,br:true,col:true,command:true,embed:true,frame:true,hr:true,img:true,input:true,keygen:true,link:true,meta:true,param:true,source:true,track:true,wbr:true,menuitem:true},implicitlyClosed:{dd:true,li:true,optgroup:true,option:true,p:true,rp:true,rt:true,tbody:true,td:true,tfoot:true,th:true,tr:true},contextGrabbers:{dd:{dd:true,dt:true},dt:{dd:true,dt:true},li:{li:true},option:{option:true,optgroup:true},optgroup:{optgroup:true},p:{address:true,article:true,aside:true,blockquote:true,dir:true,div:true,dl:true,fieldset:true,footer:true,form:true,h1:true,h2:true,h3:true,h4:true,h5:true,h6:true,header:true,hgroup:true,hr:true,menu:true,nav:true,ol:true,p:true,pre:true,section:true,table:true,ul:true},rp:{rp:true,rt:true},rt:{rp:true,rt:true},tbody:{tbody:true,tfoot:true},td:{td:true,th:true},tfoot:{tbody:true},th:{td:true,th:true},thead:{tbody:true,tfoot:true},tr:{tr:true}},doNotIndent:{pre:true},allowUnquoted:true,allowMissing:true,caseFold:true};var M={autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:false,allowMissing:false,allowMissingTagName:false,caseFold:false};z.defineMode("xml",function(e,t){var i=e.indentUnit;var o={};var r=t.htmlMode?C:M;for(var n in r)o[n]=r[n];for(var n in t)o[n]=t[n];var a,l;function s(t,r){function e(e){r.tokenize=e;return e(t,r)}var n=t.next();if(n=="<"){if(t.eat("!")){if(t.eat("[")){if(t.match("CDATA["))return e(c("atom","]]>"));else return null}else if(t.match("--")){return e(c("comment","--\x3e"))}else if(t.match("DOCTYPE",true,true)){t.eatWhile(/[\w\._\-]/);return e(d(1))}else{return null}}else if(t.eat("?")){t.eatWhile(/[\w\._\-]/);r.tokenize=c("meta","?>");return"meta"}else{a=t.eat("/")?"closeTag":"openTag";r.tokenize=f;return"tag bracket"}}else if(n=="&"){var u;if(t.eat("#")){if(t.eat("x")){u=t.eatWhile(/[a-fA-F\d]/)&&t.eat(";")}else{u=t.eatWhile(/[\d]/)&&t.eat(";")}}else{u=t.eatWhile(/[\w\.\-:]/)&&t.eat(";")}return u?"atom":"error"}else{t.eatWhile(/[^&<]/);return null}}s.isInText=true;function f(e,t){var r=e.next();if(r==">"||r=="/"&&e.eat(">")){t.tokenize=s;a=r==">"?"endTag":"selfcloseTag";return"tag bracket"}else if(r=="="){a="equals";return null}else if(r=="<"){t.tokenize=s;t.state=p;t.tagName=t.tagStart=null;var n=t.tokenize(e,t);return n?n+" tag error":"tag error"}else if(/[\'\"]/.test(r)){t.tokenize=u(r);t.stringStartCol=e.column();return t.tokenize(e,t)}else{e.match(/^[^\s\u00a0=<>\"\']*[^\s\u00a0=<>\"\'\/]/);return"word"}}function u(r){var e=function(e,t){while(!e.eol()){if(e.next()==r){t.tokenize=f;break}}return"string"};e.isInAttribute=true;return e}function c(r,n){return function(e,t){while(!e.eol()){if(e.match(n)){t.tokenize=s;break}e.next()}return r}}function d(n){return function(e,t){var r;while((r=e.next())!=null){if(r=="<"){t.tokenize=d(n+1);return t.tokenize(e,t)}else if(r==">"){if(n==1){t.tokenize=s;break}else{t.tokenize=d(n-1);return t.tokenize(e,t)}}}return"meta"}}function m(e,t,r){this.prev=e.context;this.tagName=t||"";this.indent=e.indented;this.startOfLine=r;if(o.doNotIndent.hasOwnProperty(t)||e.context&&e.context.noIndent)this.noIndent=true}function g(e){if(e.context)e.context=e.context.prev}function h(e,t){var r;while(true){if(!e.context){return}r=e.context.tagName;if(!o.contextGrabbers.hasOwnProperty(r)||!o.contextGrabbers[r].hasOwnProperty(t)){return}g(e)}}function p(e,t,r){if(e=="openTag"){r.tagStart=t.column();return x}else if(e=="closeTag"){return b}else{return p}}function x(e,t,r){if(e=="word"){r.tagName=t.current();l="tag";return v}else if(o.allowMissingTagName&&e=="endTag"){l="tag bracket";return v(e,t,r)}else{l="error";return x}}function b(e,t,r){if(e=="word"){var n=t.current();if(r.context&&r.context.tagName!=n&&o.implicitlyClosed.hasOwnProperty(r.context.tagName))g(r);if(r.context&&r.context.tagName==n||o.matchClosing===false){l="tag";return k}else{l="tag error";return w}}else if(o.allowMissingTagName&&e=="endTag"){l="tag bracket";return k(e,t,r)}else{l="error";return w}}function k(e,t,r){if(e!="endTag"){l="error";return k}g(r);return p}function w(e,t,r){l="error";return k(e,t,r)}function v(e,t,r){if(e=="word"){l="attribute";return T}else if(e=="endTag"||e=="selfcloseTag"){var n=r.tagName,u=r.tagStart;r.tagName=r.tagStart=null;if(e=="selfcloseTag"||o.autoSelfClosers.hasOwnProperty(n)){h(r,n)}else{h(r,n);r.context=new m(r,n,u==r.indented)}return p}l="error";return v}function T(e,t,r){if(e=="equals")return N;if(!o.allowMissing)l="error";return v(e,t,r)}function N(e,t,r){if(e=="string")return y;if(e=="word"&&o.allowUnquoted){l="string";return v}l="error";return v(e,t,r)}function y(e,t,r){if(e=="string")return y;return v(e,t,r)}return{startState:function(e){var t={tokenize:s,state:p,indented:e||0,tagName:null,tagStart:null,context:null};if(e!=null)t.baseIndent=e;return t},token:function(e,t){if(!t.tagName&&e.sol())t.indented=e.indentation();if(e.eatSpace())return null;a=null;var r=t.tokenize(e,t);if((r||a)&&r!="comment"){l=null;t.state=t.state(a||r,e,t);if(l)r=l=="error"?r+" error":l}return r},indent:function(e,t,r){var n=e.context;if(e.tokenize.isInAttribute){if(e.tagStart==e.indented)return e.stringStartCol+1;else return e.indented+i}if(n&&n.noIndent)return z.Pass;if(e.tokenize!=f&&e.tokenize!=s)return r?r.match(/^(\s*)/)[0].length:0;if(e.tagName){if(o.multilineTagIndentPastTag!==false)return e.tagStart+e.tagName.length+2;else return e.tagStart+i*(o.multilineTagIndentFactor||1)}if(o.alignCDATA&&/<!\[CDATA\[/.test(t))return 0;var u=t&&/^<(\/)?([\w_:\.-]*)/.exec(t);if(u&&u[1]){while(n){if(n.tagName==u[2]){n=n.prev;break}else if(o.implicitlyClosed.hasOwnProperty(n.tagName)){n=n.prev}else{break}}}else if(u){while(n){var a=o.contextGrabbers[n.tagName];if(a&&a.hasOwnProperty(u[2]))n=n.prev;else break}}while(n&&n.prev&&!n.startOfLine)n=n.prev;if(n)return n.indent+i;else return e.baseIndent||0},electricInput:/<\/[\s\w:]+>$/,blockCommentStart:"\x3c!--",blockCommentEnd:"--\x3e",configuration:o.htmlMode?"html":"xml",helperType:o.htmlMode?"html":"xml",skipAttribute:function(e){if(e.state==N)e.state=v},xmlCurrentTag:function(e){return e.tagName?{name:e.tagName,close:e.type=="closeTag"}:null},xmlCurrentContext:function(e){var t=[];for(var r=e.context;r;r=r.prev)t.push(r.tagName);return t.reverse()}}});z.defineMIME("text/xml","xml");z.defineMIME("application/xml","xml");if(!z.mimeModes.hasOwnProperty("text/html"))z.defineMIME("text/html",{name:"xml",htmlMode:true})});
// #END
