// JS-Script (UM): Chart.Line.js @ 2023-12-03 00:04:27 +0000
(function(){"use strict";var t=this,s=t.Chart,l=s.helpers;var i={scaleShowGridLines:true,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:true,scaleShowVerticalLines:true,bezierCurve:true,bezierCurveTension:.4,pointDot:true,pointDotRadius:4,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:true,datasetStrokeWidth:2,datasetFill:true,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].strokeColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>',errorCapWidth:2.5,errorStrokeWidth:1,errorDir:"both"};s.Type.extend({name:"Line",defaults:i,initialize:function(r){this.PointClass=s.Point.extend({strokeWidth:this.options.pointDotStrokeWidth,display:this.options.pointDot,hitDetectionRadius:this.options.pointHitDetectionRadius,ctx:this.chart.ctx,inRange:function(t){return Math.pow(t-this.x,2)<Math.pow(this.radius+this.hitDetectionRadius,2)}});if(typeof s.ErrorBar!=="undefined"){this.ErrorClass=s.ErrorBar.extend({errorDir:this.options.errorDir,errorStrokeWidth:this.options.errorStrokeWidth,ctx:this.chart.ctx})}else{this.ErrorClass=false}this.datasets=[];if(this.options.showTooltips){l.bindEvents(this,this.options.tooltipEvents,function(t){var i=t.type!=="mouseout"?this.getPointsAtEvent(t):[];this.eachPoints(function(t){t.restore(["fillColor","strokeColor"])});l.each(i,function(t){t.fillColor=t.highlightFill;t.strokeColor=t.highlightStroke});this.showTooltip(i)})}l.each(r.datasets,function(s){var n={label:s.label||null,fillColor:s.fillColor,havestroke:s.havestroke,strokeColor:s.strokeColor,pointColor:s.pointColor,pointStrokeColor:s.pointStrokeColor,points:[]};this.datasets.push(n);l.each(s.data,function(t,i){if(typeof s.error!=="undefined"&&this.ErrorClass){var o=new this.ErrorClass({errorVal:s.error[i],errorStrokeColor:s.errorStrokeColor||s.strokeColor})}else{var o=false}var e=this.options.pointDotRadius;if(typeof s.bubbles!=="undefined"){e=s.bubbles[i]}n.points.push(new this.PointClass({radius:e,value:t,errorBar:o||false,label:r.labels[i],datasetLabel:s.label,strokeColor:s.pointStrokeColor,fillColor:s.pointColor,highlightFill:s.pointHighlightFill||s.pointColor,highlightStroke:s.pointHighlightStroke||s.pointStrokeColor}))},this);this.buildScale(r.labels);if(this.ErrorClass){this.ErrorClass.prototype.base=this.scale.endPoint}this.eachPoints(function(t,i){l.extend(t,{x:this.scale.calculateX(i),y:this.scale.endPoint});t.save();if(t.errorBar){l.extend(t.errorBar,{x:this.scale.calculateX(i),y:this.scale.endPoint,yUp:this.scale.endPoint,yDown:this.scale.endPoint,width:this.options.pointDotRadius*this.options.errorStrokeWidth});t.errorBar.save()}},this)},this);this.render()},update:function(){this.scale.update();l.each(this.activeElements,function(t){t.restore(["fillColor","strokeColor"])});this.eachPoints(function(t){t.save();t.errorBar.save()});this.render()},eachPoints:function(i){l.each(this.datasets,function(t){l.each(t.points,i,this)},this)},getPointsAtEvent:function(t){var i=[],o=l.getRelativePosition(t);l.each(this.datasets,function(t){l.each(t.points,function(t){if(t.inRange(o.x,o.y)){i.push(t)}})},this);return i},buildScale:function(t){var o=this;var e=function(){var i=[];o.eachPoints(function(t){i.push(t.value)});return i};var i={templateString:this.options.scaleLabel,height:this.chart.height,width:this.chart.width,ctx:this.chart.ctx,textColor:this.options.scaleFontColor,fontSize:this.options.scaleFontSize,fontStyle:this.options.scaleFontStyle,fontFamily:this.options.scaleFontFamily,valuesCount:t.length,beginAtZero:this.options.scaleBeginAtZero,integersOnly:this.options.scaleIntegersOnly,calculateYRange:function(t){var i=l.calculateScaleRange(e(),t,this.fontSize,this.beginAtZero,this.integersOnly);l.extend(this,i)},xLabels:t,font:l.fontString(this.options.scaleFontSize,this.options.scaleFontStyle,this.options.scaleFontFamily),lineWidth:this.options.scaleLineWidth,lineColor:this.options.scaleLineColor,showHorizontalLines:this.options.scaleShowHorizontalLines,showVerticalLines:this.options.scaleShowVerticalLines,gridLineWidth:this.options.scaleShowGridLines?this.options.scaleGridLineWidth:0,gridLineColor:this.options.scaleShowGridLines?this.options.scaleGridLineColor:"rgba(0,0,0,0)",padding:this.options.showScale?0:this.options.pointDotRadius+this.options.pointDotStrokeWidth,showLabels:this.options.scaleShowLabels,display:this.options.showScale};if(this.options.scaleOverride){l.extend(i,{calculateYRange:l.noop,steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth})}this.scale=new s.Scale(i)},addData:function(t,o){l.each(t,function(t,i){this.datasets[i].points.push(new this.PointClass({value:t,label:o,x:this.scale.calculateX(this.scale.valuesCount+1),y:this.scale.endPoint,strokeColor:this.datasets[i].pointStrokeColor,fillColor:this.datasets[i].pointColor}))},this);this.scale.addXLabel(o);this.update()},removeData:function(){this.scale.removeXLabel();l.each(this.datasets,function(t){t.points.shift()},this);this.update()},reflow:function(){var t=l.extend({height:this.chart.height,width:this.chart.width});this.scale.update(t)},draw:function(t){var o=t||1;this.clear();var s=this.chart.ctx;var n=function(t){return t.value!==null},r=function(t,i,o){return l.findNextWhere(i,n,o)||t},a=function(t,i,o){return l.findPreviousWhere(i,n,o)||t};this.scale.draw(o);l.each(this.datasets,function(t){var e=l.where(t.points,n);l.each(t.points,function(t,i){if(t.hasValue()){t.transition({y:this.scale.calculateY(t.value),x:this.scale.calculateX(i)},o);if(t.errorBar){t.errorBar.transition({x:this.scale.calculateX(i),y:this.scale.calculateY(t.value),yUp:this.scale.calculateY(t.value+t.errorBar.errorVal),yDown:this.scale.calculateY(t.value-t.errorBar.errorVal),width:this.options.pointDotRadius*this.options.errorCapWidth},o)}}},this);if(this.options.bezierCurve){l.each(e,function(t,i){var o=i>0&&i<e.length-1?this.options.bezierCurveTension:0;t.controlPoints=l.splineCurve(a(t,e,i),t,r(t,e,i),o);if(t.controlPoints.outer.y>this.scale.endPoint){t.controlPoints.outer.y=this.scale.endPoint}else if(t.controlPoints.outer.y<this.scale.startPoint){t.controlPoints.outer.y=this.scale.startPoint}if(t.controlPoints.inner.y>this.scale.endPoint){t.controlPoints.inner.y=this.scale.endPoint}else if(t.controlPoints.inner.y<this.scale.startPoint){t.controlPoints.inner.y=this.scale.startPoint}},this)}s.lineWidth=this.options.datasetStrokeWidth;s.strokeStyle=t.strokeColor;s.beginPath();l.each(e,function(t,i){if(i===0){s.moveTo(t.x,t.y)}else{if(this.options.bezierCurve){var o=a(t,e,i);s.bezierCurveTo(o.controlPoints.outer.x,o.controlPoints.outer.y,t.controlPoints.inner.x,t.controlPoints.inner.y,t.x,t.y)}else{s.lineTo(t.x,t.y)}}},this);if(this.options.datasetStroke!==false){s.stroke()}else if(t.havestroke===true){s.stroke()}if(this.options.datasetFill&&e.length>0){s.lineTo(e[e.length-1].x,this.scale.endPoint);s.lineTo(e[0].x,this.scale.endPoint);s.fillStyle=t.fillColor;s.closePath();s.fill()}l.each(e,function(t){if(t.errorBar){t.errorBar.draw()}t.draw()})},this)}})}).call(this);
// #END
