// JS-Script (US): smart-mathquill.js @ 2022-10-18 14:27:28 +0000
const smartRenderMathLatexFormula=($code,slotId,hideSource)=>{if($code==undefined){return}if(!$code.length){return}const code=smartJ$Utils.stringPureVal($code.text()||"",true);if(code==""){return}slotId=smartJ$Utils.stringTrim(smartJ$Utils.create_htmid(smartJ$Utils.stringPureVal(slotId,true)));const theUid="math-latex-uid-"+smartJ$Utils.uuid().toLowerCase();if(slotId==""){slotId=theUid}hideSource=!!hideSource;let theElId=smartJ$Utils.stringPureVal($code.attr("id"));if(theElId==""){theElId=theUid;$code.attr("id",theElId)}const elemId="mathquill-render-area-"+slotId;let theHtml='<div role="math" id="'+smartJ$Utils.escape_html(elemId)+'" class="math-render-latex" data-math-latex="'+smartJ$Utils.escape_html(theElId);theHtml+='" title="Math Latex Formula Render #'+smartJ$Utils.escape_html(slotId);if(hideSource===true){theHtml+="\n"+"`"+smartJ$Utils.escape_html(code)+"`"}theHtml+='"></div>';$code.after(theHtml);const $render=jQuery("#"+elemId);if(!$render.length){return}const mqi=MathQuill.getInterface(2);let isOk=true;try{mqi.StaticMath($render[0]).latex(code)}catch(err){isOk=false;console.warn("MathQuill ERR:",err)}if(isOk===true){const testRenderTxt=smartJ$Utils.stringTrim(jQuery("#"+elemId).text());if(testRenderTxt==""||testRenderTxt=="$$"){hideSource=false;$code.addClass("mathLatexRenderFail")}if(hideSource===true){$code.empty().html("")}$code.attr("data-math-latex",smartJ$Utils.escape_url(code)).append($render)}else{$code.addClass("mathLatexRenderFail")}};if(typeof SmartViewHelpersMathLatexHide=="undefined"){var SmartViewHelpersMathLatexHide=true}if(typeof SmartJS_Custom_Math_Latex_Render!="function"){var SmartJS_Custom_Math_Latex_Render=selector=>{const $=jQuery;setTimeout(()=>{$(String(selector)+" div.math-latex").each((i,el)=>{let $el=$(el);smartRenderMathLatexFormula($el,i+1,!!SmartViewHelpersMathLatexHide)})},70)}}
// #END
