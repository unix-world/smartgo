// JS-Script (UM): datepicker.js @ 2022-09-20 09:51:04 +0000
(function(l,c,m){(function(){var e="2.2.3",i="datepicker",t=".datepicker-here",s,a,n=false,r=""+'<div class="datepicker">'+'<i class="datepicker--pointer"></i>'+'<nav class="datepicker--nav"></nav>'+'<div class="datepicker--content"></div>'+"</div>",h={classes:"",inline:false,language:"en",startDate:new Date,firstDay:"",weekends:[6,0],dateFormat:"",altField:"",altFieldDateFormat:"@",toggleSelected:true,keyboardNav:true,position:"bottom left",offset:12,view:"days",minView:"days",showOtherMonths:true,selectOtherMonths:true,moveToOtherMonthsOnSelect:true,showOtherYears:true,selectOtherYears:true,moveToOtherYearsOnSelect:true,minDate:"",maxDate:"",disableNavWhenOutOfRange:true,multipleDates:false,multipleDatesSeparator:",",range:false,todayButton:false,clearButton:false,showEvent:"focus",autoClose:false,monthsField:"monthsShort",prevHtml:'<svg><path d="M 17,12 l -5,5 l 5,5"></path></svg>',nextHtml:'<svg><path d="M 14,12 l 5,5 l -5,5"></path></svg>',navTitles:{days:"MM, <i>yyyy</i>",months:"yyyy",years:"yyyy1 - yyyy2"},timepicker:false,onlyTimepicker:false,dateTimeSeparator:" ",timeFormat:"",minHours:0,maxHours:24,minMinutes:0,maxMinutes:59,hoursStep:1,minutesStep:1,onSelect:"",onShow:"",onHide:"",onChangeMonth:"",onChangeYear:"",onChangeDecade:"",onChangeView:"",onRenderCell:""},o={ctrlRight:[17,39],ctrlUp:[17,38],ctrlLeft:[17,37],ctrlDown:[17,40],shiftRight:[16,39],shiftUp:[16,38],shiftLeft:[16,37],shiftDown:[16,40],altUp:[18,38],altRight:[18,39],altLeft:[18,37],altDown:[18,40],ctrlShiftUp:[16,17,38]},p;var d=function(e,t){this.el=e;this.$el=c(e);this.opts=c.extend(true,{},h,t,this.$el.data());if(s==m){s=c("body")}if(!this.opts.startDate){this.opts.startDate=new Date}if(this.el.nodeName=="INPUT"){this.elIsInput=true}if(this.opts.altField){this.$altField=typeof this.opts.altField=="string"?c(this.opts.altField):this.opts.altField}this.inited=false;this.visible=false;this.silent=false;this.currentDate=this.opts.startDate;this.currentView=this.opts.view;this._createShortCuts();this.selectedDates=[];this.views={};this.keys=[];this.minRange="";this.maxRange="";this._prevOnSelectValue="";this.init()};p=d;p.prototype={VERSION:e,viewIndexes:["days","months","years"],init:function(){if(!n&&!this.opts.inline&&this.elIsInput){this._buildDatepickersContainer()}this._buildBaseHtml();this._defineLocale(this.opts.language);this._syncWithMinMaxDates();if(this.elIsInput){if(!this.opts.inline){this._setPositionClasses(this.opts.position);this._bindEvents()}if(this.opts.keyboardNav&&!this.opts.onlyTimepicker){this._bindKeyboardEvents()}this.$datepicker.on("mousedown",this._onMouseDownDatepicker.bind(this));this.$datepicker.on("mouseup",this._onMouseUpDatepicker.bind(this))}if(this.opts.classes){this.$datepicker.addClass(this.opts.classes)}if(this.opts.timepicker){this.timepicker=new c.fn.datepicker.Timepicker(this,this.opts);this._bindTimepickerEvents()}if(this.opts.onlyTimepicker){this.$datepicker.addClass("-only-timepicker-")}this.views[this.currentView]=new c.fn.datepicker.Body(this,this.currentView,this.opts);this.views[this.currentView].show();this.nav=new c.fn.datepicker.Navigation(this,this.opts);this.view=this.currentView;this.$el.on("clickCell.adp",this._onClickCell.bind(this));this.$datepicker.on("mouseenter",".datepicker--cell",this._onMouseEnterCell.bind(this));this.$datepicker.on("mouseleave",".datepicker--cell",this._onMouseLeaveCell.bind(this));this.inited=true},_createShortCuts:function(){this.minDate=this.opts.minDate?this.opts.minDate:new Date(-86399999136e5);this.maxDate=this.opts.maxDate?this.opts.maxDate:new Date(86399999136e5)},_bindEvents:function(){this.$el.on(this.opts.showEvent+".adp",this._onShowEvent.bind(this));this.$el.on("mouseup.adp",this._onMouseUpEl.bind(this));this.$el.on("blur.adp",this._onBlur.bind(this));this.$el.on("keyup.adp",this._onKeyUpGeneral.bind(this));c(l).on("resize.adp",this._onResize.bind(this));c("body").on("mouseup.adp",this._onMouseUpBody.bind(this))},_bindKeyboardEvents:function(){this.$el.on("keydown.adp",this._onKeyDown.bind(this));this.$el.on("keyup.adp",this._onKeyUp.bind(this));this.$el.on("hotKey.adp",this._onHotKey.bind(this))},_bindTimepickerEvents:function(){this.$el.on("timeChange.adp",this._onTimeChange.bind(this))},isWeekend:function(e){return this.opts.weekends.indexOf(e)!==-1},_defineLocale:function(e){if(typeof e=="string"){this.loc=c.fn.datepicker.language[e];if(!this.loc){console.warn("Can't find language \""+e+'" in Datepicker.language, will use "ru" instead');this.loc=c.extend(true,{},c.fn.datepicker.language.ru)}this.loc=c.extend(true,{},c.fn.datepicker.language.ru,c.fn.datepicker.language[e])}else{this.loc=c.extend(true,{},c.fn.datepicker.language.ru,e)}if(this.opts.dateFormat){this.loc.dateFormat=this.opts.dateFormat}if(this.opts.timeFormat){this.loc.timeFormat=this.opts.timeFormat}if(this.opts.firstDay!==""){this.loc.firstDay=this.opts.firstDay}if(this.opts.timepicker){this.loc.dateFormat=[this.loc.dateFormat,this.loc.timeFormat].join(this.opts.dateTimeSeparator)}if(this.opts.onlyTimepicker){this.loc.dateFormat=this.loc.timeFormat}var t=this._getWordBoundaryRegExp;if(this.loc.timeFormat.match(t("aa"))||this.loc.timeFormat.match(t("AA"))){this.ampm=true}},_buildDatepickersContainer:function(){n=true;s.append('<div class="datepickers-container" id="datepickers-container"></div>');a=c("#datepickers-container")},_buildBaseHtml:function(){var e,t=c('<div class="datepicker-inline">');if(this.el.nodeName=="INPUT"){if(!this.opts.inline){e=a}else{e=t.insertAfter(this.$el)}}else{e=t.appendTo(this.$el)}this.$datepicker=c(r).appendTo(e);this.$content=c(".datepicker--content",this.$datepicker);this.$nav=c(".datepicker--nav",this.$datepicker)},_triggerOnChange:function(){if(!this.selectedDates.length){if(this._prevOnSelectValue==="")return;this._prevOnSelectValue="";return this.opts.onSelect("","",this)}var e=this.selectedDates,t=p.getParsedDate(e[0]),i,s=this,a=new Date(t.year,t.month,t.date,t.hours,t.minutes);i=e.map(function(e){return s.formatDate(s.loc.dateFormat,e)}).join(this.opts.multipleDatesSeparator);if(this.opts.multipleDates||this.opts.range){a=e.map(function(e){var t=p.getParsedDate(e);return new Date(t.year,t.month,t.date,t.hours,t.minutes)})}this._prevOnSelectValue=i;this.opts.onSelect(i,a,this)},next:function(){var e=this.parsedDate,t=this.opts;switch(this.view){case"days":this.date=new Date(e.year,e.month+1,1);if(t.onChangeMonth)t.onChangeMonth(this.parsedDate.month,this.parsedDate.year);break;case"months":this.date=new Date(e.year+1,e.month,1);if(t.onChangeYear)t.onChangeYear(this.parsedDate.year);break;case"years":this.date=new Date(e.year+10,0,1);if(t.onChangeDecade)t.onChangeDecade(this.curDecade);break}},prev:function(){var e=this.parsedDate,t=this.opts;switch(this.view){case"days":this.date=new Date(e.year,e.month-1,1);if(t.onChangeMonth)t.onChangeMonth(this.parsedDate.month,this.parsedDate.year);break;case"months":this.date=new Date(e.year-1,e.month,1);if(t.onChangeYear)t.onChangeYear(this.parsedDate.year);break;case"years":this.date=new Date(e.year-10,0,1);if(t.onChangeDecade)t.onChangeDecade(this.curDecade);break}},formatDate:function(e,t){t=t||this.date;var i=e,s=this._getWordBoundaryRegExp,a=this.loc,n=p.getLeadingZeroNum,r=p.getDecade(t),h=p.getParsedDate(t),o=h.fullHours,d=h.hours,l=e.match(s("aa"))||e.match(s("AA")),c="am",u=this._replacer,m;if(this.opts.timepicker&&this.timepicker&&l){m=this.timepicker._getValidHoursFromDate(t,l);o=n(m.hours);d=m.hours;c=m.dayPeriod}switch(true){case/@/.test(i):i=i.replace(/@/,t.getTime());case/aa/.test(i):i=u(i,s("aa"),c);case/AA/.test(i):i=u(i,s("AA"),c.toUpperCase());case/dd/.test(i):i=u(i,s("dd"),h.fullDate);case/d/.test(i):i=u(i,s("d"),h.date);case/DD/.test(i):i=u(i,s("DD"),a.days[h.day]);case/D/.test(i):i=u(i,s("D"),a.daysShort[h.day]);case/mm/.test(i):i=u(i,s("mm"),h.fullMonth);case/m/.test(i):i=u(i,s("m"),h.month+1);case/MM/.test(i):i=u(i,s("MM"),this.loc.months[h.month]);case/M/.test(i):i=u(i,s("M"),a.monthsShort[h.month]);case/ii/.test(i):i=u(i,s("ii"),h.fullMinutes);case/i/.test(i):i=u(i,s("i"),h.minutes);case/hh/.test(i):i=u(i,s("hh"),o);case/h/.test(i):i=u(i,s("h"),d);case/yyyy/.test(i):i=u(i,s("yyyy"),h.year);case/yyyy1/.test(i):i=u(i,s("yyyy1"),r[0]);case/yyyy2/.test(i):i=u(i,s("yyyy2"),r[1]);case/yy/.test(i):i=u(i,s("yy"),h.year.toString().slice(-2))}return i},_replacer:function(e,t,a){return e.replace(t,function(e,t,i,s){return t+a+s})},_getWordBoundaryRegExp:function(e){var t="\\s|\\.|-|/|\\\\|,|\\$|\\!|\\?|:|;";return new RegExp("(^|>|"+t+")("+e+")($|<|"+t+")","g")},selectDate:function(e){var t=this,i=t.opts,s=t.parsedDate,a=t.selectedDates,n=a.length,r="";if(Array.isArray(e)){e.forEach(function(e){t.selectDate(e)});return}if(!(e instanceof Date))return;this.lastSelectedDate=e;if(this.timepicker){this.timepicker._setTime(e)}t._trigger("selectDate",e);if(this.timepicker){e.setHours(this.timepicker.hours);e.setMinutes(this.timepicker.minutes)}if(t.view=="days"){if(e.getMonth()!=s.month&&i.moveToOtherMonthsOnSelect){r=new Date(e.getFullYear(),e.getMonth(),1)}}if(t.view=="years"){if(e.getFullYear()!=s.year&&i.moveToOtherYearsOnSelect){r=new Date(e.getFullYear(),0,1)}}if(r){t.silent=true;t.date=r;t.silent=false;t.nav._render()}if(i.multipleDates&&!i.range){if(n===i.multipleDates)return;if(!t._isSelected(e)){t.selectedDates.push(e)}}else if(i.range){if(n==2){t.selectedDates=[e];t.minRange=e;t.maxRange=""}else if(n==1){t.selectedDates.push(e);if(!t.maxRange){t.maxRange=e}else{t.minRange=e}if(p.bigger(t.maxRange,t.minRange)){t.maxRange=t.minRange;t.minRange=e}t.selectedDates=[t.minRange,t.maxRange]}else{t.selectedDates=[e];t.minRange=e}}else{t.selectedDates=[e]}t._setInputValue();if(i.onSelect){t._triggerOnChange()}if(i.autoClose&&!this.timepickerIsActive){if(!i.multipleDates&&!i.range){t.hide()}else if(i.range&&t.selectedDates.length==2){t.hide()}}t.views[this.currentView]._render()},removeDate:function(i){var s=this.selectedDates,a=this;if(!(i instanceof Date))return;return s.some(function(e,t){if(p.isSame(e,i)){s.splice(t,1);if(!a.selectedDates.length){a.minRange="";a.maxRange="";a.lastSelectedDate=""}else{a.lastSelectedDate=a.selectedDates[a.selectedDates.length-1]}a.views[a.currentView]._render();a._setInputValue();if(a.opts.onSelect){a._triggerOnChange()}return true}})},today:function(){this.silent=true;this.view=this.opts.minView;this.silent=false;this.date=new Date;if(this.opts.todayButton instanceof Date){this.selectDate(this.opts.todayButton)}},clear:function(){this.selectedDates=[];this.minRange="";this.maxRange="";this.views[this.currentView]._render();this._setInputValue();if(this.opts.onSelect){this._triggerOnChange()}},update:function(e,t){var i=arguments.length,s=this.lastSelectedDate;if(i==2){this.opts[e]=t}else if(i==1&&typeof e=="object"){this.opts=c.extend(true,this.opts,e)}this._createShortCuts();this._syncWithMinMaxDates();this._defineLocale(this.opts.language);this.nav._addButtonsIfNeed();if(!this.opts.onlyTimepicker)this.nav._render();this.views[this.currentView]._render();if(this.elIsInput&&!this.opts.inline){this._setPositionClasses(this.opts.position);if(this.visible){this.setPosition(this.opts.position)}}if(this.opts.classes){this.$datepicker.addClass(this.opts.classes)}if(this.opts.onlyTimepicker){this.$datepicker.addClass("-only-timepicker-")}if(this.opts.timepicker){if(s)this.timepicker._handleDate(s);this.timepicker._updateRanges();this.timepicker._updateCurrentTime();if(s){s.setHours(this.timepicker.hours);s.setMinutes(this.timepicker.minutes)}}this._setInputValue();return this},_syncWithMinMaxDates:function(){var e=this.date.getTime();this.silent=true;if(this.minTime>e){this.date=this.minDate}if(this.maxTime<e){this.date=this.maxDate}this.silent=false},_isSelected:function(t,i){var s=false;this.selectedDates.some(function(e){if(p.isSame(e,t,i)){s=e;return true}});return s},_setInputValue:function(){var t=this,e=t.opts,i=t.loc.dateFormat,s=e.altFieldDateFormat,a=t.selectedDates.map(function(e){return t.formatDate(i,e)}),n;if(e.altField&&t.$altField.length){n=this.selectedDates.map(function(e){return t.formatDate(s,e)});n=n.join(this.opts.multipleDatesSeparator);this.$altField.val(n)}a=a.join(this.opts.multipleDatesSeparator);this.$el.val(a)},_isInRange:function(e,t){var i=e.getTime(),s=p.getParsedDate(e),a=p.getParsedDate(this.minDate),n=p.getParsedDate(this.maxDate),r=new Date(s.year,s.month,a.date).getTime(),h=new Date(s.year,s.month,n.date).getTime(),o={day:i>=this.minTime&&i<=this.maxTime,month:r>=this.minTime&&h<=this.maxTime,year:s.year>=a.year&&s.year<=n.year};return t?o[t]:o.day},_getDimensions:function(e){var t=e.offset();return{width:e.outerWidth(),height:e.outerHeight(),left:t.left,top:t.top}},_getDateFromCell:function(e){var t=this.parsedDate,i=e.data("year")||t.year,s=e.data("month")==m?t.month:e.data("month"),a=e.data("date")||1;return new Date(i,s,a)},_setPositionClasses:function(e){e=e.split(" ");var t=e[0],i=e[1],s="datepicker -"+t+"-"+i+"- -from-"+t+"-";if(this.visible)s+=" active";this.$datepicker.removeAttr("class").addClass(s)},setPosition:function(e){e=e||this.opts.position;var t;if(this.$el.attr("type")=="hidden"&&this.$altField){t=this._getDimensions(this.$altField)}else{t=this._getDimensions(this.$el)}var i=this._getDimensions(this.$datepicker),s=e.split(" "),a,n,r=this.opts.offset,h=s[0],o=s[1];switch(h){case"top":a=t.top-i.height-r;break;case"right":n=t.left+t.width+r;break;case"bottom":a=t.top+t.height+r;break;case"left":n=t.left-i.width-r;break}switch(o){case"top":a=t.top;break;case"right":n=t.left+t.width-i.width;break;case"bottom":a=t.top+t.height-i.height;break;case"left":n=t.left;break;case"center":if(/left|right/.test(h)){a=t.top+t.height/2-i.height/2}else{n=t.left+t.width/2-i.width/2}}this.$datepicker.css({left:n,top:a})},show:function(){var e=this.opts.onShow;this.setPosition(this.opts.position);this.$datepicker.addClass("active");this.visible=true;if(e){this._bindVisionEvents(e)}},hide:function(){var e=this.opts.onHide;this.$datepicker.removeClass("active").css({left:"-100000px"});this.focused="";this.keys=[];this.inFocus=false;this.visible=false;this.$el.blur();if(e){this._bindVisionEvents(e)}},down:function(e){this._changeView(e,"down")},up:function(e){this._changeView(e,"up")},_bindVisionEvents:function(e){this.$datepicker.off("transitionend.dp");e(this,false);this.$datepicker.one("transitionend.dp",e.bind(this,this,true))},_changeView:function(e,t){e=e||this.focused||this.date;var i=t=="up"?this.viewIndex+1:this.viewIndex-1;if(i>2)i=2;if(i<0)i=0;this.silent=true;this.date=new Date(e.getFullYear(),e.getMonth(),1);this.silent=false;this.view=this.viewIndexes[i]},_handleHotKey:function(e){var t=p.getParsedDate(this._getFocusedDate()),i,s=this.opts,a,n,r=false,h=false,o=false,d=t.year,l=t.month,c=t.date;switch(e){case"ctrlRight":case"ctrlUp":l+=1;r=true;break;case"ctrlLeft":case"ctrlDown":l-=1;r=true;break;case"shiftRight":case"shiftUp":h=true;d+=1;break;case"shiftLeft":case"shiftDown":h=true;d-=1;break;case"altRight":case"altUp":o=true;d+=10;break;case"altLeft":case"altDown":o=true;d-=10;break;case"ctrlShiftUp":this.up();break}n=p.getDaysCount(new Date(d,l));a=new Date(d,l,c);if(n<c)c=n;if(a.getTime()<this.minTime){a=this.minDate}else if(a.getTime()>this.maxTime){a=this.maxDate}this.focused=a;i=p.getParsedDate(a);if(r&&s.onChangeMonth){s.onChangeMonth(i.month,i.year)}if(h&&s.onChangeYear){s.onChangeYear(i.year)}if(o&&s.onChangeDecade){s.onChangeDecade(this.curDecade)}},_registerKey:function(t){var e=this.keys.some(function(e){return e==t});if(!e){this.keys.push(t)}},_unRegisterKey:function(e){var t=this.keys.indexOf(e);this.keys.splice(t,1)},_isHotKeyPressed:function(){var e,t=false,i=this,s=this.keys.sort();for(var a in o){e=o[a];if(s.length!=e.length)continue;if(e.every(function(e,t){return e==s[t]})){i._trigger("hotKey",a);t=true}}return t},_trigger:function(e,t){this.$el.trigger(e,t)},_focusNextCell:function(e,t){t=t||this.cellType;var i=p.getParsedDate(this._getFocusedDate()),s=i.year,a=i.month,n=i.date;if(this._isHotKeyPressed()){return}switch(e){case 37:t=="day"?n-=1:"";t=="month"?a-=1:"";t=="year"?s-=1:"";break;case 38:t=="day"?n-=7:"";t=="month"?a-=3:"";t=="year"?s-=4:"";break;case 39:t=="day"?n+=1:"";t=="month"?a+=1:"";t=="year"?s+=1:"";break;case 40:t=="day"?n+=7:"";t=="month"?a+=3:"";t=="year"?s+=4:"";break}var r=new Date(s,a,n);if(r.getTime()<this.minTime){r=this.minDate}else if(r.getTime()>this.maxTime){r=this.maxDate}this.focused=r},_getFocusedDate:function(){var e=this.focused||this.selectedDates[this.selectedDates.length-1],t=this.parsedDate;if(!e){switch(this.view){case"days":e=new Date(t.year,t.month,(new Date).getDate());break;case"months":e=new Date(t.year,t.month,1);break;case"years":e=new Date(t.year,0,1);break}}return e},_getCell:function(e,t){t=t||this.cellType;var i=p.getParsedDate(e),s='.datepicker--cell[data-year="'+i.year+'"]',a;switch(t){case"month":s='[data-month="'+i.month+'"]';break;case"day":s+='[data-month="'+i.month+'"][data-date="'+i.date+'"]';break}a=this.views[this.currentView].$el.find(s);return a.length?a:c("")},destroy:function(){var e=this;e.$el.off(".adp").data("datepicker","");e.selectedDates=[];e.focused="";e.views={};e.keys=[];e.minRange="";e.maxRange="";if(e.opts.inline||!e.elIsInput){e.$datepicker.closest(".datepicker-inline").remove()}else{e.$datepicker.remove()}},_handleAlreadySelectedDates:function(e,t){if(this.opts.range){if(!this.opts.toggleSelected){if(this.selectedDates.length!=2){this._trigger("clickCell",t)}}else{this.removeDate(t)}}else if(this.opts.toggleSelected){this.removeDate(t)}if(!this.opts.toggleSelected){this.lastSelectedDate=e;if(this.opts.timepicker){this.timepicker._setTime(e);this.timepicker.update()}}},_onShowEvent:function(e){if(!this.visible){this.show()}},_onBlur:function(){if(!this.inFocus&&this.visible){this.hide()}},_onMouseDownDatepicker:function(e){this.inFocus=true},_onMouseUpDatepicker:function(e){this.inFocus=false;e.originalEvent.inFocus=true;if(!e.originalEvent.timepickerFocus)this.$el.focus()},_onKeyUpGeneral:function(e){var t=this.$el.val();if(!t){this.clear()}},_onResize:function(){if(this.visible){this.setPosition()}},_onMouseUpBody:function(e){if(e.originalEvent.inFocus)return;if(this.visible&&!this.inFocus){this.hide()}},_onMouseUpEl:function(e){e.originalEvent.inFocus=true;setTimeout(this._onKeyUpGeneral.bind(this),4)},_onKeyDown:function(e){var t=e.which;this._registerKey(t);if(t>=37&&t<=40){e.preventDefault();this._focusNextCell(t)}if(t==13){if(this.focused){if(this._getCell(this.focused).hasClass("-disabled-"))return;if(this.view!=this.opts.minView){this.down()}else{var i=this._isSelected(this.focused,this.cellType);if(!i){if(this.timepicker){this.focused.setHours(this.timepicker.hours);this.focused.setMinutes(this.timepicker.minutes)}this.selectDate(this.focused);return}this._handleAlreadySelectedDates(i,this.focused)}}}if(t==27){this.hide()}},_onKeyUp:function(e){var t=e.which;this._unRegisterKey(t)},_onHotKey:function(e,t){this._handleHotKey(t)},_onMouseEnterCell:function(e){var t=c(e.target).closest(".datepicker--cell"),i=this._getDateFromCell(t);this.silent=true;if(this.focused){this.focused=""}t.addClass("-focus-");this.focused=i;this.silent=false;if(this.opts.range&&this.selectedDates.length==1){this.minRange=this.selectedDates[0];this.maxRange="";if(p.less(this.minRange,this.focused)){this.maxRange=this.minRange;this.minRange=""}this.views[this.currentView]._update()}},_onMouseLeaveCell:function(e){var t=c(e.target).closest(".datepicker--cell");t.removeClass("-focus-");this.silent=true;this.focused="";this.silent=false},_onTimeChange:function(e,t,i){var s=new Date,a=this.selectedDates,n=false;if(a.length){n=true;s=this.lastSelectedDate}s.setHours(t);s.setMinutes(i);if(!n&&!this._getCell(s).hasClass("-disabled-")){this.selectDate(s)}else{this._setInputValue();if(this.opts.onSelect){this._triggerOnChange()}}},_onClickCell:function(e,t){if(this.timepicker){t.setHours(this.timepicker.hours);t.setMinutes(this.timepicker.minutes)}this.selectDate(t)},set focused(e){if(!e&&this.focused){var t=this._getCell(this.focused);if(t.length){t.removeClass("-focus-")}}this._focused=e;if(this.opts.range&&this.selectedDates.length==1){this.minRange=this.selectedDates[0];this.maxRange="";if(p.less(this.minRange,this._focused)){this.maxRange=this.minRange;this.minRange=""}}if(this.silent)return;this.date=e},get focused(){return this._focused},get parsedDate(){return p.getParsedDate(this.date)},set date(e){if(!(e instanceof Date))return;this.currentDate=e;if(this.inited&&!this.silent){this.views[this.view]._render();this.nav._render();if(this.visible){this.setPosition()}}return e},get date(){return this.currentDate},set view(e){this.viewIndex=this.viewIndexes.indexOf(e);if(this.viewIndex<0){return}this.prevView=this.currentView;this.currentView=e;if(this.inited){if(!this.views[e]){this.views[e]=new c.fn.datepicker.Body(this,e,this.opts)}else{this.views[e]._render()}this.views[this.prevView].hide();this.views[e].show();this.nav._render();if(this.opts.onChangeView){this.opts.onChangeView(e)}if(this.visible){this.setPosition()}}return e},get view(){return this.currentView},get cellType(){return this.view.substring(0,this.view.length-1)},get minTime(){var e=p.getParsedDate(this.minDate);return new Date(e.year,e.month,e.date).getTime()},get maxTime(){var e=p.getParsedDate(this.maxDate);return new Date(e.year,e.month,e.date).getTime()},get curDecade(){return p.getDecade(this.date)}};p.getDaysCount=function(e){return new Date(e.getFullYear(),e.getMonth()+1,0).getDate()};p.getParsedDate=function(e){return{year:e.getFullYear(),month:e.getMonth(),fullMonth:e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,date:e.getDate(),fullDate:e.getDate()<10?"0"+e.getDate():e.getDate(),day:e.getDay(),hours:e.getHours(),fullHours:e.getHours()<10?"0"+e.getHours():e.getHours(),minutes:e.getMinutes(),fullMinutes:e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes()}};p.getDecade=function(e){var t=Math.floor(e.getFullYear()/10)*10;return[t,t+9]};p.template=function(e,i){return e.replace(/#\{([\w]+)\}/g,function(e,t){if(i[t]||i[t]===0){return i[t]}})};p.isSame=function(e,t,i){if(!e||!t)return false;var s=p.getParsedDate(e),a=p.getParsedDate(t),n=i?i:"day",r={day:s.date==a.date&&s.month==a.month&&s.year==a.year,month:s.month==a.month&&s.year==a.year,year:s.year==a.year};return r[n]};p.less=function(e,t,i){if(!e||!t)return false;return t.getTime()<e.getTime()};p.bigger=function(e,t,i){if(!e||!t)return false;return t.getTime()>e.getTime()};p.getLeadingZeroNum=function(e){return parseInt(e)<10?"0"+e:e};p.resetTime=function(e){if(typeof e!="object")return;e=p.getParsedDate(e);return new Date(e.year,e.month,e.date)};c.fn.datepicker=function(t){return this.each(function(){if(!c.data(this,i)){c.data(this,i,new d(this,t))}else{var e=c.data(this,i);e.opts=c.extend(true,e.opts,t);e.update()}})};c.fn.datepicker.Constructor=d;c.fn.datepicker.language={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear",dateFormat:"mm/dd/yyyy",timeFormat:"hh:ii aa",firstDay:0}};c(function(){c(t).datepicker()})})();(function(){var e={days:""+'<div class="datepicker--days datepicker--body">'+'<div class="datepicker--days-names"></div>'+'<div class="datepicker--cells datepicker--cells-days"></div>'+"</div>",months:""+'<div class="datepicker--months datepicker--body">'+'<div class="datepicker--cells datepicker--cells-months"></div>'+"</div>",years:""+'<div class="datepicker--years datepicker--body">'+'<div class="datepicker--cells datepicker--cells-years"></div>'+"</div>"},t=c.fn.datepicker,u=t.Constructor;t.Body=function(e,t,i){this.d=e;this.type=t;this.opts=i;this.$el=c("");if(this.opts.onlyTimepicker)return;this.init()};t.Body.prototype={init:function(){this._buildBaseHtml();this._render();this._bindEvents()},_bindEvents:function(){this.$el.on("click",".datepicker--cell",c.proxy(this._onClickCell,this))},_buildBaseHtml:function(){this.$el=c(e[this.type]).appendTo(this.d.$content);this.$names=c(".datepicker--days-names",this.$el);this.$cells=c(".datepicker--cells",this.$el)},_getDayNamesHtml:function(e,t,i,s){t=t!=m?t:e;i=i?i:"";s=s!=m?s:0;if(s>7)return i;if(t==7)return this._getDayNamesHtml(e,0,i,++s);i+='<div class="datepicker--day-name'+(this.d.isWeekend(t)?" -weekend-":"")+'">'+this.d.loc.daysMin[t]+"</div>";return this._getDayNamesHtml(e,++t,i,++s)},_getCellContents:function(e,t){var i="datepicker--cell datepicker--cell-"+t,s=new Date,a=this.d,n=u.resetTime(a.minRange),r=u.resetTime(a.maxRange),h=a.opts,o=u.getParsedDate(e),d={},l=o.date;switch(t){case"day":if(a.isWeekend(o.day))i+=" -weekend-";if(o.month!=this.d.parsedDate.month){i+=" -other-month-";if(!h.selectOtherMonths){i+=" -disabled-"}if(!h.showOtherMonths)l=""}break;case"month":l=a.loc[a.opts.monthsField][o.month];break;case"year":var c=a.curDecade;l=o.year;if(o.year<c[0]||o.year>c[1]){i+=" -other-decade-";if(!h.selectOtherYears){i+=" -disabled-"}if(!h.showOtherYears)l=""}break}if(h.onRenderCell){d=h.onRenderCell(e,t)||{};l=d.html?d.html:l;i+=d.classes?" "+d.classes:""}if(h.range){if(u.isSame(n,e,t))i+=" -range-from-";if(u.isSame(r,e,t))i+=" -range-to-";if(a.selectedDates.length==1&&a.focused){if(u.bigger(n,e)&&u.less(a.focused,e)||u.less(r,e)&&u.bigger(a.focused,e)){i+=" -in-range-"}if(u.less(r,e)&&u.isSame(a.focused,e)){i+=" -range-from-"}if(u.bigger(n,e)&&u.isSame(a.focused,e)){i+=" -range-to-"}}else if(a.selectedDates.length==2){if(u.bigger(n,e)&&u.less(r,e)){i+=" -in-range-"}}}if(u.isSame(s,e,t))i+=" -current-";if(a.focused&&u.isSame(e,a.focused,t))i+=" -focus-";if(a._isSelected(e,t))i+=" -selected-";if(!a._isInRange(e,t)||d.disabled)i+=" -disabled-";return{html:l,classes:i}},_getDaysHtml:function(e){var t=u.getDaysCount(e),i=new Date(e.getFullYear(),e.getMonth(),1).getDay(),s=new Date(e.getFullYear(),e.getMonth(),t).getDay(),a=i-this.d.loc.firstDay,n=6-s+this.d.loc.firstDay;a=a<0?a+7:a;n=n>6?n-7:n;var r=-a+1,h,o,d="";for(var l=r,c=t+n;l<=c;l++){o=e.getFullYear();h=e.getMonth();d+=this._getDayHtml(new Date(o,h,l))}return d},_getDayHtml:function(e){var t=this._getCellContents(e,"day");return'<div class="'+t.classes+'" '+'data-date="'+e.getDate()+'" '+'data-month="'+e.getMonth()+'" '+'data-year="'+e.getFullYear()+'">'+t.html+"</div>"},_getMonthsHtml:function(e){var t="",i=u.getParsedDate(e),s=0;while(s<12){t+=this._getMonthHtml(new Date(i.year,s));s++}return t},_getMonthHtml:function(e){var t=this._getCellContents(e,"month");return'<div class="'+t.classes+'" data-month="'+e.getMonth()+'">'+t.html+"</div>"},_getYearsHtml:function(e){var t=u.getParsedDate(e),i=u.getDecade(e),s=i[0]-1,a="",n=s;for(n;n<=i[1]+1;n++){a+=this._getYearHtml(new Date(n,0))}return a},_getYearHtml:function(e){var t=this._getCellContents(e,"year");return'<div class="'+t.classes+'" data-year="'+e.getFullYear()+'">'+t.html+"</div>"},_renderTypes:{days:function(){var e=this._getDayNamesHtml(this.d.loc.firstDay),t=this._getDaysHtml(this.d.currentDate);this.$cells.html(t);this.$names.html(e)},months:function(){var e=this._getMonthsHtml(this.d.currentDate);this.$cells.html(e)},years:function(){var e=this._getYearsHtml(this.d.currentDate);this.$cells.html(e)}},_render:function(){if(this.opts.onlyTimepicker)return;this._renderTypes[this.type].bind(this)()},_update:function(){var e=c(".datepicker--cell",this.$cells),i=this,s,a,n;e.each(function(e,t){a=c(this);n=i.d._getDateFromCell(c(this));s=i._getCellContents(n,i.d.cellType);a.attr("class",s.classes)})},show:function(){if(this.opts.onlyTimepicker)return;this.$el.addClass("active");this.acitve=true},hide:function(){this.$el.removeClass("active");this.active=false},_handleClick:function(e){var t=e.data("date")||1,i=e.data("month")||0,s=e.data("year")||this.d.parsedDate.year,a=this.d;if(a.view!=this.opts.minView){a.down(new Date(s,i,t));return}var n=new Date(s,i,t),r=this.d._isSelected(n,this.d.cellType);if(!this.opts.toggleSelected){r=false}if(!r){a._trigger("clickCell",n);return}a._handleAlreadySelectedDates.bind(a,r,n)()},_onClickCell:function(e){var t=c(e.target).closest(".datepicker--cell");if(t.hasClass("-disabled-"))return;this._handleClick.bind(this)(t)}}})();(function(){var i=""+'<div class="datepicker--nav-action" data-action="prev">#{prevHtml}</div>'+'<div class="datepicker--nav-title">#{title}</div>'+'<div class="datepicker--nav-action" data-action="next">#{nextHtml}</div>',e='<div class="datepicker--buttons"></div>',s='<span class="datepicker--button" data-action="#{action}">#{label}</span>',t=c.fn.datepicker,n=t.Constructor;t.Navigation=function(e,t){this.d=e;this.opts=t;this.$buttonsContainer="";this.init()};t.Navigation.prototype={init:function(){this._buildBaseHtml();this._bindEvents()},_bindEvents:function(){this.d.$nav.on("click",".datepicker--nav-action",c.proxy(this._onClickNavButton,this));this.d.$nav.on("click",".datepicker--nav-title",c.proxy(this._onClickNavTitle,this));this.d.$datepicker.on("click",".datepicker--button",c.proxy(this._onClickNavButton,this))},_buildBaseHtml:function(){if(!this.opts.onlyTimepicker){this._render()}this._addButtonsIfNeed()},_addButtonsIfNeed:function(){if(this.opts.todayButton){this._addButton("today")}if(this.opts.clearButton){this._addButton("clear")}},_render:function(){var e=this._getTitle(this.d.currentDate),t=n.template(i,c.extend({title:e},this.opts));this.d.$nav.html(t);if(this.d.view=="years"){c(".datepicker--nav-title",this.d.$nav).addClass("-disabled-")}this.setNavStatus()},_getTitle:function(e){return this.d.formatDate(this.opts.navTitles[this.d.view],e)},_addButton:function(e){if(!this.$buttonsContainer.length){this._addButtonsContainer()}var t={action:e,label:this.d.loc[e]},i=n.template(s,t);if(c("[data-action="+e+"]",this.$buttonsContainer).length)return;this.$buttonsContainer.append(i)},_addButtonsContainer:function(){this.d.$datepicker.append(e);this.$buttonsContainer=c(".datepicker--buttons",this.d.$datepicker)},setNavStatus:function(){if(!(this.opts.minDate||this.opts.maxDate)||!this.opts.disableNavWhenOutOfRange)return;var e=this.d.parsedDate,t=e.month,i=e.year,s=e.date;switch(this.d.view){case"days":if(!this.d._isInRange(new Date(i,t-1,1),"month")){this._disableNav("prev")}if(!this.d._isInRange(new Date(i,t+1,1),"month")){this._disableNav("next")}break;case"months":if(!this.d._isInRange(new Date(i-1,t,s),"year")){this._disableNav("prev")}if(!this.d._isInRange(new Date(i+1,t,s),"year")){this._disableNav("next")}break;case"years":var a=n.getDecade(this.d.date);if(!this.d._isInRange(new Date(a[0]-1,0,1),"year")){this._disableNav("prev")}if(!this.d._isInRange(new Date(a[1]+1,0,1),"year")){this._disableNav("next")}break}},_disableNav:function(e){c('[data-action="'+e+'"]',this.d.$nav).addClass("-disabled-")},_activateNav:function(e){c('[data-action="'+e+'"]',this.d.$nav).removeClass("-disabled-")},_onClickNavButton:function(e){var t=c(e.target).closest("[data-action]"),i=t.data("action");this.d[i]()},_onClickNavTitle:function(e){if(c(e.target).hasClass("-disabled-"))return;if(this.d.view=="days"){return this.d.view="months"}this.d.view="years"}}})();(function(){var s='<div class="datepicker--time">'+'<div class="datepicker--time-current">'+'   <span class="datepicker--time-current-hours">#{hourVisible}</span>'+'   <span class="datepicker--time-current-colon">:</span>'+'   <span class="datepicker--time-current-minutes">#{minValue}</span>'+"</div>"+'<div class="datepicker--time-sliders">'+'   <div class="datepicker--time-row">'+'      <input type="range" name="hours" value="#{hourValue}" min="#{hourMin}" max="#{hourMax}" step="#{hourStep}">'+"   </div>"+'   <div class="datepicker--time-row">'+'      <input type="range" name="minutes" value="#{minValue}" min="#{minMin}" max="#{minMax}" step="#{minStep}">'+"   </div>"+"</div>"+"</div>",e=c.fn.datepicker,r=e.Constructor;e.Timepicker=function(e,t){this.d=e;this.opts=t;this.init()};e.Timepicker.prototype={init:function(){var e="input";this._setTime(this.d.date);this._buildHTML();if(navigator.userAgent.match(/trident/gi)){e="change"}this.d.$el.on("selectDate",this._onSelectDate.bind(this));this.$ranges.on(e,this._onChangeRange.bind(this));this.$ranges.on("mouseup",this._onMouseUpRange.bind(this));this.$ranges.on("mousemove focus ",this._onMouseEnterRange.bind(this));this.$ranges.on("mouseout blur",this._onMouseOutRange.bind(this))},_setTime:function(e){var t=r.getParsedDate(e);this._handleDate(e);this.hours=t.hours<this.minHours?this.minHours:t.hours;this.minutes=t.minutes<this.minMinutes?this.minMinutes:t.minutes},_setMinTimeFromDate:function(e){this.minHours=e.getHours();this.minMinutes=e.getMinutes();if(this.d.lastSelectedDate){if(this.d.lastSelectedDate.getHours()>e.getHours()){this.minMinutes=this.opts.minMinutes}}},_setMaxTimeFromDate:function(e){this.maxHours=e.getHours();this.maxMinutes=e.getMinutes();if(this.d.lastSelectedDate){if(this.d.lastSelectedDate.getHours()<e.getHours()){this.maxMinutes=this.opts.maxMinutes}}},_setDefaultMinMaxTime:function(){var e=23,t=59,i=this.opts;this.minHours=i.minHours<0||i.minHours>e?0:i.minHours;this.minMinutes=i.minMinutes<0||i.minMinutes>t?0:i.minMinutes;this.maxHours=i.maxHours<0||i.maxHours>e?e:i.maxHours;this.maxMinutes=i.maxMinutes<0||i.maxMinutes>t?t:i.maxMinutes},_validateHoursMinutes:function(e){if(this.hours<this.minHours){this.hours=this.minHours}else if(this.hours>this.maxHours){this.hours=this.maxHours}if(this.minutes<this.minMinutes){this.minutes=this.minMinutes}else if(this.minutes>this.maxMinutes){this.minutes=this.maxMinutes}},_buildHTML:function(){var e=r.getLeadingZeroNum,t={hourMin:this.minHours,hourMax:e(this.maxHours),hourStep:this.opts.hoursStep,hourValue:this.hours,hourVisible:e(this.displayHours),minMin:this.minMinutes,minMax:e(this.maxMinutes),minStep:this.opts.minutesStep,minValue:e(this.minutes)},i=r.template(s,t);this.$timepicker=c(i).appendTo(this.d.$datepicker);this.$ranges=c('[type="range"]',this.$timepicker);this.$hours=c('[name="hours"]',this.$timepicker);this.$minutes=c('[name="minutes"]',this.$timepicker);this.$hoursText=c(".datepicker--time-current-hours",this.$timepicker);this.$minutesText=c(".datepicker--time-current-minutes",this.$timepicker);if(this.d.ampm){this.$ampm=c('<span class="datepicker--time-current-ampm">').appendTo(c(".datepicker--time-current",this.$timepicker)).html(this.dayPeriod);this.$timepicker.addClass("-am-pm-")}},_updateCurrentTime:function(){var e=r.getLeadingZeroNum(this.displayHours),t=r.getLeadingZeroNum(this.minutes);this.$hoursText.html(e);this.$minutesText.html(t);if(this.d.ampm){this.$ampm.html(this.dayPeriod)}},_updateRanges:function(){this.$hours.attr({min:this.minHours,max:this.maxHours}).val(this.hours);this.$minutes.attr({min:this.minMinutes,max:this.maxMinutes}).val(this.minutes)},_handleDate:function(e){this._setDefaultMinMaxTime();if(e){if(r.isSame(e,this.d.opts.minDate)){this._setMinTimeFromDate(this.d.opts.minDate)}else if(r.isSame(e,this.d.opts.maxDate)){this._setMaxTimeFromDate(this.d.opts.maxDate)}}this._validateHoursMinutes(e)},update:function(){this._updateRanges();this._updateCurrentTime()},_getValidHoursFromDate:function(e,t){var i=e,s=e;if(e instanceof Date){i=r.getParsedDate(e);s=i.hours}var a=t||this.d.ampm,n="am";if(a){switch(true){case s==0:s=12;break;case s==12:n="pm";break;case s>11:s=s-12;n="pm";break;default:break}}return{hours:s,dayPeriod:n}},set hours(e){this._hours=e;var t=this._getValidHoursFromDate(e);this.displayHours=t.hours;this.dayPeriod=t.dayPeriod},get hours(){return this._hours},_onChangeRange:function(e){var t=c(e.target),i=t.attr("name");this.d.timepickerIsActive=true;this[i]=t.val();this._updateCurrentTime();this.d._trigger("timeChange",[this.hours,this.minutes]);this._handleDate(this.d.lastSelectedDate);this.update()},_onSelectDate:function(e,t){this._handleDate(t);this.update()},_onMouseEnterRange:function(e){var t=c(e.target).attr("name");c(".datepicker--time-current-"+t,this.$timepicker).addClass("-focus-")},_onMouseOutRange:function(e){var t=c(e.target).attr("name");if(this.d.inFocus)return;c(".datepicker--time-current-"+t,this.$timepicker).removeClass("-focus-")},_onMouseUpRange:function(e){this.d.timepickerIsActive=false}}})()})(window,jQuery);
// #END
