// JS-Script (UM): dataTables.scroller.js @ 2022-09-20 09:51:02 +0000
(function(e){if(typeof define==="function"&&define.amd){define(["jquery","datatables.net"],function(s){return e(s,window,document)})}else if(typeof exports==="object"){module.exports=function(s,t){if(!s){s=window}if(!t||!t.fn.dataTable){t=require("datatables.net")(s,t).$}return e(t,s,s.document)}}else{e(jQuery,window,document)}})(function(v,l,o,i){"use strict";var a=v.fn.dataTable;var n=function(s,t){if(!(this instanceof n)){alert("Scroller warning: Scroller must be initialised with the 'new' keyword.");return}if(t===i){t={}}var e=v.fn.dataTable.Api(s);this.s={dt:e.settings()[0],dtApi:e,tableTop:0,tableBottom:0,redrawTop:0,redrawBottom:0,autoHeight:true,viewportRows:0,stateTO:null,drawTO:null,heights:{jump:null,page:null,virtual:null,scroll:null,row:null,viewport:null},topRowFloat:0,scrollDrawDiff:null,loaderVisible:false,forceReposition:false};this.s=v.extend(this.s,n.oDefaults,t);this.s.heights.row=this.s.rowHeight;this.dom={force:o.createElement("div"),scroller:null,table:null,loader:null};if(this.s.dt.oScroller){return}this.s.dt.oScroller=this;this._fnConstruct()};v.extend(n.prototype,{fnRowToPixels:function(s,t,e){var o;var r=s-this.s.baseRowTop;if(e){o=this._domain("virtualToPhysical",this.s.baseScrollTop);o+=r*this.s.heights.row}else{o=this.s.baseScrollTop;o+=r*this.s.heights.row}return t||t===i?parseInt(o,10):o},fnPixelsToRow:function(s,t,e){var o=s-this.s.baseScrollTop;var r=e?(this._domain("physicalToVirtual",this.s.baseScrollTop)+o)/this.s.heights.row:o/this.s.heights.row+this.s.baseRowTop;return t||t===i?parseInt(r,10):r},fnScrollToRow:function(s,t){var e=this;var o=false;var r=this.fnRowToPixels(s);var i=(this.s.displayBuffer-1)/2*this.s.viewportRows;var l=s-i;if(l<0){l=0}if((r>this.s.redrawBottom||r<this.s.redrawTop)&&this.s.dt._iDisplayStart!==l){o=true;r=this._domain("virtualToPhysical",s*this.s.heights.row);if(this.s.redrawTop<r&&r<this.s.redrawBottom){this.s.forceReposition=true;t=false}}if(typeof t=="undefined"||t){this.s.ani=o;v(this.dom.scroller).animate({scrollTop:r},function(){setTimeout(function(){e.s.ani=false},25)})}else{v(this.dom.scroller).scrollTop(r)}},fnMeasure:function(s){if(this.s.autoHeight){this._fnCalcRowHeight()}var t=this.s.heights;if(t.row){t.viewport=v.contains(o,this.dom.scroller)?v(this.dom.scroller).height():this._parseHeight(v(this.dom.scroller).css("height"));if(!t.viewport){t.viewport=this._parseHeight(v(this.dom.scroller).css("max-height"))}this.s.viewportRows=parseInt(t.viewport/t.row,10)+1;this.s.dt._iDisplayLength=this.s.viewportRows*this.s.displayBuffer}if(s===i||s){this.s.dt.oInstance.fnDraw(false)}},fnPageInfo:function(){var s=this.s.dt,t=this.dom.scroller.scrollTop,e=s.fnRecordsDisplay(),o=Math.ceil(this.fnPixelsToRow(t+this.s.heights.viewport,false,this.s.ani));return{start:Math.floor(this.fnPixelsToRow(t,false,this.s.ani)),end:e<o?e-1:o-1}},_fnConstruct:function(){var o=this;var s=this.s.dtApi;if(!this.s.dt.oFeatures.bPaginate){this.s.dt.oApi._fnLog(this.s.dt,0,"Pagination must be enabled for Scroller");return}this.dom.force.style.position="relative";this.dom.force.style.top="0px";this.dom.force.style.left="0px";this.dom.force.style.width="1px";this.dom.scroller=v("div."+this.s.dt.oClasses.sScrollBody,this.s.dt.nTableWrapper)[0];this.dom.scroller.appendChild(this.dom.force);this.dom.scroller.style.position="relative";this.dom.table=v(">table",this.dom.scroller)[0];this.dom.table.style.position="absolute";this.dom.table.style.top="0px";this.dom.table.style.left="0px";v(s.table().container()).addClass("DTS");if(this.s.loadingIndicator){this.dom.loader=v('<div class="dataTables_processing DTS_Loading">'+this.s.dt.oLanguage.sLoadingRecords+"</div>").css("display","none");v(this.dom.scroller.parentNode).css("position","relative").append(this.dom.loader)}if(this.s.heights.row&&this.s.heights.row!="auto"){this.s.autoHeight=false}this.fnMeasure(false);this.s.ingnoreScroll=true;this.s.stateSaveThrottle=this.s.dt.oApi._fnThrottle(function(){o.s.dtApi.state.save()},500);v(this.dom.scroller).on("scroll.dt-scroller",function(s){o._fnScroll.call(o)});v(this.dom.scroller).on("touchstart.dt-scroller",function(){o._fnScroll.call(o)});v(l).on("resize.dt-scroller",function(){o.fnMeasure(false);o._fnInfo()});var r=true;var i=s.state.loaded();s.on("stateSaveParams.scroller",function(s,t,e){e.scroller={topRow:r&&i&&i.scroller?i.scroller.topRow:o.s.topRowFloat,baseScrollTop:o.s.baseScrollTop,baseRowTop:o.s.baseRowTop};r=false});if(i&&i.scroller){this.s.topRowFloat=i.scroller.topRow;this.s.baseScrollTop=i.scroller.baseScrollTop;this.s.baseRowTop=i.scroller.baseRowTop}s.on("init.scroller",function(){o.fnMeasure(false);o._fnDrawCallback();s.on("draw.scroller",function(){o._fnDrawCallback()})});s.on("preDraw.dt.scroller",function(){o._fnScrollForce()});s.on("destroy.scroller",function(){v(l).off("resize.dt-scroller");v(o.dom.scroller).off(".dt-scroller");v(o.s.dt.nTable).off(".scroller");v(o.s.dt.nTableWrapper).removeClass("DTS");v("div.DTS_Loading",o.dom.scroller.parentNode).remove();o.dom.table.style.position="";o.dom.table.style.top="";o.dom.table.style.left=""})},_fnScroll:function(){var s=this,t=this.s.heights,e=this.dom.scroller.scrollTop,o;if(this.s.skip){return}if(this.s.ingnoreScroll){return}if(this.s.dt.bFiltered||this.s.dt.bSorted){this.s.lastScrollTop=0;return}this._fnInfo();clearTimeout(this.s.stateTO);this.s.stateTO=setTimeout(function(){s.s.dtApi.state.save()},250);if(this.s.forceReposition||e<this.s.redrawTop||e>this.s.redrawBottom){var r=Math.ceil((this.s.displayBuffer-1)/2*this.s.viewportRows);o=parseInt(this._domain("physicalToVirtual",e)/t.row,10)-r;this.s.topRowFloat=this._domain("physicalToVirtual",e)/t.row;this.s.forceReposition=false;if(o<=0){o=0}else if(o+this.s.dt._iDisplayLength>this.s.dt.fnRecordsDisplay()){o=this.s.dt.fnRecordsDisplay()-this.s.dt._iDisplayLength;if(o<0){o=0}}else if(o%2!==0){o++}if(o!=this.s.dt._iDisplayStart){this.s.tableTop=v(this.s.dt.nTable).offset().top;this.s.tableBottom=v(this.s.dt.nTable).height()+this.s.tableTop;var i=function(){if(s.s.scrollDrawReq===null){s.s.scrollDrawReq=e}s.s.dt._iDisplayStart=o;s.s.dt.oApi._fnDraw(s.s.dt)};if(this.s.dt.oFeatures.bServerSide){clearTimeout(this.s.drawTO);this.s.drawTO=setTimeout(i,this.s.serverWait)}else{i()}if(this.dom.loader&&!this.s.loaderVisible){this.dom.loader.css("display","block");this.s.loaderVisible=true}}}else{this.s.topRowFloat=this.fnPixelsToRow(e,false,true)}this.s.lastScrollTop=e;this.s.stateSaveThrottle()},_domain:function(s,t){var e=this.s.heights;var o;if(e.virtual===e.scroll){return t}var r=(e.scroll-e.viewport)/2;var i=(e.virtual-e.viewport)/2;o=i/(r*r);if(s==="virtualToPhysical"){if(t<i){return Math.pow(t/o,.5)}else{t=i*2-t;return t<0?e.scroll:r*2-Math.pow(t/o,.5)}}else if(s==="physicalToVirtual"){if(t<r){return t*t*o}else{t=r*2-t;return t<0?e.virtual:i*2-t*t*o}}},_parseHeight:function(s){var t;var e=/^([+-]?(?:\d+(?:\.\d+)?|\.\d+))(px|em|rem|vh)$/.exec(s);if(e===null){return 0}var o=parseFloat(e[1]);var r=e[2];if(r==="px"){t=o}else if(r==="vh"){t=o/100*v(l).height()}else if(r==="rem"){t=o*parseFloat(v(":root").css("font-size"))}else if(r==="em"){t=o*parseFloat(v("body").css("font-size"))}return t?t:0},_fnDrawCallback:function(){var s=this,t=this.s.heights,e=this.dom.scroller.scrollTop,o=e,r=e+t.viewport,i=v(this.s.dt.nTable).height(),l=this.s.dt._iDisplayStart,a=this.s.dt._iDisplayLength,n=this.s.dt.fnRecordsDisplay();this.s.skip=true;if((this.s.dt.bSorted||this.s.dt.bFiltered)&&l===0){this.s.topRowFloat=0}if(l===0){e=this.s.topRowFloat*t.row}else if(l+a>=n){e=t.scroll-(n-this.s.topRowFloat)*t.row}else{e=this._domain("virtualToPhysical",this.s.topRowFloat*t.row)}this.dom.scroller.scrollTop=e;this.s.baseScrollTop=e;this.s.baseRowTop=this.s.topRowFloat;var h=e-(this.s.topRowFloat-l)*t.row;if(l===0){h=0}else if(l+a>=n){h=t.scroll-i}this.dom.table.style.top=h+"px";this.s.tableTop=h;this.s.tableBottom=i+this.s.tableTop;var f=(e-this.s.tableTop)*this.s.boundaryScale;this.s.redrawTop=e-f;this.s.redrawBottom=e+f>t.scroll-t.viewport-t.row?t.scroll-t.viewport-t.row:e+f;this.s.skip=false;if(this.s.dt.oFeatures.bStateSave&&this.s.dt.oLoadedState!==null&&typeof this.s.dt.oLoadedState.iScroller!="undefined"){var c=(this.s.dt.sAjaxSource||s.s.dt.ajax)&&!this.s.dt.oFeatures.bServerSide?true:false;if(c&&this.s.dt.iDraw==2||!c&&this.s.dt.iDraw==1){setTimeout(function(){v(s.dom.scroller).scrollTop(s.s.dt.oLoadedState.iScroller);s.s.redrawTop=s.s.dt.oLoadedState.iScroller-t.viewport/2;setTimeout(function(){s.s.ingnoreScroll=false},0)},0)}}else{s.s.ingnoreScroll=false}if(this.s.dt.oFeatures.bInfo){setTimeout(function(){s._fnInfo.call(s)},0)}if(this.dom.loader&&this.s.loaderVisible){this.dom.loader.css("display","none");this.s.loaderVisible=false}},_fnScrollForce:function(){var s=this.s.heights;var t=1e6;s.virtual=s.row*this.s.dt.fnRecordsDisplay();s.scroll=s.virtual;if(s.scroll>t){s.scroll=t}this.dom.force.style.height=s.scroll>this.s.heights.row?s.scroll+"px":this.s.heights.row+"px"},_fnCalcRowHeight:function(){var s=this.s.dt;var t=s.nTable;var e=t.cloneNode(false);var o=v("<tbody></tbody>").appendTo(e);var r=v('<div class="'+s.oClasses.sWrapper+' DTS">'+'<div class="'+s.oClasses.sScrollWrapper+'">'+'<div class="'+s.oClasses.sScrollBody+'"></div>'+"</div>"+"</div>");v("tbody tr:lt(4)",t).clone().appendTo(o);while(v("tr",o).length<3){o.append("<tr><td>&nbsp;</td></tr>")}v("div."+s.oClasses.sScrollBody,r).append(e);var i=this.s.dt.nHolding||t.parentNode;if(!v(i).is(":visible")){i="body"}r.appendTo(i);this.s.heights.row=v("tr",o).eq(1).outerHeight();r.remove()},_fnInfo:function(){if(!this.s.dt.oFeatures.bInfo){return}var s=this.s.dt,t=s.oLanguage,e=this.dom.scroller.scrollTop,o=Math.floor(this.fnPixelsToRow(e,false,this.s.ani)+1),r=s.fnRecordsTotal(),i=s.fnRecordsDisplay(),l=Math.ceil(this.fnPixelsToRow(e+this.s.heights.viewport,false,this.s.ani)),a=i<l?i:l,n=s.fnFormatNumber(o),h=s.fnFormatNumber(a),f=s.fnFormatNumber(r),c=s.fnFormatNumber(i),d;if(s.fnRecordsDisplay()===0&&s.fnRecordsDisplay()==s.fnRecordsTotal()){d=t.sInfoEmpty+t.sInfoPostFix}else if(s.fnRecordsDisplay()===0){d=t.sInfoEmpty+" "+t.sInfoFiltered.replace("_MAX_",f)+t.sInfoPostFix}else if(s.fnRecordsDisplay()==s.fnRecordsTotal()){d=t.sInfo.replace("_START_",n).replace("_END_",h).replace("_MAX_",f).replace("_TOTAL_",c)+t.sInfoPostFix}else{d=t.sInfo.replace("_START_",n).replace("_END_",h).replace("_MAX_",f).replace("_TOTAL_",c)+" "+t.sInfoFiltered.replace("_MAX_",s.fnFormatNumber(s.fnRecordsTotal()))+t.sInfoPostFix}var p=t.fnInfoCallback;if(p){d=p.call(s.oInstance,s,o,a,r,i,d)}var u=s.aanFeatures.i;if(typeof u!="undefined"){for(var w=0,T=u.length;w<T;w++){v(u[w]).html(d)}}v(s.nTable).triggerHandler("info.dt")}});n.defaults={trace:false,rowHeight:"auto",serverWait:200,displayBuffer:9,boundaryScale:.5,loadingIndicator:false};n.oDefaults=n.defaults;n.version="1.5.1";if(typeof v.fn.dataTable=="function"&&typeof v.fn.dataTableExt.fnVersionCheck=="function"&&v.fn.dataTableExt.fnVersionCheck("1.10.0")){v.fn.dataTableExt.aoFeatures.push({fnInit:function(s){var t=s.oInit;var e=t.scroller||t.oScroller||{};new n(s,e)},cFeature:"S",sFeature:"Scroller"})}else{alert("Warning: Scroller requires DataTables 1.10.0 or greater - www.datatables.net/download")}v(o).on("preInit.dt.dtscroller",function(s,t){if(s.namespace!=="dt"){return}var e=t.oInit.scroller;var o=a.defaults.scroller;if(e||o){var r=v.extend({},e,o);if(e!==false){new n(t,r)}}});v.fn.dataTable.Scroller=n;v.fn.DataTable.Scroller=n;var s=v.fn.dataTable.Api;s.register("scroller()",function(){return this});s.register("scroller().rowToPixels()",function(s,t,e){var o=this.context;if(o.length&&o[0].oScroller){return o[0].oScroller.fnRowToPixels(s,t,e)}});s.register("scroller().pixelsToRow()",function(s,t,e){var o=this.context;if(o.length&&o[0].oScroller){return o[0].oScroller.fnPixelsToRow(s,t,e)}});s.register(["scroller().scrollToRow()","scroller.toPosition()"],function(t,e){this.iterator("table",function(s){if(s.oScroller){s.oScroller.fnScrollToRow(t,e)}});return this});s.register("row().scrollTo()",function(o){var r=this;this.iterator("row",function(s,t){if(s.oScroller){var e=r.rows({order:"applied",search:"applied"}).indexes().indexOf(t);s.oScroller.fnScrollToRow(e,o)}});return this});s.register("scroller.measure()",function(t){this.iterator("table",function(s){if(s.oScroller){s.oScroller.fnMeasure(t)}});return this});s.register("scroller.page()",function(){var s=this.context;if(s.length&&s[0].oScroller){return s[0].oScroller.fnPageInfo()}});return n});
// #END
