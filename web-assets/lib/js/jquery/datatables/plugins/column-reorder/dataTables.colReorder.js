// JS-Script (UM): dataTables.colReorder.js @ 2022-09-20 09:50:59 +0000
(function(o){if(typeof define==="function"&&define.amd){define(["jquery","datatables.net"],function(t){return o(t,window,document)})}else if(typeof exports==="object"){module.exports=function(t,e){if(!t){t=window}if(!e||!e.fn.dataTable){e=require("datatables.net")(t,e).$}return o(e,t,t.document)}}else{o(jQuery,window,document)}})(function(R,t,i,b){"use strict";var n=R.fn.dataTable;function x(t){var e=[];for(var o=0,r=t.length;o<r;o++){e[t[o]]=o}return e}function T(t,e,o){var r=t.splice(e,1)[0];t.splice(o,0,r)}function S(t,e,o){var r=[];for(var s=0,n=t.childNodes.length;s<n;s++){if(t.childNodes[s].nodeType==1){r.push(t.childNodes[s])}}var i=r[e];if(o!==null){t.insertBefore(i,r[o])}else{t.appendChild(i)}}R.fn.dataTableExt.oApi.fnColReorder=function(o,t,e,r,s){var n,i,a,l,d,f=o.aoColumns.length,h,u;var c=function(t,e,o){if(!t[e]||typeof t[e]==="function"){return}var r=t[e].split(".");var s=r.shift();if(isNaN(s*1)){return}t[e]=o[s*1]+"."+r.join(".")};if(t==e){return}if(t<0||t>=f){this.oApi._fnLog(o,1,"ColReorder 'from' index is out of bounds: "+t);return}if(e<0||e>=f){this.oApi._fnLog(o,1,"ColReorder 'to' index is out of bounds: "+e);return}var g=[];for(n=0,i=f;n<i;n++){g[n]=n}T(g,t,e);var m=x(g);for(n=0,i=o.aaSorting.length;n<i;n++){o.aaSorting[n][0]=m[o.aaSorting[n][0]]}if(o.aaSortingFixed!==null){for(n=0,i=o.aaSortingFixed.length;n<i;n++){o.aaSortingFixed[n][0]=m[o.aaSortingFixed[n][0]]}}for(n=0,i=f;n<i;n++){u=o.aoColumns[n];for(a=0,l=u.aDataSort.length;a<l;a++){u.aDataSort[a]=m[u.aDataSort[a]]}u.idx=m[u.idx]}R.each(o.aLastSort,function(t,e){o.aLastSort[t].src=m[e.src]});for(n=0,i=f;n<i;n++){u=o.aoColumns[n];if(typeof u.mData=="number"){u.mData=m[u.mData]}else if(R.isPlainObject(u.mData)){c(u.mData,"_",m);c(u.mData,"filter",m);c(u.mData,"sort",m);c(u.mData,"type",m)}}if(o.aoColumns[t].bVisible){var C=this.oApi._fnColumnIndexToVisible(o,t);var p=null;n=e<t?e:e+1;while(p===null&&n<f){p=this.oApi._fnColumnIndexToVisible(o,n);n++}h=o.nTHead.getElementsByTagName("tr");for(n=0,i=h.length;n<i;n++){S(h[n],C,p)}if(o.nTFoot!==null){h=o.nTFoot.getElementsByTagName("tr");for(n=0,i=h.length;n<i;n++){S(h[n],C,p)}}for(n=0,i=o.aoData.length;n<i;n++){if(o.aoData[n].nTr!==null){S(o.aoData[n].nTr,C,p)}}}T(o.aoColumns,t,e);for(n=0,i=f;n<i;n++){o.oApi._fnColumnOptions(o,n,{})}T(o.aoPreSearchCols,t,e);for(n=0,i=o.aoData.length;n<i;n++){var _=o.aoData[n];var v=_.anCells;if(v){T(v,t,e);for(a=0,d=v.length;a<d;a++){if(v[a]&&v[a]._DT_CellIndex){v[a]._DT_CellIndex.column=a}}}if(_.src!=="dom"&&Array.isArray(_._aData)){T(_._aData,t,e)}}for(n=0,i=o.aoHeader.length;n<i;n++){T(o.aoHeader[n],t,e)}if(o.aoFooter!==null){for(n=0,i=o.aoFooter.length;n<i;n++){T(o.aoFooter[n],t,e)}}if(s||s===b){R.fn.dataTable.Api(o).rows().invalidate()}for(n=0,i=f;n<i;n++){R(o.aoColumns[n].nTh).off(".DT");this.oApi._fnSortAttachListener(o,o.aoColumns[n].nTh,n)}R(o.oInstance).trigger("column-reorder.dt",[o,{from:t,to:e,mapping:m,drop:r,iFrom:t,iTo:e,aiInvertMapping:m}])};var a=function(t,e){var o=new R.fn.dataTable.Api(t).settings()[0];if(o._colReorder){return o._colReorder}if(e===true){e={}}var r=R.fn.dataTable.camelToLatinExtended;if(r){r(a.defaults,a.defaults,true);r(a.defaults,e||{})}this.s={dt:null,enable:null,init:R.extend(true,{},a.defaults,e),fixed:0,fixedRight:0,reorderCallback:null,mouse:{startX:-1,startY:-1,offsetX:-1,offsetY:-1,target:-1,targetIndex:-1,fromIndex:-1},aoTargets:[]};this.dom={drag:null,pointer:null};this.s.enable=this.s.init.bEnable;this.s.dt=o;this.s.dt._colReorder=this;this._fnConstruct();return this};R.extend(a.prototype,{fnEnable:function(t){if(t===false){return fnDisable()}this.s.enable=true},fnDisable:function(){this.s.enable=false},fnReset:function(){this._fnOrderColumns(this.fnOrder());return this},fnGetCurrentOrder:function(){return this.fnOrder()},fnOrder:function(t,e){var o=[],r,s,n,i;var a=this.s.dt.aoColumns;if(t===b){for(r=0,s=a.length;r<s;r++){o.push(a[r]._ColReorder_iOrigCol)}return o}if(e){var l=this.fnOrder();for(r=0,s=t.length;r<s;r++){o.push(R.inArray(t[r],l))}t=o}this._fnOrderColumns(x(t));return this},fnTranspose:function(t,e){if(!e){e="toCurrent"}var o=this.fnOrder();var r=this.s.dt.aoColumns;if(e==="toCurrent"){return!Array.isArray(t)?R.inArray(t,o):R.map(t,function(t){return R.inArray(t,o)})}else{return!Array.isArray(t)?r[t]._ColReorder_iOrigCol:R.map(t,function(t){return r[t]._ColReorder_iOrigCol})}},_fnConstruct:function(){var o=this;var t=this.s.dt.aoColumns.length;var e=this.s.dt.nTable;var r;if(this.s.init.iFixedColumns){this.s.fixed=this.s.init.iFixedColumns}if(this.s.init.iFixedColumnsLeft){this.s.fixed=this.s.init.iFixedColumnsLeft}this.s.fixedRight=this.s.init.iFixedColumnsRight?this.s.init.iFixedColumnsRight:0;if(this.s.init.fnReorderCallback){this.s.reorderCallback=this.s.init.fnReorderCallback}for(r=0;r<t;r++){if(r>this.s.fixed-1&&r<t-this.s.fixedRight){this._fnMouseListener(r,this.s.dt.aoColumns[r].nTh)}this.s.dt.aoColumns[r]._ColReorder_iOrigCol=r}this.s.dt.oApi._fnCallbackReg(this.s.dt,"aoStateSaveParams",function(t,e){o._fnStateSave.call(o,e)},"ColReorder_State");var s=null;if(this.s.init.aiOrder){s=this.s.init.aiOrder.slice()}if(this.s.dt.oLoadedState&&typeof this.s.dt.oLoadedState.ColReorder!="undefined"&&this.s.dt.oLoadedState.ColReorder.length==this.s.dt.aoColumns.length){s=this.s.dt.oLoadedState.ColReorder}if(s){if(!o.s.dt._bInitComplete){var n=false;R(e).on("draw.dt.colReorder",function(){if(!o.s.dt._bInitComplete&&!n){n=true;var t=x(s);o._fnOrderColumns.call(o,t)}})}else{var i=x(s);o._fnOrderColumns.call(o,i)}}else{this._fnSetColumnIndexes()}R(e).on("destroy.dt.colReorder",function(){R(e).off("destroy.dt.colReorder draw.dt.colReorder");R.each(o.s.dt.aoColumns,function(t,e){R(e.nTh).off(".ColReorder");R(e.nTh).removeAttr("data-column-index")});o.s.dt._colReorder=null;o.s=null})},_fnOrderColumns:function(t){var e=false;if(t.length!=this.s.dt.aoColumns.length){this.s.dt.oInstance.oApi._fnLog(this.s.dt,1,"ColReorder - array reorder does not "+"match known number of columns. Skipping.");return}for(var o=0,r=t.length;o<r;o++){var s=R.inArray(o,t);if(o!=s){T(t,s,o);this.s.dt.oInstance.fnColReorder(s,o,true,false);e=true}}this._fnSetColumnIndexes();if(!e){return}R.fn.dataTable.Api(this.s.dt).rows().invalidate();if(this.s.dt.oScroll.sX!==""||this.s.dt.oScroll.sY!==""){this.s.dt.oInstance.fnAdjustColumnSizing(false)}this.s.dt.oInstance.oApi._fnSaveState(this.s.dt);if(this.s.reorderCallback!==null){this.s.reorderCallback.call(this)}},_fnStateSave:function(t){var e,o,r,s;var n=this.s.dt;var i=n.aoColumns;t.ColReorder=[];if(t.aaSorting){for(e=0;e<t.aaSorting.length;e++){t.aaSorting[e][0]=i[t.aaSorting[e][0]]._ColReorder_iOrigCol}var a=R.extend(true,[],t.aoSearchCols);for(e=0,o=i.length;e<o;e++){s=i[e]._ColReorder_iOrigCol;t.aoSearchCols[s]=a[e];t.abVisCols[s]=i[e].bVisible;t.ColReorder.push(s)}}else if(t.order){for(e=0;e<t.order.length;e++){t.order[e][0]=i[t.order[e][0]]._ColReorder_iOrigCol}var l=R.extend(true,[],t.columns);for(e=0,o=i.length;e<o;e++){s=i[e]._ColReorder_iOrigCol;t.columns[s]=l[e];t.ColReorder.push(s)}}},_fnMouseListener:function(t,e){var o=this;R(e).on("mousedown.ColReorder",function(t){if(o.s.enable){o._fnMouseDown.call(o,t,e)}}).on("touchstart.ColReorder",function(t){if(o.s.enable){o._fnMouseDown.call(o,t,e)}})},_fnMouseDown:function(t,e){var o=this;var r=R(t.target).closest("th, td");var s=r.offset();var n=parseInt(R(e).attr("data-column-index"),10);if(n===b){return}this.s.mouse.startX=this._fnCursorPosition(t,"pageX");this.s.mouse.startY=this._fnCursorPosition(t,"pageY");this.s.mouse.offsetX=this._fnCursorPosition(t,"pageX")-s.left;this.s.mouse.offsetY=this._fnCursorPosition(t,"pageY")-s.top;this.s.mouse.target=this.s.dt.aoColumns[n].nTh;this.s.mouse.targetIndex=n;this.s.mouse.fromIndex=n;this._fnRegions();R(i).on("mousemove.ColReorder touchmove.ColReorder",function(t){o._fnMouseMove.call(o,t)}).on("mouseup.ColReorder touchend.ColReorder",function(t){o._fnMouseUp.call(o,t)})},_fnMouseMove:function(t){var e=this;if(this.dom.drag===null){if(Math.pow(Math.pow(this._fnCursorPosition(t,"pageX")-this.s.mouse.startX,2)+Math.pow(this._fnCursorPosition(t,"pageY")-this.s.mouse.startY,2),.5)<5){return}this._fnCreateDragNode()}this.dom.drag.css({left:this._fnCursorPosition(t,"pageX")-this.s.mouse.offsetX,top:this._fnCursorPosition(t,"pageY")-this.s.mouse.offsetY});var o=false;var r=this.s.mouse.toIndex;for(var s=1,n=this.s.aoTargets.length;s<n;s++){if(this._fnCursorPosition(t,"pageX")<this.s.aoTargets[s-1].x+(this.s.aoTargets[s].x-this.s.aoTargets[s-1].x)/2){this.dom.pointer.css("left",this.s.aoTargets[s-1].x);this.s.mouse.toIndex=this.s.aoTargets[s-1].to;o=true;break}}if(!o){this.dom.pointer.css("left",this.s.aoTargets[this.s.aoTargets.length-1].x);this.s.mouse.toIndex=this.s.aoTargets[this.s.aoTargets.length-1].to}if(this.s.init.bRealtime&&r!==this.s.mouse.toIndex){this.s.dt.oInstance.fnColReorder(this.s.mouse.fromIndex,this.s.mouse.toIndex);this.s.mouse.fromIndex=this.s.mouse.toIndex;if(this.s.dt.oScroll.sX!==""||this.s.dt.oScroll.sY!==""){this.s.dt.oInstance.fnAdjustColumnSizing(false)}this._fnRegions()}},_fnMouseUp:function(t){var e=this;R(i).off(".ColReorder");if(this.dom.drag!==null){this.dom.drag.remove();this.dom.pointer.remove();this.dom.drag=null;this.dom.pointer=null;this.s.dt.oInstance.fnColReorder(this.s.mouse.fromIndex,this.s.mouse.toIndex,true);this._fnSetColumnIndexes();if(this.s.dt.oScroll.sX!==""||this.s.dt.oScroll.sY!==""){this.s.dt.oInstance.fnAdjustColumnSizing(false)}this.s.dt.oInstance.oApi._fnSaveState(this.s.dt);if(this.s.reorderCallback!==null){this.s.reorderCallback.call(this)}}},_fnRegions:function(){var t=this.s.dt.aoColumns;this.s.aoTargets.splice(0,this.s.aoTargets.length);this.s.aoTargets.push({x:R(this.s.dt.nTable).offset().left,to:0});var e=0;var o=this.s.aoTargets[0].x;for(var r=0,s=t.length;r<s;r++){if(r!=this.s.mouse.fromIndex){e++}if(t[r].bVisible&&t[r].nTh.style.display!=="none"){o+=R(t[r].nTh).outerWidth();this.s.aoTargets.push({x:o,to:e})}}if(this.s.fixedRight!==0){this.s.aoTargets.splice(this.s.aoTargets.length-this.s.fixedRight)}if(this.s.fixed!==0){this.s.aoTargets.splice(0,this.s.fixed)}},_fnCreateDragNode:function(){var t=this.s.dt.oScroll.sX!==""||this.s.dt.oScroll.sY!=="";var e=this.s.dt.aoColumns[this.s.mouse.targetIndex].nTh;var o=e.parentNode;var r=o.parentNode;var s=r.parentNode;var n=R(e).clone();this.dom.drag=R(s.cloneNode(false)).addClass("DTCR_clonedTable").append(R(r.cloneNode(false)).append(R(o.cloneNode(false)).append(n[0]))).css({position:"absolute",top:0,left:0,width:R(e).outerWidth(),height:R(e).outerHeight()}).appendTo("body");this.dom.pointer=R("<div></div>").addClass("DTCR_pointer").css({position:"absolute",top:t?R("div.dataTables_scroll",this.s.dt.nTableWrapper).offset().top:R(this.s.dt.nTable).offset().top,height:t?R("div.dataTables_scroll",this.s.dt.nTableWrapper).height():R(this.s.dt.nTable).height()}).appendTo("body")},_fnSetColumnIndexes:function(){R.each(this.s.dt.aoColumns,function(t,e){R(e.nTh).attr("data-column-index",t)})},_fnCursorPosition:function(t,e){if(t.type.indexOf("touch")!==-1){return t.originalEvent.touches[0][e]}return t[e]}});a.defaults={aiOrder:null,bEnable:true,bRealtime:true,iFixedColumnsLeft:0,iFixedColumnsRight:0,fnReorderCallback:null};a.version="1.5.1";R.fn.dataTable.ColReorder=a;R.fn.DataTable.ColReorder=a;if(typeof R.fn.dataTable=="function"&&typeof R.fn.dataTableExt.fnVersionCheck=="function"&&R.fn.dataTableExt.fnVersionCheck("1.10.8")){R.fn.dataTableExt.aoFeatures.push({fnInit:function(t){var e=t.oInstance;if(!t._colReorder){var o=t.oInit;var r=o.colReorder||o.oColReorder||{};new a(t,r)}else{e.oApi._fnLog(t,1,"ColReorder attempted to initialise twice. Ignoring second")}return null},cFeature:"R",sFeature:"ColReorder"})}else{alert("Warning: ColReorder requires DataTables 1.10.8 or greater - www.datatables.net/download")}R(i).on("preInit.dt.colReorder",function(t,e){if(t.namespace!=="dt"){return}var o=e.oInit.colReorder;var r=n.defaults.colReorder;if(o||r){var s=R.extend({},o,r);if(o!==false){new a(e,s)}}});R.fn.dataTable.Api.register("colReorder.reset()",function(){return this.iterator("table",function(t){t._colReorder.fnReset()})});R.fn.dataTable.Api.register("colReorder.order()",function(e,o){if(e){return this.iterator("table",function(t){t._colReorder.fnOrder(e,o)})}return this.context.length?this.context[0]._colReorder.fnOrder():null});R.fn.dataTable.Api.register("colReorder.transpose()",function(t,e){return this.context.length&&this.context[0]._colReorder?this.context[0]._colReorder.fnTranspose(t,e):t});R.fn.dataTable.Api.register("colReorder.move()",function(t,e,o,r){if(this.context.length){this.context[0]._colReorder.s.dt.oInstance.fnColReorder(t,e,o,r)}return this});R.fn.dataTable.Api.register("colReorder.enable()",function(e){return this.iterator("table",function(t){if(t._colReorder){t._colReorder.fnEnable(e)}})});R.fn.dataTable.Api.register("colReorder.disable()",function(){return this.iterator("table",function(t){if(t._colReorder){t._colReorder.fnDisable()}})});return a});
// #END
