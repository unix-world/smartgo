// JS-Script (US): jquery.htmlcleaner.js @ 2022-10-19 22:05:32 +0000
(function($){$.fn.htmlClean=function(options){return this.each(function(){if(this.value){this.value=$.htmlClean(this.value,options)}else{this.innerHTML=$.htmlClean(this.innerHTML,options)}})};$.htmlClean=function(html,options){options=$.extend({},$.htmlClean.defaults,options);options.allowEmpty=tagAllowEmpty.concat(options.allowEmpty);fixTagOptions(options);var tagsRE=/(<(\/)?(\w+:)?([\w]+)([^>]*)>)|<!--(.*?--)>/gi;var attrsRE=/([\w\-]+)\s*=\s*(".*?"|'.*?'|[^\s>\/]*)/gi;var tagMatch;var root=new Element;var stack=[root];var container=root;if(options.bodyOnly){if(tagMatch=/<body[^>]*>((\n|.)*)<\/body>/i.exec(html)){html=tagMatch[1]}}html=html.concat("<xxx>");var lastIndex;while(tagMatch=tagsRE.exec(html)){var tag=tagMatch[6]?new Tag("--",null,tagMatch[6],options):new Tag(tagMatch[4],tagMatch[2],tagMatch[5],options);var text=html.substring(lastIndex,tagMatch.index);if(text.length>0){var child=container.children[container.children.length-1];if(container.children.length>0&&isText(child=container.children[container.children.length-1])){container.children[container.children.length-1]=child.concat(text)}else{container.children.push(text)}}lastIndex=tagsRE.lastIndex;if(tag.isClosing){if(popToTagName(stack,[tag.name])){stack.pop();container=stack[stack.length-1]}}else{var element=new Element(tag);var attrMatch;while(attrMatch=attrsRE.exec(tag.rawAttributes)){if(attrMatch[1].toLowerCase()=="style"&&options.replaceStyles){var renderParent=!tag.isInline;for(var i=0;i<options.replaceStyles.length;i++){if(options.replaceStyles[i][0].test(attrMatch[2])){if(!renderParent){tag.render=false;renderParent=true}container.children.push(element);stack.push(element);container=element;tag=new Tag(options.replaceStyles[i][1],"","",options);element=new Element(tag)}}}if(tag.allowedAttributes!=null&&(tag.allowedAttributes.length==0||$.inArray(attrMatch[1].toLowerCase(),tag.allowedAttributes)>-1)){element.attributes.push(new Attribute(attrMatch[1],attrMatch[2]))}}$.each(tag.requiredAttributes,function(){var name=this.toString();if(!element.hasAttribute(name)){element.attributes.push(new Attribute(name,""))}});for(var repIndex=0;repIndex<options.replace.length;repIndex++){for(var tagIndex=0;tagIndex<options.replace[repIndex][0].length;tagIndex++){var byName=typeof options.replace[repIndex][0][tagIndex]=="string";if(byName&&options.replace[repIndex][0][tagIndex]==tag.name||!byName&&options.replace[repIndex][0][tagIndex].test(tagMatch)){tag.rename(options.replace[repIndex][1]);repIndex=options.replace.length;break}}}var add=true;if(!container.isRoot){if(container.tag.isInline&&!tag.isInline){if(add=popToContainer(stack)){container=stack[stack.length-1]}}else if(container.tag.disallowNest&&tag.disallowNest&&!tag.requiredParent){add=false}else if(tag.requiredParent){if(add=popToTagName(stack,tag.requiredParent)){container=stack[stack.length-1]}}}if(add){container.children.push(element);if(tag.toProtect){var tagMatch2;while(tagMatch2=tagsRE.exec(html)){var tag2=new Tag(tagMatch2[4],tagMatch2[1],tagMatch2[5],options);if(tag2.isClosing&&tag2.name==tag.name){element.children.push(RegExp.leftContext.substring(lastIndex));lastIndex=tagsRE.lastIndex;break}}}else{if(!tag.isSelfClosing&&!tag.isNonClosing){stack.push(element);container=element}}}}}return render(root,options).join("").replace(/\r\n/gi,"\n").replace(/\>\n\n\</gi,">\n<").replace(/ {2,}/g," ")};$.htmlClean.defaults={bodyOnly:true,allowedTags:[],removeTags:[],allowedAttributes:[],removeAttrs:[],allowedClasses:[],format:true,replace:[[["strong","big"],"b"],[["em"],"i"],[["strike"],"s"]],replaceStyles:[],allowComments:true,allowEmpty:[],forceResponsiveImg:false};function render(element,options){var output=[],empty=element.attributes.length==0;if(element.tag.isComment){if(options.allowComments){output.push("\x3c!--");output.push(element.tag.rawAttributes);output.push(">")}}else{var renderTag=element.tag.render&&(options.allowedTags.length==0||$.inArray(element.tag.name,options.allowedTags)>-1)&&(options.removeTags.length==0||$.inArray(element.tag.name,options.removeTags)==-1);if(!element.isRoot&&renderTag){if($.inArray(element.tag.name,tagStartAddNewLineBefore)>-1){output.push("\n")}output.push("<");output.push(element.tag.name);$.each(element.attributes,function(){if($.inArray(this.name,options.removeAttrs)==-1){var m=RegExp(/^(['"]?)(.*?)['"]?$/).exec(this.value);var value=m[2];var valueQuote=m[1]||"'";if(this.name=="class"&&options.allowedClasses.length>0){value=$.grep(value.split(" "),function(c){return $.grep(options.allowedClasses,function(a){return a==c||a[0]==c&&(a.length==1||$.inArray(element.tag.name,a[1])>-1)}).length>0}).join(" ")}if(value!=null&&(value.length>0||$.inArray(this.name,element.tag.requiredAttributes)>-1)){output.push(" ");output.push(this.name);output.push("=");output.push(valueQuote);output.push(value);output.push(valueQuote)}}})}if(element.tag.isSelfClosing){if(renderTag){output.push(">")}if($.inArray(element.tag.name,tagStartAddNewLineAfter)>-1){output.push("\n")}empty=false}else if(element.tag.isNonClosing){empty=false}else{if(!element.isRoot&&renderTag){output.push(">")}if($.inArray(element.tag.name,tagStartAddNewLineAfter)>-1){output.push("\n")}if(element.tag.toProtect){outputChildren="\n"+$.htmlClean.trim(element.children.join(""));output.push(outputChildren);empty=outputChildren.length==0}else{var outputChildren=[];for(var i=0;i<element.children.length;i++){var child=element.children[i];var text=$.htmlClean.trim(textClean(isText(child)?child:child.childrenToString()));if(isInline(child)){if(i>0&&text.length>0&&(startsWithWhitespace(child)||endsWithWhitespace(element.children[i-1]))){outputChildren.push("\n")}}if(isText(child)){if(text.length>0){outputChildren.push(text)}}else{if(i!=element.children.length-1||child.tag.name!="br"){outputChildren=outputChildren.concat(render(child,options))}}}if(outputChildren.length>0){output=output.concat(outputChildren);empty=false}}if(!element.isRoot&&renderTag){if($.inArray(element.tag.name,tagEndAddNewLineBefore)>-1){output.push("\n")}output.push("</");output.push(element.tag.name);output.push(">");if($.inArray(element.tag.name,tagEndAddNewLineAfter)>-1){output.push("\n")}}}if(!element.tag.allowEmpty&&empty){return[]}}return output}function popToTagName(stack,tagNameArray){return pop(stack,function(element){return $.inArray(element.tag.nameOriginal,tagNameArray)>-1})}function popToContainer(stack){return pop(stack,function(element){return element.isRoot||!element.tag.isInline})}function pop(stack,test,index){index=index||1;var element=stack[stack.length-index];if(test(element)){return true}else if(stack.length-index>0&&pop(stack,test,index+1)){stack.pop();return true}return false}function Element(tag){if(tag){this.tag=tag;this.isRoot=false}else{this.tag=new Tag("root");this.isRoot=true}this.attributes=[];this.children=[];this.hasAttribute=function(name){for(var i=0;i<this.attributes.length;i++){if(this.attributes[i].name==name){return true}}return false};this.childrenToString=function(){return this.children.join("")};return this}function Attribute(name,value){this.name=name;this.value=value;return this}function Tag(name,close,rawAttributes,options){try{this.name=name.toLowerCase();this.nameOriginal=this.name;this.render=true;this.init=function(){if(this.name=="--"){this.isComment=true;this.isSelfClosing=true;this.format=true}else{this.isComment=false;this.isSelfClosing=$.inArray(this.name,tagSelfClosing)>-1;this.isNonClosing=$.inArray(this.name,tagNonClosing)>-1;this.isClosing=close!=undefined&&close.length>0;this.isInline=$.inArray(this.name,tagInline)>-1;this.disallowNest=$.inArray(this.name,tagDisallowNest)>-1;this.requiredParent=tagRequiredParent[$.inArray(this.name,tagRequiredParent)+1];this.allowEmpty=options&&$.inArray(this.name,options.allowEmpty)>-1;this.toProtect=$.inArray(this.name,tagProtect)>-1;this.format=$.inArray(this.name,tagFormat)>-1||!this.isInline}this.rawAttributes=rawAttributes;this.requiredAttributes=tagAttributesRequired[$.inArray(this.name,tagAttributesRequired)+1];if(options){if(!options.tagAttributesCache){options.tagAttributesCache=[]}if($.inArray(this.name,options.tagAttributesCache)==-1){var cacheItem=tagAttributes[$.inArray(this.name,tagAttributes)+1].slice(0);for(var i=0;i<options.allowedAttributes.length;i++){var attrName=options.allowedAttributes[i][0];if((options.allowedAttributes[i].length==1||$.inArray(this.name,options.allowedAttributes[i][1])>-1)&&$.inArray(attrName,cacheItem)==-1){cacheItem.push(attrName)}}options.tagAttributesCache.push(this.name);options.tagAttributesCache.push(cacheItem)}this.allowedAttributes=options.tagAttributesCache[$.inArray(this.name,options.tagAttributesCache)+1]}};this.init();this.rename=function(newName){this.name=newName;this.init()}}catch(err){console.warn("jQuery HTML Cleaner Parse (TAG) mismatch: "+err)}return this}function startsWithWhitespace(item){while(isElement(item)&&item.children.length>0){item=item.children[0]}if(!isText(item)){return false}var text=textClean(item);return text.length>0&&$.htmlClean.isWhitespace(text.charAt(0))}function endsWithWhitespace(item){while(isElement(item)&&item.children.length>0){item=item.children[item.children.length-1]}if(!isText(item)){return false}var text=textClean(item);return text.length>0&&$.htmlClean.isWhitespace(text.charAt(text.length-1))}function isText(item){return item.constructor==String}function isInline(item){return isText(item)||item.tag.isInline}function isElement(item){return item.constructor==Element}function textClean(text){return text.replace(/\n/g," ").replace(/\s\s+/g," ")}$.htmlClean.trim=function(text){return $.htmlClean.trimStart($.htmlClean.trimEnd(text))};$.htmlClean.trimStart=function(text){return text.substring($.htmlClean.trimStartIndex(text))};$.htmlClean.trimStartIndex=function(text){for(var start=0;start<text.length-1&&$.htmlClean.isWhitespace(text.charAt(start));start++);return start};$.htmlClean.trimEnd=function(text){return text.substring(0,$.htmlClean.trimEndIndex(text))};$.htmlClean.trimEndIndex=function(text){for(var end=text.length-1;end>=0&&$.htmlClean.isWhitespace(text.charAt(end));end--);return end+1};$.htmlClean.isWhitespace=function(c){return $.inArray(c,whitespace)!=-1};var tagInline=["a","abbr","acronym","address","annotation","b","bdi","bdo","big","button","br","caption","cite","data","del","em","figcaption","font","hr","i","input","img","ins","kbd","label","legend","map","mark","menuitem","progress","q","s","samp","select","option","param","small","span","strike","strong","sub","sup","time","tt","u","var"];var tagFormat=["address","button","caption","code","input","label","legend","select","option","param"];var tagDisallowNest=["h1","h2","h3","h4","h5","h6","p","th","td","object"];var tagAllowEmpty=["body","th","td","tbody","section","article","div","span","ul","ol","li","a","pre","legend","output","nav","menu","article","blockquote","select","textarea","option","optgroup","label","canvas","iframe","details","summary","dfn"];var tagStartAddNewLineBefore=["script","table","thead","tbody","tfoot","tr","th","td","div","section","hgroup","header","main","footer","aside","nav","menu","ul","ol","li","option","optgroup","hr","pre"];var tagStartAddNewLineAfter=["picture","video","audio","source","link","figure"];var tagEndAddNewLineBefore=["script","style","picture","video","audio","pre","code","template"];var tagEndAddNewLineAfter=["script","style","table","tr","th","td","div","nav","menu","ul","ol","li","option","optgroup","colgroup","picture","figure","video","audio"];var tagRequiredParent=[null,"li",["ul","ol"],"td",["tr"],"th",["tr"],"tr",["table","thead","tbody","tfoot"],"thead",["table"],"tbody",["table"],"tfoot",["table"],"source",["picture","audio","video"],"option",["select"],"optgroup",["select"],"dt",["dl"],"dd",["dl"],"param",["object"]];var tagProtect=["script","style","pre","code","noscript"];var tagSelfClosing=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];var tagNonClosing=["!doctype","?xml"];var tagAttributes=[["id","class","style","role","itemscope","itemtype","itemprop","title"],"a",["id","class","style","role","itemscope","itemtype","itemprop","href","target","title","rel","name","type","data-smart","onclick","ondblclick","ontouchstart","ontouchend"],"img",["id","class","style","role","itemscope","itemtype","itemprop","src","data-src","align","rel","alt","title","border","usemap","onclick","ondblclick","ontouchstart","ontouchend","onmouseover","onmouseout"],"picture"["id","class","style","role","itemscope","itemtype","itemprop","width","height"],"video",["id","class","style","role","itemscope","itemtype","itemprop","src","controls","autoplay","loop","preload","poster","muted","width","height"],"audio",["id","class","style","role","itemscope","itemtype","itemprop","src","controls","autoplay","loop","preload","muted"],"source",["id","class","style","role","itemscope","itemtype","itemprop","src","srcset","data-src","type","media"],"track",["id","role","itemscope","itemtype","itemprop","src","srclang","kind","label","default"],"canvas",["id","class","style","role","itemscope","itemtype","itemprop","width","height","onclick","ondblclick","ontouchstart","ontouchend","onmouseover","onmouseout"],"table",["id","class","style","role","itemscope","itemtype","itemprop","align","title","width","height","cellpadding","cellspacing","border","bgcolor","onclick","ontouchstart","ontouchend"],"tr",["id","class","style","role","itemscope","itemtype","itemprop","align","title","valign","bgcolor","onclick","ondblclick","ontouchstart","ontouchend","onmouseover","onmouseout"],"th",["id","class","style","role","itemscope","itemtype","itemprop","align","title","valign","width","height","colspan","rowspan","bgcolor","onclick","ondblclick","ontouchstart","ontouchend","onmouseover","onmouseout"],"td",["id","class","style","role","itemscope","itemtype","itemprop","align","title","valign","width","height","colspan","rowspan","bgcolor","onclick","ondblclick","ontouchstart","ontouchend","onmouseover","onmouseout"],"p",["id","class","style","role","itemscope","itemtype","itemprop","align","title","onclick","ondblclick","ontouchstart","ontouchend","onmouseover","onmouseout"],"div",["id","class","style","role","itemscope","itemtype","itemprop","align","title","onclick","ondblclick","ontouchstart","ontouchend","onmouseover","onmouseout"],"span",["id","class","style","role","itemscope","itemtype","itemprop","title","onclick","ondblclick","ontouchstart","ontouchend","onmouseover","onmouseout"],"pre",["id","class","style","role","itemscope","itemtype","itemprop","onclick","ondblclick","ontouchstart","ontouchend","onmouseover","onmouseout"],"code",["id","class","style","role","itemscope","itemtype","itemprop","data-syntax"],"form",["id","class","style","role","itemscope","itemtype","itemprop","name","title","action","target","method","enctype","autocomplete","rel","novalidate","onsubmit","onreset"],"button",["id","class","style","role","itemscope","itemtype","itemprop","name","title","type","value","disabled","formaction","formtarget","onclick","ondblclick","ontouchstart","ontouchend","onmouseover","onmouseout","onsubmit"],"input",["id","class","style","role","itemscope","itemtype","itemprop","name","title","align","type","src","value","width","height","size","maxlength","checked","multiple","min","max","step","disabled","readonly","required","autocomplete","placeholder","list","formaction","formtarget","alt","onclick","ondblclick","ontouchstart","ontouchend","onmouseover","onmouseout","onchange","onblur","oninput","onreset","onselect","onsubmit"],"keygen",["id","class","style","role","itemscope","itemtype","itemprop","name","title","challenge","keytype","disabled","form"],"textarea",["id","class","style","role","itemscope","itemtype","itemprop","name","title","maxlength","rows","cols","wrap","disabled","readonly","required","placeholder","onclick","ondblclick","ontouchstart","ontouchend","onmouseover","onmouseout","onchange","onblur","oninput","onreset","onselect","onsubmit"],"select",["id","class","style","role","itemscope","itemtype","itemprop","name","title","size","multiple","disabled","required","onclick","ondblclick","ontouchstart","ontouchend","onmouseover","onmouseout","onchange","onblur","onreset","onselect","onsubmit"],"datalist",["id","class","style","role","itemscope","itemtype","itemprop","title","onclick","ondblclick","ontouchstart","ontouchend","onmouseover","onmouseout"],"option",["id","class","style","role","itemscope","itemtype","itemprop","label","selected","value","disabled","onclick","ondblclick","ontouchstart","ontouchend","onmouseover","onmouseout"],"optgroup",["id","class","style","role","itemscope","itemtype","itemprop","label","disabled","onmouseover","onmouseout"],"label",["id","class","style","role","itemscope","itemtype","itemprop","for"],"fieldset",["id","class","style","role","itemscope","itemtype","itemprop","name","disabled"],"hr",["id","class","style","role","itemscope","itemtype","itemprop","noshade","align","size","width"],"ul",["id","class","style","role","itemscope","itemtype","itemprop","type","onclick","ondblclick","ontouchstart","ontouchend","onmouseover","onmouseout"],"ol",["id","class","style","role","itemscope","itemtype","itemprop","type","reversed","start","onclick","ondblclick","ontouchstart","ontouchend","onmouseover","onmouseout"],"li",["id","class","style","role","itemscope","itemtype","itemprop","type","value","onclick","ondblclick","ontouchstart","ontouchend","onmouseover","onmouseout"],"legend",["id","class","style","role","itemscope","itemtype","itemprop","align","onclick","ondblclick","ontouchstart","ontouchend","onmouseover","onmouseout"],"time",["id","class","style","role","itemscope","itemtype","itemprop","datetime","onclick","ondblclick","ontouchstart","ontouchend","onmouseover","onmouseout"],"progress",["id","class","style","role","itemscope","itemtype","itemprop","value","max","onclick","ondblclick","ontouchstart","ontouchend","onmouseover","onmouseout"],"menuitem",["id","class","style","role","itemscope","itemtype","itemprop","type","label","icon","onclick","ondblclick","ontouchstart","ontouchend","onmouseover","onmouseout"],"meter",["id","class","style","role","itemscope","itemtype","itemprop","min","max","optimum","high","low","form","onclick","ondblclick","ontouchstart","ontouchend","onmouseover","onmouseout"],"font",["size","color"],"center",[],"bdi",[],"bdo",["dir"],"blockquote",["id","class","style","role","itemscope","itemtype","itemprop","cite"],"q",["id","class","style","role","itemscope","itemtype","itemprop","cite"],"del",["id","class","style","role","itemscope","itemtype","itemprop","class","datetime"],"ins",["id","class","style","role","itemscope","itemtype","itemprop","class","datetime"],"map",["id","class","style","role","itemscope","itemtype","itemprop","name"],"area",["id","class","style","role","itemscope","itemtype","itemprop","type","target","shape","coords","alt","rel","href","hreflang","nohref","media","download","onclick","ondblclick","ontouchstart","ontouchend","onmouseover","onmouseout"],"iframe",["id","class","style","role","itemscope","itemtype","itemprop","align","name","src","srcdoc","width","height","scrolling","sandbox","seamless","referrerpolicy","allow","loading","allowfullscreen","onresize","onscroll","onbeforeunload","onunload","onload","onhashchange","onabort","onerror"],"style",["id","type"],"link",["id","href","rel","type","media","sizes","onload"],"script",["id","type","async","defer","crossorigin"],"noscript",[],"body",["style","role","itemscope","itemtype","itemprop","background","bgcolor","onload"],"meta",["itemprop","content","charset","http-equiv","name","scheme"],"head",[],"title",["itemprop"],"html",["lang","itemscope","itemtype"],"!doctype",[],"embed",["src","type","width","height"],"object",["align","type","classid","data","width","height"],"param",["name","value"],"?xml",[]];var tagAttributesRequired=[[],"img",["alt"]];var whitespace=["\xa0"," ","\t","\n","\r","\f"];var optionsFixed=false;var fixTagOptions=function(options){if(optionsFixed){return}if(options.forceResponsiveImg!==true){for(var i=0;i<tagAttributes.length;i++){if(tagAttributes[i]==="img"){tagAttributes[i+1].push("width");tagAttributes[i+1].push("height");break}}}if(!options.format){tagStartAddNewLineBefore=[];tagStartAddNewLineAfter=[];tagEndAddNewLineBefore=[];tagEndAddNewLineAfter=[]}optionsFixed=true}})(jQuery);
// #END
