// JS-Script (UM): jquery.event.drop.js @ 2022-09-20 09:51:12 +0000
(function(p){p.fn.drop=function(t,e,a){var i=typeof t=="string"?t:"",n=p.isFunction(t)?t:p.isFunction(e)?e:null;if(i.indexOf("drop")!==0)i="drop"+i;a=(t==n?e:a)||{};return n?this.on(i,a,n):this.trigger(i)};p.drop=function(t){t=t||{};m.multi=t.multi===true?Infinity:t.multi===false?1:!isNaN(t.multi)?t.multi:m.multi;m.delay=t.delay||m.delay;m.tolerance=p.isFunction(t.tolerance)?t.tolerance:t.tolerance===null?null:m.tolerance;m.mode=t.mode||m.mode||"intersect"};var t=p.event,h=t.special,m=p.event.special.drop={multi:1,delay:20,mode:"overlap",targets:[],datakey:"dropdata",noBubble:true,add:function(t){var e=p.data(this,m.datakey);e.related+=1},remove:function(){p.data(this,m.datakey).related-=1},setup:function(){if(p.data(this,m.datakey))return;var t={related:0,active:[],anyactive:0,winner:0,location:{}};p.data(this,m.datakey,t);m.targets.push(this)},teardown:function(){var t=p.data(this,m.datakey)||{};if(t.related)return;p.removeData(this,m.datakey);var e=this;m.targets=p.grep(m.targets,function(t){return t!==e})},handler:function(t,e){var a,i;if(!e)return;switch(t.type){case"mousedown":case"touchstart":i=p(m.targets);if(typeof e.drop=="string")i=i.filter(e.drop);i.each(function(){var t=p.data(this,m.datakey);t.active=[];t.anyactive=0;t.winner=0});e.droppable=i;h.drag.hijack(t,"dropinit",e);break;case"mousemove":case"touchmove":m.event=t;if(!m.timer)m.tolerate(e);break;case"mouseup":case"touchend":m.timer=clearTimeout(m.timer);if(e.propagates){h.drag.hijack(t,"drop",e);h.drag.hijack(t,"dropend",e)}break}},locate:function(t,e){var a=p.data(t,m.datakey),i=p(t),n=i.offset()||{},r=i.outerHeight(),o=i.outerWidth(),d={elem:t,width:o,height:r,top:n.top,left:n.left,right:n.left+o,bottom:n.top+r};if(a){a.location=d;a.index=e;a.elem=t}return d},contains:function(t,e){return(e[0]||e.left)>=t.left&&(e[0]||e.right)<=t.right&&(e[1]||e.top)>=t.top&&(e[1]||e.bottom)<=t.bottom},modes:{intersect:function(t,e,a){return this.contains(a,[t.pageX,t.pageY])?1e9:this.modes.overlap.apply(this,arguments)},overlap:function(t,e,a){return Math.max(0,Math.min(a.bottom,e.bottom)-Math.max(a.top,e.top))*Math.max(0,Math.min(a.right,e.right)-Math.max(a.left,e.left))},fit:function(t,e,a){return this.contains(a,e)?1:0},middle:function(t,e,a){return this.contains(a,[e.left+e.width*.5,e.top+e.height*.5])?1:0}},sort:function(t,e){return e.winner-t.winner||t.index-e.index},tolerate:function(t){var e,a,i,n,r,o,d,l=0,c,s=t.interactions.length,u=[m.event.pageX,m.event.pageY],f=m.tolerance||m.modes[m.mode];do{if(c=t.interactions[l]){if(!c)return;c.drop=[];r=[];o=c.droppable.length;if(f)i=m.locate(c.proxy);e=0;do{if(d=c.droppable[e]){n=p.data(d,m.datakey);a=n.location;if(!a)continue;n.winner=f?f.call(m,m.event,i,a):m.contains(a,u)?1:0;r.push(n)}}while(++e<o);r.sort(m.sort);e=0;do{if(n=r[e]){if(n.winner&&c.drop.length<m.multi){if(!n.active[l]&&!n.anyactive){if(h.drag.hijack(m.event,"dropstart",t,l,n.elem)[0]!==false){n.active[l]=1;n.anyactive+=1}else n.winner=0}if(n.winner)c.drop.push(n.elem)}else if(n.active[l]&&n.anyactive==1){h.drag.hijack(m.event,"dropend",t,l,n.elem);n.active[l]=0;n.anyactive-=1}}}while(++e<o)}}while(++l<s);if(m.last&&u[0]==m.last.pageX&&u[1]==m.last.pageY)delete m.timer;else m.timer=setTimeout(function(){m.tolerate(t)},m.delay);m.last=m.event}};h.dropinit=h.dropstart=h.dropend=m})(jQuery);
// #END
