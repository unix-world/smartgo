// JS-Script (UM): jquery.sparkline.js @ 2022-09-20 09:51:13 +0000
(function(_,N,E){(function(t){if(typeof define==="function"&&define.amd){define(["jquery"],t)}else if(jQuery&&!jQuery.fn.sparkline){t(jQuery)}})(function(q){"use strict";var a={},t,i,m,F,C,B,O,V,g,b,e,s,n,p,X,u,r,h,j,z,o,l,f,c,w,d,v,x,y,R,S,k,M=0;t=function(){return{common:{type:"line",lineColor:"#00f",fillColor:"#cdf",defaultPixelsPerValue:3,width:"auto",height:"auto",composite:false,tagValuesAttribute:"values",tagOptionsPrefix:"spark",enableTagOptions:false,enableHighlight:true,highlightLighten:1.4,tooltipSkipNull:true,tooltipPrefix:"",tooltipSuffix:"",disableHiddenCheck:false,numberFormatter:false,numberDigitGroupCount:3,numberDigitGroupSep:",",numberDecimalMark:".",disableTooltips:false,disableInteraction:false},line:{spotColor:"#f80",highlightSpotColor:"#5f5",highlightLineColor:"#f22",spotRadius:1.5,minSpotColor:"#f80",maxSpotColor:"#f80",lineWidth:1,normalRangeMin:E,normalRangeMax:E,normalRangeColor:"#ccc",drawNormalOnTop:false,chartRangeMin:E,chartRangeMax:E,chartRangeMinX:E,chartRangeMaxX:E,tooltipFormat:new m('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{y}}{{suffix}}')},bar:{barColor:"#3366cc",negBarColor:"#f44",stackedBarColor:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],zeroColor:E,nullColor:E,zeroAxis:true,barWidth:4,barSpacing:1,chartRangeMax:E,chartRangeMin:E,chartRangeClip:false,colorMap:E,tooltipFormat:new m('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{value}}{{suffix}}')},tristate:{barWidth:4,barSpacing:1,posBarColor:"#6f6",negBarColor:"#f44",zeroBarColor:"#999",colorMap:{},tooltipFormat:new m('<span style="color: {{color}}">&#9679;</span> {{value:map}}'),tooltipValueLookups:{map:{"-1":"Loss",0:"Draw",1:"Win"}}},discrete:{lineHeight:"auto",thresholdColor:E,thresholdValue:0,chartRangeMax:E,chartRangeMin:E,chartRangeClip:false,tooltipFormat:new m("{{prefix}}{{value}}{{suffix}}")},bullet:{targetColor:"#f33",targetWidth:3,performanceColor:"#33f",rangeColors:["#d3dafe","#a8b6ff","#7f94ff"],base:E,tooltipFormat:new m("{{fieldkey:fields}} - {{value}}"),tooltipValueLookups:{fields:{r:"Range",p:"Performance",t:"Target"}}},pie:{offset:0,sliceColors:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],borderWidth:0,borderColor:"#000",tooltipFormat:new m('<span style="color: {{color}}">&#9679;</span> {{value}} ({{percent.1}}%)')},box:{raw:false,boxLineColor:"#000",boxFillColor:"#cdf",whiskerColor:"#000",outlierLineColor:"#333",outlierFillColor:"#fff",medianColor:"#f00",showOutliers:true,outlierIQR:1.5,spotRadius:1.5,target:E,targetColor:"#4a2",chartRangeMax:E,chartRangeMin:E,tooltipFormat:new m("{{field:fields}}: {{value}}"),tooltipFormatFieldlistKey:"field",tooltipValueLookups:{fields:{lq:"Lower Quartile",med:"Median",uq:"Upper Quartile",lo:"Left Outlier",ro:"Right Outlier",lw:"Left Whisker",rw:"Right Whisker"}}}}};d=".jqstooltip { "+"position: absolute;"+"left: 0px;"+"top: 0px;"+"visibility: hidden;"+"background: rgb(0, 0, 0) transparent;"+"background-color: rgba(0,0,0,0.6);"+"filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);"+'-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)";'+"color: white;"+"font: 10px arial, san serif;"+"text-align: left;"+"white-space: nowrap;"+"padding: 5px;"+"border: 1px solid white;"+"z-index: 10000;"+"}"+".jqsfield { "+"color: white;"+"font: 10px arial, san serif;"+"text-align: left;"+"}";i=function(){var t,i;t=function(){this.init.apply(this,arguments)};if(arguments.length>1){if(arguments[0]){t.prototype=q.extend(new arguments[0],arguments[arguments.length-1]);t._super=arguments[0].prototype}else{t.prototype=arguments[arguments.length-1]}if(arguments.length>2){i=Array.prototype.slice.call(arguments,1,-1);i.unshift(t.prototype);q.extend.apply(q,i)}}else{t.prototype=arguments[0]}t.prototype.cls=t;return t};q.SPFormatClass=m=i({fre:/\{\{([\w.]+?)(:(.+?))?\}\}/g,precre:/(\w+)\.(\d+)/,init:function(t,i){this.format=t;this.fclass=i},render:function(t,i,e){var s=this,r=t,n,a,h,o,l;return this.format.replace(this.fre,function(){var t;a=arguments[1];h=arguments[3];n=s.precre.exec(a);if(n){l=n[2];a=n[1]}else{l=false}o=r[a];if(o===E){return""}if(h&&i&&i[h]){t=i[h];if(t.get){return i[h].get(o)||o}else{return i[h][o]||o}}if(g(o)){if(e.get("numberFormatter")){o=e.get("numberFormatter")(o)}else{o=p(o,l,e.get("numberDigitGroupCount"),e.get("numberDigitGroupSep"),e.get("numberDecimalMark"))}}return o})}});q.spformat=function(t,i){return new m(t,i)};F=function(t,i,e){if(t<i){return i}if(t>e){return e}return t};C=function(t,i){var e;if(i===2){e=N.floor(t.length/2);return t.length%2?t[e]:(t[e-1]+t[e])/2}else{if(t.length%2){e=(t.length*i+i)/4;return e%1?(t[N.floor(e)]+t[N.floor(e)-1])/2:t[e-1]}else{e=(t.length*i+2)/4;return e%1?(t[N.floor(e)]+t[N.floor(e)-1])/2:t[e-1]}}};B=function(t){var i;switch(t){case"undefined":t=E;break;case"null":t=null;break;case"true":t=true;break;case"false":t=false;break;default:i=parseFloat(t);if(t==i){t=i}}return t};O=function(t){var i,e=[];for(i=t.length;i--;){e[i]=B(t[i])}return e};V=function(t,i){var e,s,r=[];for(e=0,s=t.length;e<s;e++){if(t[e]!==i){r.push(t[e])}}return r};g=function(t){return!isNaN(parseFloat(t))&&isFinite(t)};p=function(t,i,e,s,r){var n,a;t=(i===false?parseFloat(t).toString():t.toFixed(i)).split("");n=(n=q.inArray(".",t))<0?t.length:n;if(n<t.length){t[n]=r}for(a=n-e;a>0;a-=e){t.splice(a,0,s)}return t.join("")};b=function(t,i,e){var s;for(s=i.length;s--;){if(e&&i[s]===null)continue;if(i[s]!==t){return false}}return true};e=function(t){var i=0,e;for(e=t.length;e--;){i+=typeof t[e]==="number"?t[e]:0}return i};n=function(t){return Array.isArray(t)?t:[t]};s=function(t){var i;if(_.createStyleSheet){_.createStyleSheet().cssText=t}else{i=_.createElement("style");i.type="text/css";_.getElementsByTagName("head")[0].appendChild(i);i[typeof _.body.style.WebkitAppearance=="string"?"innerText":"innerHTML"]=t}};q.fn.simpledraw=function(t,i,e,s){var r,n;if(e&&(r=this.data("_jqs_vcanvas"))){return r}if(q.fn.sparkline.canvas===false){return false}else if(q.fn.sparkline.canvas===E){var a=_.createElement("canvas");if(!!(a.getContext&&a.getContext("2d"))){q.fn.sparkline.canvas=function(t,i,e,s){return new R(t,i,e,s)}}else if(_.namespaces&&!_.namespaces.v){_.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML");q.fn.sparkline.canvas=function(t,i,e,s){return new S(t,i,e)}}else{q.fn.sparkline.canvas=false;return false}}if(t===E){t=q(this).innerWidth()}if(i===E){i=q(this).innerHeight()}r=q.fn.sparkline.canvas(t,i,this,s);n=q(this).data("_jqs_mhandler");if(n){n.registerCanvas(r)}return r};q.fn.cleardraw=function(){var t=this.data("_jqs_vcanvas");if(t){t.reset()}};q.RangeMapClass=X=i({init:function(t){var i,e,s=[];for(i in t){if(t.hasOwnProperty(i)&&typeof i==="string"&&i.indexOf(":")>-1){e=i.split(":");e[0]=e[0].length===0?-Infinity:parseFloat(e[0]);e[1]=e[1].length===0?Infinity:parseFloat(e[1]);e[2]=t[i];s.push(e)}}this.map=t;this.rangelist=s||false},get:function(t){var i=this.rangelist,e,s,r;if((r=this.map[t])!==E){return r}if(i){for(e=i.length;e--;){s=i[e];if(s[0]<=t&&s[1]>=t){return s[2]}}}return E}});q.range_map=function(t){return new X(t)};u=i({init:function(t,i){var e=q(t);this.$el=e;this.options=i;this.currentPageX=0;this.currentPageY=0;this.el=t;this.splist=[];this.tooltip=null;this.over=false;this.displayTooltips=!i.get("disableTooltips");this.highlightEnabled=!i.get("disableHighlight")},registerSparkline:function(t){this.splist.push(t);if(this.over){this.updateDisplay()}},registerCanvas:function(t){var i=q(t.canvas);this.canvas=t;this.$canvas=i;i.mouseenter(q.proxy(this.mouseenter,this));i.mouseleave(q.proxy(this.mouseleave,this));i.click(q.proxy(this.mouseclick,this))},reset:function(t){this.splist=[];if(this.tooltip&&t){this.tooltip.remove();this.tooltip=E}},mouseclick:function(t){var i=q.Event("sparklineClick");i.originalEvent=t;i.sparklines=this.splist;this.$el.trigger(i)},mouseenter:function(t){q(_.body).unbind("mousemove.jqs");q(_.body).bind("mousemove.jqs",q.proxy(this.mousemove,this));this.over=true;this.currentPageX=t.pageX;this.currentPageY=t.pageY;this.currentEl=t.target;if(!this.tooltip&&this.displayTooltips){this.tooltip=new r(this.options);this.tooltip.updatePosition(t.pageX,t.pageY)}this.updateDisplay()},mouseleave:function(){q(_.body).unbind("mousemove.jqs");var t=this.splist,i=t.length,e=false,s,r;this.over=false;this.currentEl=null;if(this.tooltip){this.tooltip.remove();this.tooltip=null}for(r=0;r<i;r++){s=t[r];if(s.clearRegionHighlight()){e=true}}if(e){this.canvas.render()}},mousemove:function(t){this.currentPageX=t.pageX;this.currentPageY=t.pageY;this.currentEl=t.target;if(this.tooltip){this.tooltip.updatePosition(t.pageX,t.pageY)}this.updateDisplay()},updateDisplay:function(){var t=this.splist,i=t.length,e=false,s=this.$canvas.offset(),r=this.currentPageX-s.left,n=this.currentPageY-s.top,a,h,o,l,g;if(!this.over){return}for(o=0;o<i;o++){h=t[o];l=h.setRegionHighlight(this.currentEl,r,n);if(l){e=true}}if(e){g=q.Event("sparklineRegionChange");g.sparklines=this.splist;this.$el.trigger(g);if(this.tooltip){a="";for(o=0;o<i;o++){h=t[o];a+=h.getCurrentRegionTooltip()}this.tooltip.setContent(a)}if(!this.disableHighlight){this.canvas.render()}}if(l===null){this.mouseleave()}}});r=i({sizeStyle:"position: static !important;"+"display: block !important;"+"visibility: hidden !important;"+"float: left !important;",init:function(t){var i=t.get("tooltipClassname","jqstooltip"),e=this.sizeStyle,s;this.container=t.get("tooltipContainer")||_.body;this.tooltipOffsetX=t.get("tooltipOffsetX",10);this.tooltipOffsetY=t.get("tooltipOffsetY",12);q("#jqssizetip").remove();q("#jqstooltip").remove();this.sizetip=q("<div></div>",{id:"jqssizetip",style:e,class:i});this.tooltip=q("<div></div>",{id:"jqstooltip",class:i}).appendTo(this.container);s=this.tooltip.offset();this.offsetLeft=s.left;this.offsetTop=s.top;this.hidden=true;q(window).unbind("resize.jqs scroll.jqs");q(window).bind("resize.jqs scroll.jqs",q.proxy(this.updateWindowDims,this));this.updateWindowDims()},updateWindowDims:function(){this.scrollTop=q(window).scrollTop();this.scrollLeft=q(window).scrollLeft();this.scrollRight=this.scrollLeft+q(window).width();this.updatePosition()},getSize:function(t){this.sizetip.html(t).appendTo(this.container);this.width=this.sizetip.width()+1;this.height=this.sizetip.height();this.sizetip.remove()},setContent:function(t){if(!t){this.tooltip.css("visibility","hidden");this.hidden=true;return}this.getSize(t);this.tooltip.html(t).css({width:this.width,height:this.height,visibility:"visible"});if(this.hidden){this.hidden=false;this.updatePosition()}},updatePosition:function(t,i){if(t===E){if(this.mousex===E){return}t=this.mousex-this.offsetLeft;i=this.mousey-this.offsetTop}else{this.mousex=t=t-this.offsetLeft;this.mousey=i=i-this.offsetTop}if(!this.height||!this.width||this.hidden){return}i-=this.height+this.tooltipOffsetY;t+=this.tooltipOffsetX;if(i<this.scrollTop){i=this.scrollTop}if(t<this.scrollLeft){t=this.scrollLeft}else if(t+this.width>this.scrollRight){t=this.scrollRight-this.width}this.tooltip.css({left:t,top:i})},remove:function(){this.tooltip.remove();this.sizetip.remove();this.sizetip=this.tooltip=E;q(window).unbind("resize.jqs scroll.jqs")}});v=function(){s(d)};q(v);k=[];q.fn.sparkline=function(l,e){return this.each(function(){var h=new q.fn.sparkline.options(this,e),o=q(this),t,i;t=function(){var t,i,e,s,r,n,a;if(l==="html"||l===E){a=this.getAttribute(h.get("tagValuesAttribute"));if(a===E||a===null){a=o.html()}t=a.replace(/(^\s*<!--)|(-->\s*$)|\s+/g,"").split(",")}else{t=l}i=h.get("width")==="auto"?t.length*h.get("defaultPixelsPerValue"):h.get("width");if(h.get("height")==="auto"){if(!h.get("composite")||!q.data(this,"_jqs_vcanvas")){s=_.createElement("span");s.innerHTML="a";o.html(s);e=q(s).innerHeight()||q(s).height();q(s).remove();s=null}}else{e=h.get("height")}if(!h.get("disableInteraction")){r=q.data(this,"_jqs_mhandler");if(!r){r=new u(this,h);q.data(this,"_jqs_mhandler",r)}else if(!h.get("composite")){r.reset()}}else{r=false}if(h.get("composite")&&!q.data(this,"_jqs_vcanvas")){if(!q.data(this,"_jqs_errnotify")){alert("Attempted to attach a composite sparkline to an element with no existing sparkline");q.data(this,"_jqs_errnotify",true)}return}n=new q.fn.sparkline[h.get("type")](this,t,h,i,e);n.render();if(r){r.registerSparkline(n)}};if(q(this).html()&&!h.get("disableHiddenCheck")&&q(this).is(":hidden")||!q(this).parents("body").length){if(!h.get("composite")&&q.data(this,"_jqs_pending")){for(i=k.length;i;i--){if(k[i-1][0]==this){k.splice(i-1,1)}}}k.push([this,t]);q.data(this,"_jqs_pending",true)}else{t.call(this)}})};q.fn.sparkline.defaults=t();q.sparkline_display_visible=function(){var t,i,e;var s=[];for(i=0,e=k.length;i<e;i++){t=k[i][0];if(q(t).is(":visible")&&!q(t).parents().is(":hidden")){k[i][1].call(t);q.data(k[i][0],"_jqs_pending",false);s.push(i)}else if(!q(t).closest("html").length&&!q.data(t,"_jqs_pending")){q.data(k[i][0],"_jqs_pending",false);s.push(i)}}for(i=s.length;i;i--){k.splice(s[i-1],1)}};q.fn.sparkline.options=i({init:function(t,i){var e,s,r,n;this.userOptions=i=i||{};this.tag=t;this.tagValCache={};s=q.fn.sparkline.defaults;r=s.common;this.tagOptionsPrefix=i.enableTagOptions&&(i.tagOptionsPrefix||r.tagOptionsPrefix);n=this.getTagSetting("type");if(n===a){e=s[i.type||r.type]}else{e=s[n]}this.mergedOptions=q.extend({},r,e,i)},getTagSetting:function(t){var i=this.tagOptionsPrefix,e,s,r,n;if(i===false||i===E){return a}if(this.tagValCache.hasOwnProperty(t)){e=this.tagValCache.key}else{e=this.tag.getAttribute(i+t);if(e===E||e===null){e=a}else if(e.substr(0,1)==="["){e=e.substr(1,e.length-2).split(",");for(s=e.length;s--;){e[s]=B(e[s].replace(/(^\s*)|(\s*$)/g,""))}}else if(e.substr(0,1)==="{"){r=e.substr(1,e.length-2).split(",");e={};for(s=r.length;s--;){n=r[s].split(":",2);e[n[0].replace(/(^\s*)|(\s*$)/g,"")]=B(n[1].replace(/(^\s*)|(\s*$)/g,""))}}else{e=B(e)}this.tagValCache.key=e}return e},get:function(t,i){var e=this.getTagSetting(t),s;if(e!==a){return e}return(s=this.mergedOptions[t])===E?i:s}});q.fn.sparkline._base=i({disabled:false,init:function(t,i,e,s,r){this.el=t;this.$el=q(t);this.values=i;this.options=e;this.width=s;this.height=r;this.currentRegion=E},initTarget:function(){var t=!this.options.get("disableInteraction");if(!(this.target=this.$el.simpledraw(this.width,this.height,this.options.get("composite"),t))){this.disabled=true}else{this.canvasWidth=this.target.pixelWidth;this.canvasHeight=this.target.pixelHeight}},render:function(){if(this.disabled){this.el.innerHTML="";return false}return true},getRegion:function(t,i){},setRegionHighlight:function(t,i,e){var s=this.currentRegion,r=!this.options.get("disableHighlight"),n;if(i>this.canvasWidth||e>this.canvasHeight||i<0||e<0){return null}n=this.getRegion(t,i,e);if(s!==n){if(s!==E&&r){this.removeHighlight()}this.currentRegion=n;if(n!==E&&r){this.renderHighlight()}return true}return false},clearRegionHighlight:function(){if(this.currentRegion!==E){this.removeHighlight();this.currentRegion=E;return true}return false},renderHighlight:function(){this.changeHighlight(true)},removeHighlight:function(){this.changeHighlight(false)},changeHighlight:function(t){},getCurrentRegionTooltip:function(){var t=this.options,i="",e=[],s,r,n,a,h,o,l,g,p,u,f,c,d,v;if(this.currentRegion===E){return""}s=this.getCurrentRegionFields();f=t.get("tooltipFormatter");if(f){return f(this,t,s)}if(t.get("tooltipChartTitle")){i+='<div class="jqs jqstitle">'+t.get("tooltipChartTitle")+"</div>\n"}r=this.options.get("tooltipFormat");if(!r){return""}if(!Array.isArray(r)){r=[r]}if(!Array.isArray(s)){s=[s]}l=this.options.get("tooltipFormatFieldlist");g=this.options.get("tooltipFormatFieldlistKey");if(l&&g){p=[];for(o=s.length;o--;){u=s[o][g];if((v=q.inArray(u,l))!=-1){p[v]=s[o]}}s=p}n=r.length;d=s.length;for(o=0;o<n;o++){c=r[o];if(typeof c==="string"){c=new m(c)}a=c.fclass||"jqsfield";for(v=0;v<d;v++){if(!s[v].isNull||!t.get("tooltipSkipNull")){q.extend(s[v],{prefix:t.get("tooltipPrefix"),suffix:t.get("tooltipSuffix")});h=c.render(s[v],t.get("tooltipValueLookups"),t);e.push('<div class="'+a+'">'+h+"</div>")}}}if(e.length){return i+e.join("\n")}return""},getCurrentRegionFields:function(){},calcHighlightColor:function(t,i){var e=i.get("highlightColor"),s=i.get("highlightLighten"),r,n,a,h;if(e){return e}if(s){r=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(t)||/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(t);if(r){a=[];n=t.length===4?16:1;for(h=0;h<3;h++){a[h]=F(N.round(parseInt(r[h+1],16)*n*s),0,255)}return"rgb("+a.join(",")+")"}}return t}});h={changeHighlight:function(t){var i=this.currentRegion,e=this.target,s=this.regionShapes[i],r;if(s){r=this.renderRegion(i,t);if(Array.isArray(r)||Array.isArray(s)){e.replaceWithShapes(s,r);this.regionShapes[i]=q.map(r,function(t){return t.id})}else{e.replaceWithShape(s,r);this.regionShapes[i]=r.id}}},render:function(){var t=this.values,i=this.target,e=this.regionShapes,s,r,n,a;if(!this.cls._super.render.call(this)){return}for(n=t.length;n--;){s=this.renderRegion(n);if(s){if(Array.isArray(s)){r=[];for(a=s.length;a--;){s[a].append();r.push(s[a].id)}e[n]=r}else{s.append();e[n]=s.id}}else{e[n]=null}}i.render()}};q.fn.sparkline.line=j=i(q.fn.sparkline._base,{type:"line",init:function(t,i,e,s,r){j._super.init.call(this,t,i,e,s,r);this.vertices=[];this.regionMap=[];this.xvalues=[];this.yvalues=[];this.yminmax=[];this.hightlightSpotId=null;this.lastShapeId=null;this.initTarget()},getRegion:function(t,i,e){var s,r=this.regionMap;for(s=r.length;s--;){if(r[s]!==null&&i>=r[s][0]&&i<=r[s][1]){return r[s][2]}}return E},getCurrentRegionFields:function(){var t=this.currentRegion;return{isNull:this.yvalues[t]===null,x:this.xvalues[t],y:this.yvalues[t],color:this.options.get("lineColor"),fillColor:this.options.get("fillColor"),offset:t}},renderHighlight:function(){var t=this.currentRegion,i=this.target,e=this.vertices[t],s=this.options,r=s.get("spotRadius"),n=s.get("highlightSpotColor"),a=s.get("highlightLineColor"),h,o;if(!e){return}if(r&&n){h=i.drawCircle(e[0],e[1],r,E,n);this.highlightSpotId=h.id;i.insertAfterShape(this.lastShapeId,h)}if(a){o=i.drawLine(e[0],this.canvasTop,e[0],this.canvasTop+this.canvasHeight,a);this.highlightLineId=o.id;i.insertAfterShape(this.lastShapeId,o)}},removeHighlight:function(){var t=this.target;if(this.highlightSpotId){t.removeShapeId(this.highlightSpotId);this.highlightSpotId=null}if(this.highlightLineId){t.removeShapeId(this.highlightLineId);this.highlightLineId=null}},scanValues:function(){var t=this.values,i=t.length,e=this.xvalues,s=this.yvalues,r=this.yminmax,n,a,h,o,l;for(n=0;n<i;n++){a=t[n];h=typeof t[n]==="string";o=typeof t[n]==="object"&&t[n]instanceof Array;l=h&&t[n].split(":");if(h&&l.length===2){e.push(Number(l[0]));s.push(Number(l[1]));r.push(Number(l[1]))}else if(o){e.push(a[0]);s.push(a[1]);r.push(a[1])}else{e.push(n);if(t[n]===null||t[n]==="null"){s.push(null)}else{s.push(Number(a));r.push(Number(a))}}}if(this.options.get("xvalues")){e=this.options.get("xvalues")}this.maxy=this.maxyorg=N.max.apply(N,r);this.miny=this.minyorg=N.min.apply(N,r);this.maxx=N.max.apply(N,e);this.minx=N.min.apply(N,e);this.xvalues=e;this.yvalues=s;this.yminmax=r},processRangeOptions:function(){var t=this.options,i=t.get("normalRangeMin"),e=t.get("normalRangeMax");if(i!==E){if(i<this.miny){this.miny=i}if(e>this.maxy){this.maxy=e}}if(t.get("chartRangeMin")!==E&&(t.get("chartRangeClip")||t.get("chartRangeMin")<this.miny)){this.miny=t.get("chartRangeMin")}if(t.get("chartRangeMax")!==E&&(t.get("chartRangeClip")||t.get("chartRangeMax")>this.maxy)){this.maxy=t.get("chartRangeMax")}if(t.get("chartRangeMinX")!==E&&(t.get("chartRangeClipX")||t.get("chartRangeMinX")<this.minx)){this.minx=t.get("chartRangeMinX")}if(t.get("chartRangeMaxX")!==E&&(t.get("chartRangeClipX")||t.get("chartRangeMaxX")>this.maxx)){this.maxx=t.get("chartRangeMaxX")}},drawNormalRange:function(t,i,e,s,r){var n=this.options.get("normalRangeMin"),a=this.options.get("normalRangeMax"),h=i+N.round(e-e*((a-this.miny)/r)),o=N.round(e*(a-n)/r);this.target.drawRect(t,h,s,o,E,this.options.get("normalRangeColor")).append()},render:function(){var t=this.options,i=this.target,e=this.canvasWidth,s=this.canvasHeight,r=this.vertices,n=t.get("spotRadius"),a=this.regionMap,h,o,l,g,p,u,f,c,d,v,m,x,y,C,w,b,R,S,k,M,_,H,W,I,T;if(!j._super.render.call(this)){return}this.scanValues();this.processRangeOptions();W=this.xvalues;I=this.yvalues;if(!this.yminmax.length||this.yvalues.length<2){return}g=p=0;h=this.maxx-this.minx===0?1:this.maxx-this.minx;o=this.maxy-this.miny===0?1:this.maxy-this.miny;l=this.yvalues.length-1;if(n&&(e<n*4||s<n*4)){n=0}if(n){_=t.get("highlightSpotColor")&&!t.get("disableInteraction");if(_||t.get("minSpotColor")||t.get("spotColor")&&I[l]===this.miny){s-=N.ceil(n)}if(_||t.get("maxSpotColor")||t.get("spotColor")&&I[l]===this.maxy){s-=N.ceil(n);g+=N.ceil(n)}if(_||(t.get("minSpotColor")||t.get("maxSpotColor"))&&(I[0]===this.miny||I[0]===this.maxy)){p+=N.ceil(n);e-=N.ceil(n)}if(_||t.get("spotColor")||(t.get("minSpotColor")||t.get("maxSpotColor")&&(I[l]===this.miny||I[l]===this.maxy))){e-=N.ceil(n)}}s--;if(t.get("normalRangeMin")!==E&&!t.get("drawNormalOnTop")){this.drawNormalRange(p,g,s,e,o)}f=[];c=[f];C=w=null;b=I.length;for(T=0;T<b;T++){d=W[T];m=W[T+1];v=I[T];x=p+N.round((d-this.minx)*(e/h));y=T<b-1?p+N.round((m-this.minx)*(e/h)):e;w=x+(y-x)/2;a[T]=[C||0,w,T];C=w;if(v===null){if(T){if(I[T-1]!==null){f=[];c.push(f)}r.push(null)}}else{if(v<this.miny){v=this.miny}if(v>this.maxy){v=this.maxy}if(!f.length){f.push([x,g+s])}u=[x,g+N.round(s-s*((v-this.miny)/o))];f.push(u);r.push(u)}}R=[];S=[];k=c.length;for(T=0;T<k;T++){f=c[T];if(f.length){if(t.get("fillColor")){f.push([f[f.length-1][0],g+s]);S.push(f.slice(0));f.pop()}if(f.length>2){f[0]=[f[0][0],f[1][1]]}R.push(f)}}k=S.length;for(T=0;T<k;T++){i.drawShape(S[T],t.get("fillColor"),t.get("fillColor")).append()}if(t.get("normalRangeMin")!==E&&t.get("drawNormalOnTop")){this.drawNormalRange(p,g,s,e,o)}k=R.length;for(T=0;T<k;T++){i.drawShape(R[T],t.get("lineColor"),E,t.get("lineWidth")).append()}if(n&&t.get("valueSpots")){M=t.get("valueSpots");if(M.get===E){M=new X(M)}for(T=0;T<b;T++){H=M.get(I[T]);if(H){i.drawCircle(p+N.round((W[T]-this.minx)*(e/h)),g+N.round(s-s*((I[T]-this.miny)/o)),n,E,H).append()}}}if(n&&t.get("spotColor")&&I[l]!==null){i.drawCircle(p+N.round((W[W.length-1]-this.minx)*(e/h)),g+N.round(s-s*((I[l]-this.miny)/o)),n,E,t.get("spotColor")).append()}if(this.maxy!==this.minyorg){if(n&&t.get("minSpotColor")){d=W[q.inArray(this.minyorg,I)];i.drawCircle(p+N.round((d-this.minx)*(e/h)),g+N.round(s-s*((this.minyorg-this.miny)/o)),n,E,t.get("minSpotColor")).append()}if(n&&t.get("maxSpotColor")){d=W[q.inArray(this.maxyorg,I)];i.drawCircle(p+N.round((d-this.minx)*(e/h)),g+N.round(s-s*((this.maxyorg-this.miny)/o)),n,E,t.get("maxSpotColor")).append()}}this.lastShapeId=i.getLastShapeId();this.canvasTop=g;i.render()}});q.fn.sparkline.bar=z=i(q.fn.sparkline._base,h,{type:"bar",init:function(t,i,e,s,r){var n=parseInt(e.get("barWidth"),10),a=parseInt(e.get("barSpacing"),10),h=e.get("chartRangeMin"),o=e.get("chartRangeMax"),l=e.get("chartRangeClip"),g=Infinity,p=-Infinity,u,f,c,d,v,m,x,y,C,w,b,R,S,k,M,_,H,W,I,T,q,j,P;z._super.init.call(this,t,i,e,s,r);for(m=0,x=i.length;m<x;m++){T=i[m];u=typeof T==="string"&&T.indexOf(":")>-1;if(u||Array.isArray(T)){M=true;if(u){T=i[m]=O(T.split(":"))}T=V(T,null);f=N.min.apply(N,T);c=N.max.apply(N,T);if(f<g){g=f}if(c>p){p=c}}}this.stacked=M;this.regionShapes={};this.barWidth=n;this.barSpacing=a;this.totalBarWidth=n+a;this.width=s=i.length*n+(i.length-1)*a;this.initTarget();if(l){S=h===E?-Infinity:h;k=o===E?Infinity:o}v=[];d=M?[]:v;var A=[];var L=[];for(m=0,x=i.length;m<x;m++){if(M){_=i[m];i[m]=I=[];A[m]=0;d[m]=L[m]=0;for(H=0,W=_.length;H<W;H++){T=I[H]=l?F(_[H],S,k):_[H];if(T!==null){if(T>0){A[m]+=T}if(g<0&&p>0){if(T<0){L[m]+=N.abs(T)}else{d[m]+=T}}else{d[m]+=N.abs(T-(T<0?p:g))}v.push(T)}}}else{T=l?F(i[m],S,k):i[m];T=i[m]=B(T);if(T!==null){v.push(T)}}}this.max=R=N.max.apply(N,v);this.min=b=N.min.apply(N,v);this.stackMax=p=M?N.max.apply(N,A):R;this.stackMin=g=M?N.min.apply(N,v):b;if(e.get("chartRangeMin")!==E&&(e.get("chartRangeClip")||e.get("chartRangeMin")<b)){b=e.get("chartRangeMin")}if(e.get("chartRangeMax")!==E&&(e.get("chartRangeClip")||e.get("chartRangeMax")>R)){R=e.get("chartRangeMax")}this.zeroAxis=C=e.get("zeroAxis",true);if(b<=0&&R>=0&&C){w=0}else if(C==false){w=b}else if(b>0){w=b}else{w=R}this.xaxisOffset=w;y=M?N.max.apply(N,d)+N.max.apply(N,L):R-b;this.canvasHeightEf=C&&b<0?this.canvasHeight-2:this.canvasHeight-1;if(b<w){j=M&&R>=0?p:R;q=(j-w)/y*this.canvasHeight;if(q!==N.ceil(q)){this.canvasHeightEf-=2;q=N.ceil(q)}}else{q=this.canvasHeight}this.yoffset=q;if(Array.isArray(e.get("colorMap"))){this.colorMapByIndex=e.get("colorMap");this.colorMapByValue=null}else{this.colorMapByIndex=null;this.colorMapByValue=e.get("colorMap");if(this.colorMapByValue&&this.colorMapByValue.get===E){this.colorMapByValue=new X(this.colorMapByValue)}}this.range=y},getRegion:function(t,i,e){var s=N.floor(i/this.totalBarWidth);return s<0||s>=this.values.length?E:s},getCurrentRegionFields:function(){var t=this.currentRegion,i=n(this.values[t]),e=[],s,r;for(r=i.length;r--;){s=i[r];e.push({isNull:s===null,value:s,color:this.calcColor(r,s,t),offset:t})}return e},calcColor:function(t,i,e){var s=this.colorMapByIndex,r=this.colorMapByValue,n=this.options,a,h;if(this.stacked){a=n.get("stackedBarColor")}else{a=i<0?n.get("negBarColor"):n.get("barColor")}if(i===0&&n.get("zeroColor")!==E){a=n.get("zeroColor")}if(r&&(h=r.get(i))){a=h}else if(s&&s.length>e){a=s[e]}return Array.isArray(a)?a[t%a.length]:a},renderRegion:function(t,i){var e=this.values[t],s=this.options,r=this.xaxisOffset,n=[],a=this.range,h=this.stacked,o=this.target,l=t*this.totalBarWidth,g=this.canvasHeightEf,p=this.yoffset,u,f,c,d,v,m,x,y,C,w;e=Array.isArray(e)?e:[e];x=e.length;y=e[0];d=b(null,e);w=b(r,e,true);if(d){if(s.get("nullColor")){c=i?s.get("nullColor"):this.calcHighlightColor(s.get("nullColor"),s);u=p>0?p-1:p;return o.drawRect(l,u,this.barWidth-1,0,c,c)}else{return E}}v=p;for(m=0;m<x;m++){y=e[m];if(h&&y===r){if(!w||C){continue}C=true}if(a>0){f=N.floor(g*(N.abs(y-r)/a))+1}else{f=1}if(y<r||y===r&&p===0){u=v;v+=f}else{u=p-f;p-=f}c=this.calcColor(m,y,t);if(i){c=this.calcHighlightColor(c,s)}n.push(o.drawRect(l,u,this.barWidth-1,f-1,c,c))}if(n.length===1){return n[0]}return n}});q.fn.sparkline.tristate=o=i(q.fn.sparkline._base,h,{type:"tristate",init:function(t,i,e,s,r){var n=parseInt(e.get("barWidth"),10),a=parseInt(e.get("barSpacing"),10);o._super.init.call(this,t,i,e,s,r);this.regionShapes={};this.barWidth=n;this.barSpacing=a;this.totalBarWidth=n+a;this.values=q.map(i,Number);this.width=s=i.length*n+(i.length-1)*a;if(Array.isArray(e.get("colorMap"))){this.colorMapByIndex=e.get("colorMap");this.colorMapByValue=null}else{this.colorMapByIndex=null;this.colorMapByValue=e.get("colorMap");if(this.colorMapByValue&&this.colorMapByValue.get===E){this.colorMapByValue=new X(this.colorMapByValue)}}this.initTarget()},getRegion:function(t,i,e){return N.floor(i/this.totalBarWidth)},getCurrentRegionFields:function(){var t=this.currentRegion;return{isNull:this.values[t]===E,value:this.values[t],color:this.calcColor(this.values[t],t),offset:t}},calcColor:function(t,i){var e=this.values,s=this.options,r=this.colorMapByIndex,n=this.colorMapByValue,a,h;if(n&&(h=n.get(t))){a=h}else if(r&&r.length>i){a=r[i]}else if(e[i]<0){a=s.get("negBarColor")}else if(e[i]>0){a=s.get("posBarColor")}else{a=s.get("zeroBarColor")}return a},renderRegion:function(t,i){var e=this.values,s=this.options,r=this.target,n,a,h,o,l,g;n=r.pixelHeight;h=N.round(n/2);o=t*this.totalBarWidth;if(e[t]<0){l=h;a=h-1}else if(e[t]>0){l=0;a=h-1}else{l=h-1;a=2}g=this.calcColor(e[t],t);if(g===null){return}if(i){g=this.calcHighlightColor(g,s)}return r.drawRect(o,l,this.barWidth-1,a-1,g,g)}});q.fn.sparkline.discrete=l=i(q.fn.sparkline._base,h,{type:"discrete",init:function(t,i,e,s,r){l._super.init.call(this,t,i,e,s,r);this.regionShapes={};this.values=i=q.map(i,Number);this.min=N.min.apply(N,i);this.max=N.max.apply(N,i);this.range=this.max-this.min;this.width=s=e.get("width")==="auto"?i.length*2:this.width;this.interval=N.floor(s/i.length);this.itemWidth=s/i.length;if(e.get("chartRangeMin")!==E&&(e.get("chartRangeClip")||e.get("chartRangeMin")<this.min)){this.min=e.get("chartRangeMin")}if(e.get("chartRangeMax")!==E&&(e.get("chartRangeClip")||e.get("chartRangeMax")>this.max)){this.max=e.get("chartRangeMax")}this.initTarget();if(this.target){this.lineHeight=e.get("lineHeight")==="auto"?N.round(this.canvasHeight*.3):e.get("lineHeight")}},getRegion:function(t,i,e){return N.floor(i/this.itemWidth)},getCurrentRegionFields:function(){var t=this.currentRegion;return{isNull:this.values[t]===E,value:this.values[t],offset:t}},renderRegion:function(t,i){var e=this.values,s=this.options,r=this.min,n=this.max,a=this.range,h=this.interval,o=this.target,l=this.canvasHeight,g=this.lineHeight,p=l-g,u,f,c,d;f=F(e[t],r,n);d=t*h;u=N.round(p-p*((f-r)/a));c=s.get("thresholdColor")&&f<s.get("thresholdValue")?s.get("thresholdColor"):s.get("lineColor");if(i){c=this.calcHighlightColor(c,s)}return o.drawLine(d,u,d,u+g,c)}});q.fn.sparkline.bullet=f=i(q.fn.sparkline._base,{type:"bullet",init:function(t,i,e,s,r){var n,a,h;f._super.init.call(this,t,i,e,s,r);this.values=i=O(i);h=i.slice();h[0]=h[0]===null?h[2]:h[0];h[1]=i[1]===null?h[2]:h[1];n=N.min.apply(N,i);a=N.max.apply(N,i);if(e.get("base")===E){n=n<0?n:0}else{n=e.get("base")}this.min=n;this.max=a;this.range=a-n;this.shapes={};this.valueShapes={};this.regiondata={};this.width=s=e.get("width")==="auto"?"4.0em":s;this.target=this.$el.simpledraw(s,r,e.get("composite"));if(!i.length){this.disabled=true}this.initTarget()},getRegion:function(t,i,e){var s=this.target.getShapeAt(t,i,e);return s!==E&&this.shapes[s]!==E?this.shapes[s]:E},getCurrentRegionFields:function(){var t=this.currentRegion;return{fieldkey:t.substr(0,1),value:this.values[t.substr(1)],region:t}},changeHighlight:function(t){var i=this.currentRegion,e=this.valueShapes[i],s;delete this.shapes[e];switch(i.substr(0,1)){case"r":s=this.renderRange(i.substr(1),t);break;case"p":s=this.renderPerformance(t);break;case"t":s=this.renderTarget(t);break}this.valueShapes[i]=s.id;this.shapes[s.id]=i;this.target.replaceWithShape(e,s)},renderRange:function(t,i){var e=this.values[t],s=N.round(this.canvasWidth*((e-this.min)/this.range)),r=this.options.get("rangeColors")[t-2];if(i){r=this.calcHighlightColor(r,this.options)}return this.target.drawRect(0,0,s-1,this.canvasHeight-1,r,r)},renderPerformance:function(t){var i=this.values[1],e=N.round(this.canvasWidth*((i-this.min)/this.range)),s=this.options.get("performanceColor");if(t){s=this.calcHighlightColor(s,this.options)}return this.target.drawRect(0,N.round(this.canvasHeight*.3),e-1,N.round(this.canvasHeight*.4)-1,s,s)},renderTarget:function(t){var i=this.values[0],e=N.round(this.canvasWidth*((i-this.min)/this.range)-this.options.get("targetWidth")/2),s=N.round(this.canvasHeight*.1),r=this.canvasHeight-s*2,n=this.options.get("targetColor");if(t){n=this.calcHighlightColor(n,this.options)}return this.target.drawRect(e,s,this.options.get("targetWidth")-1,r-1,n,n)},render:function(){var t=this.values.length,i=this.target,e,s;if(!f._super.render.call(this)){return}for(e=2;e<t;e++){s=this.renderRange(e).append();this.shapes[s.id]="r"+e;this.valueShapes["r"+e]=s.id}if(this.values[1]!==null){s=this.renderPerformance().append();this.shapes[s.id]="p1";this.valueShapes.p1=s.id}if(this.values[0]!==null){s=this.renderTarget().append();this.shapes[s.id]="t0";this.valueShapes.t0=s.id}i.render()}});q.fn.sparkline.pie=c=i(q.fn.sparkline._base,{type:"pie",init:function(t,i,e,s,r){var n=0,a;c._super.init.call(this,t,i,e,s,r);this.shapes={};this.valueShapes={};this.values=i=q.map(i,Number);if(e.get("width")==="auto"){this.width=this.height}if(i.length>0){for(a=i.length;a--;){n+=i[a]}}this.total=n;this.initTarget();this.radius=N.floor(N.min(this.canvasWidth,this.canvasHeight)/2)},getRegion:function(t,i,e){var s=this.target.getShapeAt(t,i,e);return s!==E&&this.shapes[s]!==E?this.shapes[s]:E},getCurrentRegionFields:function(){var t=this.currentRegion;return{isNull:this.values[t]===E,value:this.values[t],percent:this.values[t]/this.total*100,color:this.options.get("sliceColors")[t%this.options.get("sliceColors").length],offset:t}},changeHighlight:function(t){var i=this.currentRegion,e=this.renderSlice(i,t),s=this.valueShapes[i];delete this.shapes[s];this.target.replaceWithShape(s,e);this.valueShapes[i]=e.id;this.shapes[e.id]=i},renderSlice:function(t,i){var e=this.target,s=this.options,r=this.radius,n=s.get("borderWidth"),a=s.get("offset"),h=2*N.PI,o=this.values,l=this.total,g=a?2*N.PI*(a/360):0,p,u,f,c,d;c=o.length;for(f=0;f<c;f++){p=g;u=g;if(l>0){u=g+h*(o[f]/l)}if(t===f){d=s.get("sliceColors")[f%s.get("sliceColors").length];if(i){d=this.calcHighlightColor(d,s)}return e.drawPieSlice(r,r,r-n,p,u,E,d)}g=u}},render:function(){var t=this.target,i=this.values,e=this.options,s=this.radius,r=e.get("borderWidth"),n,a;if(!c._super.render.call(this)){return}if(r){t.drawCircle(s,s,N.floor(s-r/2),e.get("borderColor"),E,r).append()}for(a=i.length;a--;){if(i[a]){n=this.renderSlice(a).append();this.valueShapes[a]=n.id;this.shapes[n.id]=a}}t.render()}});q.fn.sparkline.box=w=i(q.fn.sparkline._base,{type:"box",init:function(t,i,e,s,r){w._super.init.call(this,t,i,e,s,r);this.values=q.map(i,Number);this.width=e.get("width")==="auto"?"4.0em":s;this.initTarget();if(!this.values.length){this.disabled=1}},getRegion:function(){return 1},getCurrentRegionFields:function(){var t=[{field:"lq",value:this.quartiles[0]},{field:"med",value:this.quartiles[1]},{field:"uq",value:this.quartiles[2]}];if(this.loutlier!==E){t.push({field:"lo",value:this.loutlier})}if(this.routlier!==E){t.push({field:"ro",value:this.routlier})}if(this.lwhisker!==E){t.push({field:"lw",value:this.lwhisker})}if(this.rwhisker!==E){t.push({field:"rw",value:this.rwhisker})}return t},render:function(){var t=this.target,i=this.values,e=i.length,s=this.options,r=this.canvasWidth,n=this.canvasHeight,a=s.get("chartRangeMin")===E?N.min.apply(N,i):s.get("chartRangeMin"),h=s.get("chartRangeMax")===E?N.max.apply(N,i):s.get("chartRangeMax"),o=0,l,g,p,u,f,c,d,v,m,x,y;if(!w._super.render.call(this)){return}if(s.get("raw")){if(s.get("showOutliers")&&i.length>5){g=i[0];l=i[1];u=i[2];f=i[3];c=i[4];d=i[5];v=i[6]}else{l=i[0];u=i[1];f=i[2];c=i[3];d=i[4]}}else{i.sort(function(t,i){return t-i});u=C(i,1);f=C(i,2);c=C(i,3);p=c-u;if(s.get("showOutliers")){l=d=E;for(m=0;m<e;m++){if(l===E&&i[m]>u-p*s.get("outlierIQR")){l=i[m]}if(i[m]<c+p*s.get("outlierIQR")){d=i[m]}}g=i[0];v=i[e-1]}else{l=i[0];d=i[e-1]}}this.quartiles=[u,f,c];this.lwhisker=l;this.rwhisker=d;this.loutlier=g;this.routlier=v;y=r/(h-a+1);if(s.get("showOutliers")){o=N.ceil(s.get("spotRadius"));r-=2*N.ceil(s.get("spotRadius"));y=r/(h-a+1);if(g<l){t.drawCircle((g-a)*y+o,n/2,s.get("spotRadius"),s.get("outlierLineColor"),s.get("outlierFillColor")).append()}if(v>d){t.drawCircle((v-a)*y+o,n/2,s.get("spotRadius"),s.get("outlierLineColor"),s.get("outlierFillColor")).append()}}t.drawRect(N.round((u-a)*y+o),N.round(n*.1),N.round((c-u)*y),N.round(n*.8),s.get("boxLineColor"),s.get("boxFillColor")).append();t.drawLine(N.round((l-a)*y+o),N.round(n/2),N.round((u-a)*y+o),N.round(n/2),s.get("lineColor")).append();t.drawLine(N.round((l-a)*y+o),N.round(n/4),N.round((l-a)*y+o),N.round(n-n/4),s.get("whiskerColor")).append();t.drawLine(N.round((d-a)*y+o),N.round(n/2),N.round((c-a)*y+o),N.round(n/2),s.get("lineColor")).append();t.drawLine(N.round((d-a)*y+o),N.round(n/4),N.round((d-a)*y+o),N.round(n-n/4),s.get("whiskerColor")).append();t.drawLine(N.round((f-a)*y+o),N.round(n*.1),N.round((f-a)*y+o),N.round(n*.9),s.get("medianColor")).append();if(s.get("target")){x=N.ceil(s.get("spotRadius"));t.drawLine(N.round((s.get("target")-a)*y+o),N.round(n/2-x),N.round((s.get("target")-a)*y+o),N.round(n/2+x),s.get("targetColor")).append();t.drawLine(N.round((s.get("target")-a)*y+o-x),N.round(n/2),N.round((s.get("target")-a)*y+o+x),N.round(n/2),s.get("targetColor")).append()}t.render()}});x=i({init:function(t,i,e,s){this.target=t;this.id=i;this.type=e;this.args=s},append:function(){this.target.appendShape(this);return this}});y=i({_pxregex:/(\d+)(px)?\s*$/i,init:function(t,i,e){if(!t){return}this.width=t;this.height=i;this.target=e;this.lastShapeId=null;if(e[0]){e=e[0]}q.data(e,"_jqs_vcanvas",this)},drawLine:function(t,i,e,s,r,n){return this.drawShape([[t,i],[e,s]],r,n)},drawShape:function(t,i,e,s){return this._genShape("Shape",[t,i,e,s])},drawCircle:function(t,i,e,s,r,n){return this._genShape("Circle",[t,i,e,s,r,n])},drawPieSlice:function(t,i,e,s,r,n,a){return this._genShape("PieSlice",[t,i,e,s,r,n,a])},drawRect:function(t,i,e,s,r,n){return this._genShape("Rect",[t,i,e,s,r,n])},getElement:function(){return this.canvas},getLastShapeId:function(){return this.lastShapeId},reset:function(){alert("reset not implemented")},_insert:function(t,i){q(i).html(t)},_calculatePixelDims:function(t,i,e){var s;s=this._pxregex.exec(i);if(s){this.pixelHeight=s[1]}else{this.pixelHeight=q(e).height()}s=this._pxregex.exec(t);if(s){this.pixelWidth=s[1]}else{this.pixelWidth=q(e).width()}},_genShape:function(t,i){var e=M++;i.unshift(e);return new x(this,e,t,i)},appendShape:function(t){alert("appendShape not implemented")},replaceWithShape:function(t,i){alert("replaceWithShape not implemented")},insertAfterShape:function(t,i){alert("insertAfterShape not implemented")},removeShapeId:function(t){alert("removeShapeId not implemented")},getShapeAt:function(t,i,e){alert("getShapeAt not implemented")},render:function(){alert("render not implemented")}});R=i(y,{init:function(t,i,e,s){R._super.init.call(this,t,i,e);this.canvas=_.createElement("canvas");if(e[0]){e=e[0]}q.data(e,"_jqs_vcanvas",this);q(this.canvas).css({display:"inline-block",width:t,height:i,verticalAlign:"top"});this._insert(this.canvas,e);this._calculatePixelDims(t,i,this.canvas);this.canvas.width=this.pixelWidth;this.canvas.height=this.pixelHeight;this.interact=s;this.shapes={};this.shapeseq=[];this.currentTargetShapeId=E;q(this.canvas).css({width:this.pixelWidth,height:this.pixelHeight})},_getContext:function(t,i,e){var s=this.canvas.getContext("2d");if(t!==E){s.strokeStyle=t}s.lineWidth=e===E?1:e;if(i!==E){s.fillStyle=i}return s},reset:function(){var t=this._getContext();t.clearRect(0,0,this.pixelWidth,this.pixelHeight);this.shapes={};this.shapeseq=[];this.currentTargetShapeId=E},_drawShape:function(t,i,e,s,r){var n=this._getContext(e,s,r),a,h;n.beginPath();n.moveTo(i[0][0]+.5,i[0][1]+.5);for(a=1,h=i.length;a<h;a++){n.lineTo(i[a][0]+.5,i[a][1]+.5)}if(e!==E){n.stroke()}if(s!==E){n.fill()}if(this.targetX!==E&&this.targetY!==E&&n.isPointInPath(this.targetX,this.targetY)){this.currentTargetShapeId=t}},_drawCircle:function(t,i,e,s,r,n,a){var h=this._getContext(r,n,a);h.beginPath();h.arc(i,e,s,0,2*N.PI,false);if(this.targetX!==E&&this.targetY!==E&&h.isPointInPath(this.targetX,this.targetY)){this.currentTargetShapeId=t}if(r!==E){h.stroke()}if(n!==E){h.fill()}},_drawPieSlice:function(t,i,e,s,r,n,a,h){var o=this._getContext(a,h);o.beginPath();o.moveTo(i,e);o.arc(i,e,s,r,n,false);o.lineTo(i,e);o.closePath();if(a!==E){o.stroke()}if(h){o.fill()}if(this.targetX!==E&&this.targetY!==E&&o.isPointInPath(this.targetX,this.targetY)){this.currentTargetShapeId=t}},_drawRect:function(t,i,e,s,r,n,a){return this._drawShape(t,[[i,e],[i+s,e],[i+s,e+r],[i,e+r],[i,e]],n,a)},appendShape:function(t){this.shapes[t.id]=t;this.shapeseq.push(t.id);this.lastShapeId=t.id;return t.id},replaceWithShape:function(t,i){var e=this.shapeseq,s;this.shapes[i.id]=i;for(s=e.length;s--;){if(e[s]==t){e[s]=i.id}}delete this.shapes[t]},replaceWithShapes:function(t,i){var e=this.shapeseq,s={},r,n,a;for(n=t.length;n--;){s[t[n]]=true}for(n=e.length;n--;){r=e[n];if(s[r]){e.splice(n,1);delete this.shapes[r];a=n}}for(n=i.length;n--;){e.splice(a,0,i[n].id);this.shapes[i[n].id]=i[n]}},insertAfterShape:function(t,i){var e=this.shapeseq,s;for(s=e.length;s--;){if(e[s]===t){e.splice(s+1,0,i.id);this.shapes[i.id]=i;return}}},removeShapeId:function(t){var i=this.shapeseq,e;for(e=i.length;e--;){if(i[e]===t){i.splice(e,1);break}}delete this.shapes[t]},getShapeAt:function(t,i,e){this.targetX=i;this.targetY=e;this.render();return this.currentTargetShapeId},render:function(){var t=this.shapeseq,i=this.shapes,e=t.length,s=this._getContext(),r,n,a;s.clearRect(0,0,this.pixelWidth,this.pixelHeight);for(a=0;a<e;a++){r=t[a];n=i[r];this["_draw"+n.type].apply(this,n.args)}if(!this.interact){this.shapes={};this.shapeseq=[]}}});S=i(y,{init:function(t,i,e){var s;S._super.init.call(this,t,i,e);if(e[0]){e=e[0]}q.data(e,"_jqs_vcanvas",this);this.canvas=_.createElement("span");q(this.canvas).css({display:"inline-block",position:"relative",overflow:"hidden",width:t,height:i,margin:"0px",padding:"0px",verticalAlign:"top"});this._insert(this.canvas,e);this._calculatePixelDims(t,i,this.canvas);this.canvas.width=this.pixelWidth;this.canvas.height=this.pixelHeight;s='<v:group coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"'+' style="position:absolute;top:0;left:0;width:'+this.pixelWidth+"px;height="+this.pixelHeight+'px;"></v:group>';this.canvas.insertAdjacentHTML("beforeEnd",s);this.group=q(this.canvas).children()[0];this.rendered=false;this.prerender=""},_drawShape:function(t,i,e,s,r){var n=[],a,h,o,l,g,p,u;for(u=0,p=i.length;u<p;u++){n[u]=""+i[u][0]+","+i[u][1]}a=n.splice(0,1);r=r===E?1:r;h=e===E?' stroked="false" ':' strokeWeight="'+r+'px" strokeColor="'+e+'" ';o=s===E?' filled="false"':' fillColor="'+s+'" filled="true" ';l=n[0]===n[n.length-1]?"x ":"";g='<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'" '+' id="jqsshape'+t+'" '+h+o+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;" '+' path="m '+a+" l "+n.join(", ")+" "+l+'e">'+" </v:shape>";return g},_drawCircle:function(t,i,e,s,r,n,a){var h,o,l;i-=s;e-=s;h=r===E?' stroked="false" ':' strokeWeight="'+a+'px" strokeColor="'+r+'" ';o=n===E?' filled="false"':' fillColor="'+n+'" filled="true" ';l="<v:oval "+' id="jqsshape'+t+'" '+h+o+' style="position:absolute;top:'+e+"px; left:"+i+"px; width:"+s*2+"px; height:"+s*2+'px"></v:oval>';return l},_drawPieSlice:function(t,i,e,s,r,n,a,h){var o,l,g,p,u,f,c,d;if(r===n){return""}if(n-r===2*N.PI){r=0;n=2*N.PI}l=i+N.round(N.cos(r)*s);g=e+N.round(N.sin(r)*s);p=i+N.round(N.cos(n)*s);u=e+N.round(N.sin(n)*s);if(l===p&&g===u){if(n-r<N.PI){return""}l=p=i+s;g=u=e}if(l===p&&g===u&&n-r<N.PI){return""}o=[i-s,e-s,i+s,e+s,l,g,p,u];f=a===E?' stroked="false" ':' strokeWeight="1px" strokeColor="'+a+'" ';c=h===E?' filled="false"':' fillColor="'+h+'" filled="true" ';d='<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'" '+' id="jqsshape'+t+'" '+f+c+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;" '+' path="m '+i+","+e+" wa "+o.join(", ")+' x e">'+" </v:shape>";return d},_drawRect:function(t,i,e,s,r,n,a){return this._drawShape(t,[[i,e],[i,e+r],[i+s,e+r],[i+s,e],[i,e]],n,a)},reset:function(){this.group.innerHTML=""},appendShape:function(t){var i=this["_draw"+t.type].apply(this,t.args);if(this.rendered){this.group.insertAdjacentHTML("beforeEnd",i)}else{this.prerender+=i}this.lastShapeId=t.id;return t.id},replaceWithShape:function(t,i){var e=q("#jqsshape"+t),s=this["_draw"+i.type].apply(this,i.args);e[0].outerHTML=s},replaceWithShapes:function(t,i){var e=q("#jqsshape"+t[0]),s="",r=i.length,n;for(n=0;n<r;n++){s+=this["_draw"+i[n].type].apply(this,i[n].args)}e[0].outerHTML=s;for(n=1;n<t.length;n++){q("#jqsshape"+t[n]).remove()}},insertAfterShape:function(t,i){var e=q("#jqsshape"+t),s=this["_draw"+i.type].apply(this,i.args);e[0].insertAdjacentHTML("afterEnd",s)},removeShapeId:function(t){var i=q("#jqsshape"+t);this.group.removeChild(i[0])},getShapeAt:function(t,i,e){var s=t.id.substr(8);return s},render:function(){if(!this.rendered){this.group.innerHTML=this.prerender;this.rendered=true}}})})})(document,Math);
// #END
