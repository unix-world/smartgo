// JS-Script (UM): str-diff.js @ 2022-09-20 09:51:20 +0000
var Smart_StrDiff=new function(){this.Compare=function(t,r){return l(String(t),String(r))};function l(t,r){t="\n"+smartJ$Utils.stringTrim(t);r="\n"+smartJ$Utils.stringTrim(r);t=t.replace(/\s+$/,"");r=r.replace(/\s+$/,"");var l=a(t==""?[]:t.split(/\s+/),r==""?[]:r.split(/\s+/));var e="";var n=t.match(/\s+/g);if(n==null){n=["\n"]}else{n.push("\n")}var s=r.match(/\s+/g);if(s==null){s=["\n"]}else{s.push("\n")}if(l.n.length==0){for(var o=0;o<l.o.length;o++){e+="<del>"+smartJ$Utils.escape_html(l.o[o])+"</del>"+n[o]}}else{if(l.n[0].text==null){for(r=0;r<l.o.length&&l.o[r].text==null;r++){e+="<del>"+smartJ$Utils.escape_html(l.o[r])+"</del>"+n[r]}}for(var o=0;o<l.n.length;o++){if(l.n[o].text==null){e+="<ins>"+smartJ$Utils.escape_html(l.n[o])+"</ins>"+s[o]}else{var i="";for(r=l.n[o].row+1;r<l.o.length&&l.o[r].text==null;r++){i+="<del>"+smartJ$Utils.escape_html(l.o[r])+"</del>"+n[r]}e+=" "+smartJ$Utils.escape_html(l.n[o].text)+s[o]+i}}}e=smartJ$Utils.stringReplaceAll("</ins>\n<del>","</ins> <del>",e);e=smartJ$Utils.stringReplaceAll("</del>\n<ins>","</del> <ins>",e);e=smartJ$Utils.stringTrim(e);return String(e)}var a=function(t,r){var l=new Object;var e=new Object;for(var n=0;n<r.length;n++){if(l[r[n]]==null){l[r[n]]={rows:new Array,o:null}}l[r[n]].rows.push(n)}for(var n=0;n<t.length;n++){if(e[t[n]]==null){e[t[n]]={rows:new Array,n:null}}e[t[n]].rows.push(n)}for(var n in l){if(l[n].rows.length==1&&typeof e[n]!="undefined"&&e[n].rows.length==1){r[l[n].rows[0]]={text:r[l[n].rows[0]],row:e[n].rows[0]};t[e[n].rows[0]]={text:t[e[n].rows[0]],row:l[n].rows[0]}}}for(var n=0;n<r.length-1;n++){if(r[n].text!=null&&r[n+1].text==null&&r[n].row+1<t.length&&t[r[n].row+1].text==null&&r[n+1]==t[r[n].row+1]){r[n+1]={text:r[n+1],row:r[n].row+1};t[r[n].row+1]={text:t[r[n].row+1],row:n+1}}}for(var n=r.length-1;n>0;n--){if(r[n].text!=null&&r[n-1].text==null&&r[n].row>0&&t[r[n].row-1].text==null&&r[n-1]==t[r[n].row-1]){r[n-1]={text:r[n-1],row:r[n].row-1};t[r[n].row-1]={text:t[r[n].row-1],row:n-1}}}return{o:t,n:r}}};
// #END
