// JS-Script (US): browser_utils.js @ 2022-09-28 13:44:27 +0000
const smartJ$Browser=new class{constructor(){const _N$="smartJ$Browser";const _C$=this;const _p$=console;let SECURED=false;_C$.secureClass=()=>{if(SECURED===true){_p$.warn(_N$,"Class is already SECURED")}else{SECURED=true;Object.freeze(_C$)}};const $=jQuery;const _Option$=typeof smartJ$Options!="undefined"&&smartJ$Options&&typeof smartJ$Options==="object"&&smartJ$Options.BrowserUtils!=undefined&&typeof smartJ$Options.BrowserUtils==="object"?smartJ$Options.BrowserUtils:null;const _Utils$=smartJ$Utils;const _Date$=smartJ$Date;const _Ba$e64=smartJ$Base64;const _Crypto$Hash=smartJ$CryptoHash;const _Crypto$Blowfish=smartJ$CryptoBlowfish;const _Te$tBrowser=smartJ$TestBrowser;_C$.param_LanguageId=_Option$&&typeof _Option$.LanguageId=="string"&&_Option$.LanguageId?_Utils$.stringTrim(_Option$.LanguageId):"en";_C$.param_Charset=_Option$&&typeof _Option$.Charset=="string"&&_Option$.Charset?_Utils$.stringTrim(_Option$.Charset):"UTF-8";_C$.param_CookieLifeTime=_Option$&&typeof _Option$.CookieLifeTime=="number"&&_Option$.CookieLifeTime&&_Utils$.isFiniteNumber(_Option$.CookieLifeTime)?_Utils$.format_number_int(_Option$.CookieLifeTime,false):0;_C$.param_CookieDomain=_Option$&&typeof _Option$.CookieDomain=="string"&&_Option$.CookieDomain?_Utils$.stringTrim(_Option$.CookieDomain):"";_C$.param_CookieSameSitePolicy=_Option$&&typeof _Option$.CookieSameSitePolicy=="string"&&_Option$.CookieSameSitePolicy?_Utils$.stringTrim(_Option$.CookieSameSitePolicy):"";_C$.param_Notifications=_Option$&&typeof _Option$.Notifications=="string"&&_Option$.Notifications?_Utils$.stringTrim(_Option$.Notifications):"growl";_C$.param_NotificationDialogType=_Option$&&typeof _Option$.NotificationDialogType=="string"&&_Option$.NotificationDialogType?_Utils$.stringTrim(_Option$.NotificationDialogType):"auto";_C$.param_NotificationGrowlType=_Option$&&typeof _Option$.NotificationGrowlType=="string"&&_Option$.NotificationGrowlType?_Utils$.stringTrim(_Option$.NotificationGrowlType):"auto";_C$.param_NotificationTimeOK=_Option$&&typeof _Option$.NotificationTimeOK=="number"&&_Option$.NotificationTimeOK&&_Utils$.isFiniteNumber(_Option$.NotificationTimeOK)?_Utils$.format_number_int(_Option$.NotificationTimeOK,false):1e3;_C$.param_NotificationTimeERR=_Option$&&typeof _Option$.NotificationTimeERR=="number"&&_Option$.NotificationTimeERR&&_Utils$.isFiniteNumber(_Option$.NotificationTimeERR)?_Utils$.format_number_int(_Option$.NotificationTimeERR,false):3500;_C$.param_NotifyLoadError=_Option$&&!!_Option$.NotifyLoadError?true:false;_C$.param_ModalBoxActive=_Option$&&_Option$.ModalBoxActive===2?2:_Option$&&_Option$.ModalBoxActive===0?0:1;_C$.param_ModalBoxNoCascade=_Option$&&_Option$.ModalBoxNoCascade===false?false:true;_C$.param_ModalBoxProtected=_Option$&&!!_Option$.ModalBoxProtected?true:false;_C$.param_LoaderImg=_Option$&&typeof _Option$.LoaderImg=="string"&&_Option$.LoaderImg?_Utils$.stringTrim(_Option$.LoaderImg):"lib/js/framework/img/loading.svg";_C$.param_LoaderBlank=_Option$&&typeof _Option$.LoaderBlank=="string"&&_Option$.LoaderBlank?_Utils$.stringTrim(_Option$.LoaderBlank):"lib/js/framework/loading.html";_C$.param_ImgOK=_Option$&&typeof _Option$.ImgOK=="string"&&_Option$.ImgOK?_Utils$.stringTrim(_Option$.ImgOK):"lib/framework/img/sign-ok.svg";_C$.param_ImgNotOK=_Option$&&typeof _Option$.ImgNotOK=="string"&&_Option$.ImgNotOK?_Utils$.stringTrim(_Option$.ImgNotOK):"lib/framework/img/sign-warn.svg";_C$.param_ImgCloneInsert=_Option$&&typeof _Option$.ImgCloneInsert=="string"&&_Option$.ImgCloneInsert?_Utils$.stringTrim(_Option$.ImgCloneInsert):"lib/js/framework/img/clone-insert.svg";_C$.param_ImgCloneRemove=_Option$&&typeof _Option$.ImgCloneRemove=="string"&&_Option$.ImgCloneRemove?_Utils$.stringTrim(_Option$.ImgCloneRemove):"lib/js/framework/img/clone-remove.svg";_C$.param_IconImgFullScreen=_Option$&&typeof _Option$.IconImgFullScreen=="string"&&_Option$.IconImgFullScreen?_Utils$.stringTrim(_Option$.IconImgFullScreen):"lib/js/framework/img/fullscreen-on.svg";_C$.param_CssOverlayBgColor=_Option$&&typeof _Option$.CssOverlayBgColor=="string"&&_Option$.CssOverlayBgColor&&String(_Option$.CssOverlayBgColor).match(/^\#([0-9a-f]{6})$/i)?_Utils$.stringTrim(_Option$.CssOverlayBgColor):"#FFFFFF";_C$.param_CssOverlayOpacity=_Option$&&typeof _Option$.CssOverlayOpacity=="number"&&_Utils$.isFiniteNumber(_Option$.CssOverlayOpacity)&&_Utils$.format_number_float(_Option$.CssOverlayOpacity,false)>=0&&_Utils$.format_number_float(_Option$.CssOverlayOpacity,false)<=1?_Utils$.format_number_dec(_Option$.CssOverlayOpacity,2,false,true):.85;_C$.param_TimeDelayCloseWnd=_Option$&&typeof _Option$.TimeDelayCloseWnd=="number"&&_Option$.TimeDelayCloseWnd&&_Utils$.isFiniteNumber(_Option$.TimeDelayCloseWnd)?_Utils$.format_number_int(_Option$.TimeDelayCloseWnd,false):750;let flag_PageUnloadConfirm=false;let flag_PageAway=false;let flag_RefreshState=0;let flag_RefreshURL="";let flag_DebugEnabled=false;let flag_DebugPageAway=false;const defSmartPopupTarget="smartPWin";let objRefWinPopup=null;const objKeyEntries="_Crypto$Hash.crc32b({"+_Utils$.stringUcFirst(String(typeof _C$).toLowerCase())+".entries("+_N$+"[!is"+_Utils$.create_jsvar("{"+ +"}")+"()]"+")}.to"+_Utils$.stringUcFirst(typeof([]+[]))+"())";const sfOverlayID="smart-framework-overlay";const cssAlertable="background:#555555; color:#FFFFFF; font-size:1.5rem; font-weight:bold; text-align:right; padding-top:3px; padding-left:10px; padding-right:10px; margin-bottom:20px;";const regexValidCookieName=RegExp(/^[a-zA-Z0-9_\-]+$/);const HTTP_STATUS_CODES={200:"OK",202:"Accepted",203:"Non-Authoritative Information",208:"Already Reported",301:"Moved Permanently",302:"Found",304:"Not Modified",400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",429:"Too Many Requests",500:"Internal Server Error",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout"};const setFlag=(flag,value)=>{flag=String(flag||"");switch(flag){case"PageUnloadConfirm":flag_PageUnloadConfirm=!!value;return true;break;case"PageAway":if(flag_DebugEnabled===true){_p$.log(_N$,"Debug is ON, the setFlag:PageAway is overriden ...");flag_DebugPageAway=!!value}else{flag_PageAway=!!value}return true;break;case"RefreshState":flag_RefreshState=!!value?1:0;return true;break;case"RefreshURL":flag_RefreshURL=_Utils$.stringPureVal(value,true);return true;break;case"DebugEnabled":flag_DebugEnabled=!!value;if(flag_DebugEnabled===true){PageAwayControl("Debug is ON. Confirm Leaving the page. This confirmation is to avoid javascript redirects without explicit confirmation when Debug is enabled.")}else{flag_PageAway=!!flag_DebugPageAway}return true;break;default:_p$.warn(_N$,"Set Invalid Flag:",flag,value)}return false};_C$.setFlag=setFlag;const getFlag=flag=>{flag=String(flag||"");switch(flag){case"PageUnloadConfirm":return!!flag_PageUnloadConfirm;break;case"PageAway":return!!flag_PageAway;break;case"RefreshState":return flag_RefreshState?1:0;break;case"RefreshURL":return _Utils$.stringPureVal(flag_RefreshURL,true);break;case"DebugEnabled":return!!flag_DebugEnabled;break;default:_p$.warn(_N$,"Get Invalid Flag:",flag)}return null};_C$.getFlag=getFlag;const getRefPopup=()=>objRefWinPopup;_C$.getRefPopup=getRefPopup;const getCurrentIsoDateTime=()=>{const crrDate=new Date;return String(_Date$.getIsoDate(crrDate,true))};_C$.getCurrentIsoDateTime=getCurrentIsoDateTime;const blowfishEncrypt=str=>{str=_Utils$.stringPureVal(str);if(str==""){return""}return String(_Crypto$Blowfish.encrypt(str,objKeyEntries+"("+"'"+_Crypto$Hash.crc32b(_N$)+"'"+");"))};_C$.blowfishEncrypt=blowfishEncrypt;const blowfishDecrypt=enc=>{enc=_Utils$.stringPureVal(enc,true);if(enc==""){return""}return String(_Crypto$Blowfish.decrypt(enc,objKeyEntries+"("+"'"+_Crypto$Hash.crc32b(_N$)+"'"+");"))};_C$.blowfishDecrypt=blowfishDecrypt;const stripTags=html=>{html=_Utils$.stringPureVal(html);if(html==""){return""}return $("<div>"+html.replace(/(<([^>]+)>)/g," ")+"</div>").text()};_C$.stripTags=stripTags;const parseCurrentUrlGetParams=function(semantic_sf_url=true){let result={};if(!location.search){return result}let query=String(location.search.substr(1));if(!query){return result}query.split("&").forEach(part=>{let item="";let v="";let s="";part=String(part);if(part){item=part.split("=");v=String(item[0]);if(semantic_sf_url===true&&v.indexOf("/")!==-1){let arr=v.split("/");let found=false;for(let i=0;i<arr.length;i++){if(found!==true){if(arr[i]!==""){found=true}else{continue}}result[String(arr[i])]=String(decodeURIComponent(String(arr[i+1]?arr[i+1]:""))||"");i+=1}}else{result[String(item[0])]=String(decodeURIComponent(String(item[1]?item[1]:""))||"")}}});return result};_C$.parseCurrentUrlGetParams=parseCurrentUrlGetParams;const PrintPage=()=>{try{self.print()}catch(err){_p$.warn(_N$,"Print Page is N/A:",err);AlertDialog("NOTICE: Printing may not be available in your browser")}};_C$.PrintPage=PrintPage;const CountDown=function(counter,elID,evcode,prettyFormat){const _m$="CountDown";if(counter==undefined||counter==""){_p$.error(_N$,_m$,"ERR: undefined Counter Init");return}counter=_Utils$.format_number_int(counter,false);if(counter<1){return}const cdwn=setInterval(()=>{if(counter>0){counter=counter-1;if(elID!=undefined&&elID!=""){const theID=_Utils$.create_htmid(elID);let cntTxt=String(counter);if(prettyFormat===true){cntTxt=String(_Date$.prettySecondsToDHMS(counter))}if(theID!=""){$("#"+theID).empty().text(cntTxt)}}}else{clearInterval(cdwn);_Utils$.evalJsFxCode(_N$+"."+_m$,typeof evcode==="function"?()=>{"use strict";evcode(counter,elID)}:()=>{"use strict";!!evcode?eval(evcode):null})}},1e3)};_C$.CountDown=CountDown;const windowFocus=wnd=>{try{wnd.focus()}catch(err){}};_C$.windowFocus=windowFocus;const WindowIsiFrame=()=>{if(window.self!==window.top){return true}return false};_C$.WindowIsiFrame=WindowIsiFrame;const WindowIsPopup=()=>{if(window.opener){return true}return false};_C$.WindowIsPopup=WindowIsPopup;const PageAwayControl=function(the_question){_C$.setFlag("PageUnloadConfirm",true);the_question=_Utils$.stringPureVal(the_question,true);if(the_question==""){the_question="Confirm leaving the page ... ?"}$(window).on("beforeunload",evt=>{let e=evt||window.event;if(_C$.getFlag("PageAway")!=true){e.preventDefault();if(_C$.getFlag("DebugEnabled")==true){const debugMsgTitle="*** DEBUG IS ON ***";const debugMsgText="Page Leave Confirmation is ENABLED";_p$.log(_N$,debugMsgTitle,debugMsgText);if(GrowlSelectType()!=""){GrowlNotificationAdd(_Utils$.escape_html(debugMsgTitle),_Utils$.escape_html(debugMsgText),"",1e4,false,"yellow")}}return String(the_question)}}).on("unload",()=>{_C$.setFlag("PageAway",true)});if(WindowIsiFrame()===true){if(typeof parent.smartJ$ModalBox!="undefined"){try{parent.smartJ$ModalBox.setHandlerOnBeforeUnload(()=>{if(_C$.getFlag("PageAway")!=true){let is_exit=confirm(String(the_question));if(is_exit){_C$.setFlag("PageAway",true)}return is_exit}else{return true}})}catch(err){_p$.error(_N$,"ERR: PageAwayControl failed on ModalBox:",err)}}}};_C$.PageAwayControl=PageAwayControl;const RedirectToURL=yURL=>{yURL=_Utils$.stringPureVal(yURL,true);if(yURL==""){_p$.warn(_N$,"WARN: RedirectToURL: empty URL");return}setFlag("PageAway",true);if(yURL==="@"){self.location=self.location}else{self.location=String(yURL)}};_C$.RedirectToURL=RedirectToURL;const RedirectDelayedToURL=function(yURL,ytime){ytime=_Utils$.format_number_int(ytime,false);setTimeout(()=>{RedirectToURL(yURL)},ytime)};_C$.RedirectDelayedToURL=RedirectDelayedToURL;const RedirectParent=function(yURL){const _m$="RedirectParent";yURL=_Utils$.stringPureVal(yURL,true);if(yURL==""){_p$.warn(_N$,_m$,"WARN: empty URL");return}yURL=String(yURL);if(WindowIsPopup()===true){try{window.opener.location=yURL}catch(err){_p$.error(_N$,_m$,"ERR: PopUp:",err)}}else if(WindowIsiFrame()===true){try{parent.location=yURL}catch(err){_p$.error(_N$,_m$,"ERR: iFrame:",err)}}};_C$.RedirectParent=RedirectParent;const RefreshParent=function(yURL){const _m$="RefreshParent";yURL=_Utils$.stringPureVal(yURL,true);if(WindowIsPopup()===true){try{if(window.opener){if(typeof window.opener.smartJ$Browser=="undefined"||typeof window.opener.smartJ$ModalBox=="undefined"){_p$.warn(_N$,_m$,"ERR: N/A for PopUp Parent");return}if(window.opener.smartJ$Browser.getFlag("PageUnloadConfirm")===true){return}if(window.opener.smartJ$ModalBox.getStatus()==="visible"){window.opener.smartJ$ModalBox.setRefreshParent(1,String(yURL));return}window.opener.smartJ$Browser.setFlag("RefreshState",1);window.opener.smartJ$Browser.setFlag("RefreshURL",yURL)}}catch(err){_p$.error(_N$,_m$,"ERR: Failed for PopUp:",err)}}else if(WindowIsiFrame()===true){try{if(self.name){if(typeof parent.smartJ$Browser=="undefined"||typeof parent.smartJ$ModalBox=="undefined"){_p$.warn(_N$,_m$,"ERR: N/A for iFrame Parent");return}if(self.name===parent.smartJ$ModalBox.getName()){if(parent.smartJ$Browser.getFlag("PageUnloadConfirm")!==true){parent.smartJ$ModalBox.setRefreshParent(true,yURL)}}}}catch(err){_p$.error(_N$,_m$,"ERR: Failed from iFrame:",err)}}};_C$.RefreshParent=RefreshParent;const CloseModalPopUp=function(){const _m$="CloseModalPopUp";if(WindowIsPopup()===true){if(window.opener&&typeof window.opener.smartJ$Browser!="undefined"){try{if(window.opener.smartJ$Browser.getRefPopup()&&window.opener.smartJ$Browser.getRefPopup()===self){}else{if(window.opener.smartJ$Browser.getFlag("RefreshState")){if(window.opener.smartJ$Browser.getFlag("RefreshURL")){window.opener.location=String(window.opener.smartJ$Browser.getFlag("RefreshURL"))}else{window.opener.location=window.opener.location}window.opener.smartJ$Browser.setFlag("RefreshState",0);window.opener.smartJ$Browser.setFlag("RefreshURL","")}}}catch(err){_p$.error(_N$,_m$,"ERR: Failed with PopUp:",err)}}else{_p$.warn(_N$,_m$,"ERR: PopUp Parent BrowserUtils is N/A")}try{self.close()}catch(err){}}else if(WindowIsiFrame()===true){if(typeof parent.smartJ$ModalBox=="undefined"){_p$.warn(_N$,_m$,"ERR: iFrame Parent ModalBox is N/A");return}try{if(self.name){if(self.name===parent.smartJ$ModalBox.getName()){parent.smartJ$ModalBox.UnloadURL()}}}catch(err){_p$.error(_N$,_m$,"ERR: Failed with iFrame:",err)}}else{try{self.close()}catch(err){}}};_C$.CloseModalPopUp=CloseModalPopUp;const CloseDelayedModalPopUp=function(timeout){timeout=_Utils$.format_number_int(timeout,false);if(timeout<=0){timeout=_Utils$.format_number_int(_C$.param_TimeDelayCloseWnd,false)}if(timeout<100){timeout=100}else if(timeout>6e4){timeout=6e4}setTimeout(()=>{setFlag("PageAway",true);CloseModalPopUp()},timeout)};_C$.CloseDelayedModalPopUp=CloseDelayedModalPopUp;const getCurrentPointerEventXY=function(evt,viwePortOnly=false){let coordinates={x:-1,y:-1,t:null,q:null};if(!evt){return coordinates}let pointEv=evt;if(evt.touches&&evt.touches.length>0){pointEv=evt.touches[0]}let X=-1;let Y=-1;if(viwePortOnly===true){coordinates.q="clientXY";X=pointEv.clientX||-1;Y=pointEv.clientY||-1}else{coordinates.q="pageXY";X=pointEv.pageX||-1;Y=pointEv.pageY||-1}coordinates.x=_Utils$.format_number_int(X);coordinates.y=_Utils$.format_number_int(Y);coordinates.t=_Utils$.stringPureVal(evt.type||"unknown",true).toLowerCase();return coordinates};_C$.getCurrentPointerEventXY=getCurrentPointerEventXY;const getHighestZIndex=function(){let index_highest=1;let index_current=1;$("div").each((i,el)=>{let $el=$(el);if($el.css("display")=="none"||$el.css("visibility")=="hidden"||$el.attr("id")=="SmartFramework___Debug_InfoBar"){}else{index_current=_Utils$.format_number_int(parseInt($el.css("z-index"),10));if(index_current>0){if(index_current>index_highest){index_highest=index_current}}}});if(index_highest<2147483647){index_highest+=1}return index_highest};_C$.getHighestZIndex=getHighestZIndex;const createMaxContainer=function(id,maximized=false){id=_Utils$.stringPureVal(id,true);id=_Utils$.create_htmid(id);if(id==""){_p$.error(_N$,"ERR: createMaxContainer: empty ID");return}const $el=$("#"+id);if($el.attr("data-fullscreen")=="default"||$el.attr("data-fullscreen")=="fullscreen"){return}$el.attr("data-fullscreen","default").append('<div style="position:absolute; top:-4px; left:-4px; width:20px; height: 20px; overflow:hidden; text-align:center; cursor:pointer; opacity:0.7;" title="Toggle Element Full Screen"><img height="20" src="'+_Utils$.escape_html(_C$.param_IconImgFullScreen)+'"></div>').css({position:"relative",border:"1px solid #DDDDDD","z-index":1}).click(btn=>{const $btn=$(btn.currentTarget);if($btn.attr("data-fullscreen")=="fullscreen"){OverlayHide();$btn.attr("data-fullscreen","default");$btn.css({position:"relative",top:0,left:0,width:Math.max(_Utils$.format_number_int(parseInt($btn.attr("data-width"))),100),height:Math.max(_Utils$.format_number_int(parseInt($btn.attr("data-height"))),100),"z-index":1})}else{OverlayShow();OverlayClear();$btn.attr("data-width",String(_Utils$.escape_html(String($btn.width()))));$btn.attr("data-height",String(_Utils$.escape_html(String($btn.height()))));$btn.attr("data-fullscreen","fullscreen");$btn.css({position:"fixed",top:"7px",left:"7px",width:"99%",height:"98%","z-index":2147403e3})}});if(maximized===true){$el.trigger("click")}};_C$.createMaxContainer=createMaxContainer;const OverlayShow=function(text,title,css_class,overlay_id=null,clear=false){text=_Utils$.stringPureVal(text,true);title=_Utils$.stringPureVal(title,true);css_class=_Utils$.stringPureVal(css_class,true);if(css_class==""){css_class="white"}overlay_id=OverlayValidID(overlay_id);let the_style='style="display: none; background-color:'+_Utils$.escape_html(_C$.param_CssOverlayBgColor)+"; opacity: "+_Utils$.escape_html(_C$.param_CssOverlayOpacity)+'; position: fixed; top: -50px; left: -50px; width: 1px; height: 1px;"';if(typeof smartJ$UI!="undefined"){if(typeof smartJ$UI.overlayCssClass!="undefined"&&smartJ$UI.overlayCssClass!=null&&smartJ$UI.overlayCssClass!=""){the_style='class="'+_Utils$.escape_html(smartJ$UI.overlayCssClass)+'"'}}const have_growl=GrowlSelectType()!=""?true:false;let inner_html='<img src="'+_Utils$.escape_html(_C$.param_LoaderImg)+'" alt="... loading ..." style="background:transparent!important;color:#555555!important;opacity:1!important;">';if(clear===true){inner_html=""}if(have_growl!==true){inner_html=inner_html+"<div>"+"<h1>"+title+"</h1>"+"<div>"+text+"</div>"+"</div>"}$("#"+overlay_id).remove();const overlay=$('<div id="'+_Utils$.escape_html(overlay_id)+'" '+the_style+"></div>").css({"z-index":21474e5,position:"fixed",top:"0px",left:"0px",width:"100%",height:"100%"}).hide().appendTo("body");$("#"+overlay_id).html('<div style="width:100%; position:fixed; top:25px; left:0px;"><center><div>'+inner_html+"</div></center></div>");try{overlay.fadeIn()}catch(err){overlay.show()}if(text!=""||title!=""){if(have_growl===true){GrowlNotificationAdd(title,text,"",500,false,css_class)}}return overlay};_C$.OverlayShow=OverlayShow;const OverlayClear=(overlay_id=null)=>{overlay_id=OverlayValidID(overlay_id);$("#"+overlay_id).empty().html("")};_C$.OverlayClear=OverlayClear;const OverlayHide=function(overlay_id=null){overlay_id=OverlayValidID(overlay_id);let overlay=$("#"+overlay_id);try{overlay.fadeOut()}catch(err){overlay.hide()}overlay.css({"z-index":1,position:"fixed",top:"-50px",left:"-50px",width:1,height:1}).remove()};_C$.OverlayHide=OverlayHide;const GrowlNotificationAdd=function(title,html,image,time,sticky=false,css_class=null,options=null){const _m$="GrowlNotificationAdd";time=_Utils$.format_number_int(time,false);if(time<0){time=0}else if(time>6e4){time=6e4}if(image!=undefined&&image!=""&&image!==false){image='<img src="'+_Utils$.escape_html(image)+'" align="right">'}else{image=""}css_class=_Utils$.stringPureVal(css_class,true);if(css_class=="undefined"){css_class=""}let growl_before_open=null;let growl_after_open=null;let growl_before_close=null;let growl_after_close=null;if(options){if(options.hasOwnProperty("before_open")){growl_before_open=options.before_open}if(options.hasOwnProperty("after_open")){growl_after_open=options.after_open}if(options.hasOwnProperty("before_close")){growl_before_close=options.before_close}if(options.hasOwnProperty("after_close")){growl_after_close=options.after_close}}const theGrowlType=GrowlSelectType();if(theGrowlType==="gritter"){css_class=String($.gritter.translateCssClasses(css_class));try{$.gritter.add({class_name:String(css_class),title:String(String(title)+String(image)),text:String(html),before_open:growl_before_open,after_open:growl_after_open,before_close:growl_before_close,after_close:growl_after_close,time:sticky?0:time,sticky:!!sticky})}catch(err){_p$.error(_N$,_m$,"ERR: gritter:",err)}}else if(theGrowlType==="toastr"){css_class=$.toastr.translateCssClasses(css_class);try{$.toastr.notify({appearanceClass:String(css_class),title:String(String(title)+String(image)),message:String(html),onBeforeVisible:growl_before_open,onVisible:growl_after_open,onBeforeHidden:growl_before_close,onHidden:growl_after_close,timeOut:sticky?0:time})}catch(err){_p$.error(_N$,_m$,"ERR: toastr:",err)}}else{if($.isFunction(growl_before_open)){growl_before_open()}if($.isFunction(growl_after_open)){growl_after_open()}let fx=()=>{if($.isFunction(growl_before_close)){growl_before_close()}if($.isFunction(growl_after_close)){growl_after_close()}};AlertDialog(html,fx,title);return false}return true};_C$.GrowlNotificationAdd=GrowlNotificationAdd;const GrowlNotificationRemove=function(){const growlType=GrowlSelectType();switch(growlType){case"gritter":$.gritter.removeAll();return true;break;case"toastr":$.toastr.clear();return true;break}return false};_C$.GrowlNotificationRemove=GrowlNotificationRemove;const AlertDialog=function(y_message,evcode=null,y_title="",y_width=null,y_height=null,dialogType="auto"){const _m$="AlertDialog";y_message=_Utils$.stringPureVal(y_message,true);y_title=_Utils$.stringPureVal(y_title,true);if(dialogType==="auto"){dialogType=DialogSelectType()}if(dialogType==="ui"){smartJ$UI.DialogAlert(y_message,evcode,y_title,y_width,y_height)}else if(dialogType==="dialog"){SmartSimpleDialog.Dialog_Alert(y_message,evcode,y_title,y_width,y_height)}else{const evErrMsg="ERR: JS-Eval Failed on DialogAlert";if(dialogType==="alertable"){$.alertable.alert((y_title?'<div style="'+_Utils$.escape_html(cssAlertable)+'">'+y_title+"</div>":"")+y_message,{html:true,width:y_width&&y_width>=275&&y_width<=960?y_width:550,height:y_height&&y_height>=100&&y_height<=720?y_height:270}).always(()=>{_Utils$.evalJsFxCode(_N$+"."+_m$+" (1)",evcode)})}else{y_title=stripTags(y_title);y_message=stripTags(y_message);alert(y_title+"\n"+y_message);_Utils$.evalJsFxCode(_N$+"."+_m$+" (2)",evcode)}}};_C$.AlertDialog=AlertDialog;const ConfirmDialog=function(y_question,evcode=null,y_title="",y_width=null,y_height=null,dialogType="auto"){const _m$="ConfirmDialog";y_question=_Utils$.stringPureVal(y_question,true);y_title=_Utils$.stringPureVal(y_title,true);if(dialogType==="auto"){dialogType=DialogSelectType()}if(dialogType==="ui"){smartJ$UI.DialogConfirm(y_question,evcode,y_title,y_width,y_height)}else if(dialogType==="dialog"){SmartSimpleDialog.Dialog_Confirm(y_question,evcode,y_title,y_width,y_height)}else{const evErrMsg="ERR: JS-Eval Failed on DialogConfirm";if(dialogType==="alertable"){$.alertable.confirm((y_title?'<div style="'+_Utils$.escape_html(cssAlertable)+'">'+y_title+"</div>":"")+y_question,{html:true,width:y_width&&y_width>=275&&y_width<=960?y_width:550,height:y_height&&y_height>=100&&y_height<=720?y_height:270}).then(()=>{_Utils$.evalJsFxCode(_N$+"."+_m$+" (1)",evcode)})}else{y_title=stripTags(y_title);y_question=stripTags(y_question);let the_confirmation=confirm(y_title+"\n"+y_question);if(the_confirmation){_Utils$.evalJsFxCode(_N$+"."+_m$+" (2)",evcode)}}}};_C$.ConfirmDialog=ConfirmDialog;const MessageNotification=function(ytitle,ymessage,yredirect,growl,class_growl,timeout){yredirect=_Utils$.stringPureVal(yredirect,true);growl=_Utils$.stringPureVal(growl,true);timeout=_Utils$.format_number_int(timeout,false);if(growl==="yes"){let redirectAfterClose=null;if(yredirect!=undefined&&yredirect!=""){RedirectDelayedToURL(yredirect,timeout+750);redirectAfterClose=()=>{RedirectDelayedToURL(String(yredirect),250)}}const growlOptions={before_close:redirectAfterClose};GrowlNotificationAdd(ytitle,ymessage,"",timeout,false,class_growl,growlOptions)}else{let fx=null;if(yredirect!=undefined&&yredirect!=""){fx=()=>{RedirectDelayedToURL(yredirect,100)}}AlertDialog(ymessage,fx,ytitle,550,275)}};_C$.MessageNotification=MessageNotification;const confirmSubmitForm=function(y_confirm,y_form,y_target,windowWidth=0,windowHeight=0,forcePopUp=0,forceDims=0){y_confirm=_Utils$.stringPureVal(y_confirm,true);if(y_form==undefined||y_form==""){_p$.error(_N$,"confirmSubmitForm","ERR: Form Object is undefined");return}let submit_fx=()=>{y_form.submit()};y_target=_Utils$.stringPureVal(y_target,true);if(y_target!=""){submit_fx=()=>{PopUpSendForm(y_form,String(y_target),_Utils$.format_number_int(windowWidth,false),_Utils$.format_number_int(windowHeight,false),_Utils$.format_number_int(forcePopUp,false),_Utils$.format_number_int(forceDims,false))}}ConfirmDialog(y_confirm,submit_fx)};_C$.confirmSubmitForm=confirmSubmitForm;const PopUpSendForm=function(objForm,strTarget,windowWidth=0,windowHeight=0,forcePopUp=0,forceDims=0,evcode=null){const _m$="PopUpSendForm";strTarget=_Utils$.stringPureVal(strTarget,true);let strUrl="";try{strUrl=String(objForm.action||"")}catch(err){_p$.error(_N$,_m$,"ERR: Invalid Form Object");return}let crr_protocol=String(document.location.protocol);let crr_arr_url=strUrl.split(":");let crr_url=String(crr_arr_url[0])+":";if((crr_protocol==="http:"||crr_protocol==="https:")&&(crr_url==="http:"||crr_url==="https:")&&crr_url!==crr_protocol){forcePopUp=1}objForm.target=strTarget;if((allowModalCascading()&&forcePopUp!=1||forcePopUp==-1)&&allowModalBox()){if(typeof smartJ$ModalBox!="undefined"){objForm.target=smartJ$ModalBox.getName()}}initModalOrPopUp(_C$.param_LoaderBlank,objForm.target,windowWidth,windowHeight,forcePopUp,forceDims);let fx=()=>{objForm.submit()};if(evcode!=undefined&&evcode!=""&&evcode!="undefined"){fx=()=>{objForm.submit();try{if(typeof evcode==="function"){evcode(objForm,strTarget,forcePopUp,forceDims)}else{eval(evcode)}}catch(err){_p$.error(_N$,_m$,"ERR: Form After-Submit JS Code Failed:",err)}}}setTimeout(fx,_C$.param_TimeDelayCloseWnd+500);return false};_C$.PopUpSendForm=PopUpSendForm;const PopUpLink=function(strUrl,strTarget,windowWidth=0,windowHeight=0,forcePopUp=0,forceDims=0){strUrl=_Utils$.stringPureVal(strUrl,true);if(strUrl==""){return}strUrl=String(strUrl||"");strTarget=_Utils$.stringPureVal(strTarget,true);const crr_protocol=String(document.location.protocol);const crr_arr_url=strUrl.split(":");const crr_url=crr_arr_url[0]+":";if((crr_protocol==="http:"||crr_protocol==="https:")&&(crr_url==="http:"||crr_url==="https:")&&crr_url!==crr_protocol){forcePopUp=1}initModalOrPopUp(strUrl,strTarget,windowWidth,windowHeight,forcePopUp,forceDims);return false};_C$.PopUpLink=PopUpLink;const getCookie=function(name){name=_Utils$.stringPureVal(name,true);if(name==""||!regexValidCookieName.test(name)){return null}let c;try{c=document.cookie.match(new RegExp("(^|;)\\s*"+_Utils$.preg_quote(String(name))+"=([^;\\s]*)"))}catch(err){c=[];_p$.error(_N$,"ERR: getCookie("+name+") Failed:",err)}if(c&&c.length>=3){const d=decodeURIComponent(c[2]||"")||"";return String(d)}return""};_C$.getCookie=getCookie;const setCookie=function(name,value,expire=0,path="/",domain="@",samesite="@",secure=false){name=_Utils$.stringPureVal(name,true);if(name==""||!regexValidCookieName.test(name)){_p$.warn(_N$,"WARN: setCookie: Invalid Cookie Name:",name);return false}value=_Utils$.stringPureVal(value,true);let d=new Date;if(expire===null){expire=_C$.param_CookieLifeTime}expire=_Utils$.format_number_int(expire);if(expire){if(expire>0){d.setTime(d.getTime()+expire*1e3)}else if(expire<0){d.setTime(d.getTime()-3600*24-expire);value=null}else{expire=0}}else{expire=0}if(!value){value=null;expire=-1}path=_Utils$.stringPureVal(path,true);path=String(path||"/");domain=_Utils$.stringPureVal(domain,true);if(domain==="@"){domain=String(_C$.param_CookieDomain)}samesite=_Utils$.stringPureVal(samesite,true);if(samesite==="@"){samesite=String(_C$.param_CookieSameSitePolicy)}samesite=String(samesite).toLowerCase();switch(samesite){case"none":samesite="None";secure=true;break;case"lax":samesite="Lax";break;case"strict":samesite="Strict";break;default:samesite=""}try{document.cookie=_Utils$.escape_url(name)+"="+_Utils$.escape_url(value)+(expire?"; expires="+d.toGMTString():"")+"; path="+path+(domain?"; domain="+domain:"")+(samesite?"; SameSite="+samesite:"")+(secure?"; secure":"");return true}catch(err){_p$.warn(_N$,"WARN: Failed to setCookie:",err);return false}};_C$.setCookie=setCookie;const deleteCookie=(name,path="/",domain="@",samesite="@",secure=false)=>setCookie(name,null,-1,path,domain,samesite,secure);_C$.deleteCookie=deleteCookie;const TextAreaAddLimit=function(elemID,maxChars){elemID=_Utils$.stringPureVal(elemID);if(elemID==""){_p$.error(_N$,"TextAreaAddLimit","Empty Element ID");return}maxChars=_Utils$.format_number_int(maxChars,false);if(maxChars<1){_p$.warn(_N$,"ERR: TextArea Add Limit: Invalid Limit, will reset to 1");maxChars=1}$("#"+elemID).on("change click blur keydown keyup paste",evt=>{const field=$(evt.currentTarget);if(field.val().length>maxChars){field.val(field.val().substring(0,maxChars))}field.attr("title","# Max: "+maxChars+" ; Chars: "+(maxChars-field.val().length)+" #")}).attr("title","# Max: "+maxChars+" #").attr("maxlength",maxChars)};_C$.TextAreaAddLimit=TextAreaAddLimit;const catchKeyENTER=function(evt){if(!evt){return true}let key=null;if(evt.key){key=evt.key}else if(evt.which){key=evt.which}else if(evt.keyCode){key=evt.keyCode}if(key==="Enter"||key==13){evt.preventDefault();return false}return true};_C$.catchKeyENTER=catchKeyENTER;const catchKeyTAB=function(evt){if(!evt){return}let key=null;if(evt.key){key=evt.key}else if(evt.which){key=evt.which}else if(evt.keyCode){key=evt.keyCode}if(key==="Tab"||key==9){evt.preventDefault();const tab="\t";const t=evt.target;const ss=t.selectionStart;const se=t.selectionEnd;const scrollTop=t.scrollTop;const scrollLeft=t.scrollLeft;if(ss!=se&&t.value.slice(ss,se).indexOf("\n")!=-1){const pre=t.value.slice(0,ss);const sel=t.value.slice(ss,se).replace(/\n/g,"\n"+tab);const post=t.value.slice(se,t.value.length);t.value=pre.concat(tab).concat(sel).concat(post);t.selectionStart=ss+tab.length;t.selectionEnd=se+tab.length}else{t.value=t.value.slice(0,ss).concat(tab).concat(t.value.slice(ss,t.value.length));if(ss==se){t.selectionStart=t.selectionEnd=ss+tab.length}else{t.selectionStart=ss+tab.length;t.selectionEnd=se+tab.length}}t.scrollTop=scrollTop;t.scrollLeft=scrollLeft}};_C$.catchKeyTAB=catchKeyTAB;const CheckAllCheckBoxes=function(y_form_name,y_element_id,y_element_checked){let selector="body";if(y_form_name){selector='form[name="'+_Utils$.escape_html(y_form_name)+'"]'}selector+=' input[type="checkbox"]';let checked=!y_element_checked;$(selector).each((i,el)=>{const $el=$(el);checked?$el.prop("checked",false):$el.prop("checked",true)});return false};_C$.CheckAllCheckBoxes=CheckAllCheckBoxes;const CloneElement=function(elID,containerID,elType,maxLimit){const _m$="CloneElement";elID=_Utils$.stringPureVal(elID,true);elID=_Utils$.create_htmid(elID);if(elID==""){_p$.error(_N$,_m$,"ERR: Invalid elID");return}containerID=_Utils$.stringPureVal(containerID,true);containerID=_Utils$.create_htmid(containerID);if(containerID==""){_p$.error(_N$,_m$,"ERR: Invalid containerID");return}maxLimit=_Utils$.format_number_int(maxLimit,false);if(maxLimit<1){maxLimit=1}else if(maxLimit>255){maxLimit=255}const $el=$("#"+elID);const control_num=_Utils$.format_number_int(parseInt($("body").find("[id^="+"clone_control__"+elID+"]").length),false);if(control_num<=0){$el.before('<img id="'+"clone_control__"+_Utils$.escape_html(elID)+'" alt="AddNew" title="Add New (Max: '+_Utils$.escape_html(maxLimit)+')" height="16" src="'+_Utils$.escape_html(_C$.param_ImgCloneInsert)+'" style="cursor:pointer; vertical-align:middle;" onClick="smartJ$Browser.CloneElement(\''+_Utils$.escape_js(elID)+"', '"+_Utils$.escape_js(containerID)+"', '"+_Utils$.escape_js(elType)+"', "+_Utils$.format_number_int(maxLimit)+");"+'">&nbsp;&nbsp;</span>');return}let cloned_num=_Utils$.format_number_int(_Utils$.format_number_int($("body").find("[id^="+"clone_of__"+elID+"_"+"]").length),false);if(cloned_num<=0){cloned_num=0}if(cloned_num>=maxLimit-1){return}const date=new Date;const seconds=date.getTime();const milliseconds=date.getMilliseconds();const randNum=Math.random().toString(36);const uuID=_Crypto$Hash.sha1("The UUID for #"+cloned_num+" @ "+randNum+" :: "+seconds+"."+milliseconds);const $clone=$el.clone().attr("id","clone_of__"+elID+"_"+_Utils$.create_htmid(uuID));$("#"+containerID).append('<div class="cloned__'+_Utils$.escape_html(elID)+'" id="'+"clone_container__"+_Utils$.escape_html(elID)+"_"+_Utils$.escape_html(uuID)+'"><img alt="Remove" title="Remove" height="16" src="'+_Utils$.escape_html(_C$.param_ImgCloneRemove)+'" style="cursor:pointer; vertical-align:middle;" onClick="jQuery(this).parent().remove();">&nbsp;&nbsp;</div>');switch(String(elType)){case"text-input":case"text-area":case"file-input":$clone.val("").appendTo("#"+"clone_container__"+elID+"_"+_Utils$.create_htmid(uuID));break;case"html-element":default:$clone.appendTo("#"+"clone_container__"+elID+"_"+_Utils$.create_htmid(uuID))}};_C$.CloneElement=CloneElement;const SubmitFormByAjax=function(the_form_id,url,growl="auto",evcode=null,everrcode=null,evfailcode=null,failalertable=false){const _m$="SubmitFormByAjax";growl=_Utils$.stringPureVal(growl,true);if(growl==""){growl="auto"}else if(growl!="no"){growl="yes"}let dlg="auto";if(failalertable===true){if($.alertable){dlg="alertable"}}let haveGrowl=false;switch(growl){case"no":break;case"yes":if(GrowlSelectType()!=""){haveGrowl=true}else{_p$.warn(_N$,_m$,"WARN: Growl is required but is N/A")}break;case"auto":default:if(GrowlSelectType()!=""){haveGrowl=true}}let ajax=null;if(!the_form_id){ajax=AjaxRequestFromURL(url,"get","json")}else{ajax=AjaxRequestByForm(the_form_id,url,"json")}if(ajax===null){_p$.error(_N$,_m$,"ERR: Null XHR Object on FormID:",the_form_id);AlertDialog("<h3>FAIL: The XHR Object is NULL !</h3>",null,"ERROR",null,null,dlg);return}OverlayShow();ajax.done(msg=>{OverlayClear();if(typeof msg=="object"&&msg.hasOwnProperty("completed")&&msg.completed=="DONE"&&msg.hasOwnProperty("status")&&(msg.status=="OK"||msg.status=="ERROR")&&msg.hasOwnProperty("action")&&msg.action!=null&&msg.hasOwnProperty("title")&&msg.title!=null&&msg.hasOwnProperty("message")&&msg.message!=null&&msg.hasOwnProperty("js_evcode")&&msg.hasOwnProperty("redirect")&&msg.hasOwnProperty("replace_div")&&msg.hasOwnProperty("replace_html")){if(msg.status=="OK"){_Utils$.evalJsFxCode(_N$+"."+_m$+" (1.1)",typeof evcode==="function"?()=>{"use strict";evcode(the_form_id,url,msg)}:()=>{"use strict";!!evcode?eval(evcode):null});_Utils$.evalJsFxCode(_N$+"."+_m$+" (1.2)",typeof msg.js_evcode==="function"?()=>{"use strict";msg.js_evcode(the_form_id,url,msg)}:()=>{"use strict";!!msg.js_evcode?eval(msg.js_evcode):null});if(msg.hasOwnProperty("hide_form_on_success")&&!!msg.hide_form_on_success){if(!!the_form_id){$("form#"+the_form_id).hide()}}if(msg.redirect!=null&&msg.redirect!=""&&msg.message==""){RedirectDelayedToURL(msg.redirect,250)}else{if(msg.replace_div!=null&&msg.replace_div!=""&&msg.replace_html!=null&&msg.replace_html!=""){$("#"+msg.replace_div).empty().html(String(msg.replace_html))}if(msg.message!=""){MessageNotification(_Utils$.escape_html(String(msg.title)),'<img alt="ok" title="'+_Utils$.escape_html(msg.action)+'" src="'+_Utils$.escape_html(_C$.param_ImgOK)+'" align="right">'+msg.message,msg.redirect,haveGrowl===true?"yes":"no",haveGrowl===true?"green":"",_C$.param_NotificationTimeOK)}setTimeout(()=>{OverlayHide()},_C$.param_NotificationTimeOK+100)}}else{_Utils$.evalJsFxCode(_N$+"."+_m$+" (2.1)",typeof everrcode==="function"?()=>{"use strict";everrcode(the_form_id,url,msg)}:()=>{"use strict";!!everrcode?eval(everrcode):null});_Utils$.evalJsFxCode(_N$+"."+_m$+" (2.2)",typeof msg.js_evcode==="function"?()=>{"use strict";msg.js_evcode(the_form_id,url,msg)}:()=>{"use strict";!!msg.js_evcode?eval(msg.js_evcode):null});MessageNotification("* "+_Utils$.escape_html(msg.title),'<img alt="fail" title="'+_Utils$.escape_html(msg.action)+'" src="'+_Utils$.escape_html(_C$.param_ImgNotOK)+'" align="right">'+msg.message,msg.redirect,haveGrowl===true?"yes":"no",haveGrowl===true?"red":"",_C$.param_NotificationTimeERR);setTimeout(()=>{OverlayHide()},_C$.param_NotificationTimeERR+100)}}else{_p$.warn(_N$,_m$,"WARN: Invalid Data Object Format");MessageNotification("* ERR",'<img alt="fail" src="'+_Utils$.escape_html(_C$.param_ImgNotOK)+'" align="right">'+"Invalid Form Submit Response: Unexpected Data Object Format",null,haveGrowl===true?"yes":"no",haveGrowl===true?"pink":"",_C$.param_NotificationTimeERR);setTimeout(()=>{OverlayHide()},_C$.param_NotificationTimeERR+500);_Utils$.evalJsFxCode(_N$+"."+_m$+" (3)",typeof evfailcode==="function"?()=>{"use strict";evfailcode(the_form_id,url,msg)}:()=>{"use strict";!!evfailcode?eval(evfailcode):null})}}).fail(msg=>{OverlayClear();AlertDialog("<h4>HTTP&nbsp;Status: "+_Utils$.escape_html(msg.status)+_Utils$.escape_html(HTTP_STATUS_CODES[String(msg.status)]?" "+HTTP_STATUS_CODES[String(msg.status)]:"Unknown")+"</h4><br>"+"\n"+"<h5>XHR Server Response NOT Validated ...</h5>"+(msg.status==401?"<h6>If the auth credentials are valid and still getting this message do a full page refresh in the browser and try again, it could be a re-auth issue !</h6>":""),typeof evfailcode==="function"?()=>{"use strict";evfailcode(the_form_id,url,msg)}:()=>{"use strict";!!evfailcode?eval(evfailcode):null},"FAIL",null,null,dlg);setTimeout(()=>{OverlayHide()},_C$.param_NotificationTimeERR+1e3)})};_C$.SubmitFormByAjax=SubmitFormByAjax;const AjaxRequestByForm=function(the_form_id,url,data_type){const _m$="AjaxRequestByForm";the_form_id=_Utils$.stringPureVal(the_form_id,true);url=_Utils$.stringPureVal(url,true);let $form=null;let ajax=null;let data="";if(the_form_id!=""){$form=$("form#"+the_form_id);if(typeof $form.get(0)=="undefined"){_p$.error(_N$,_m$,"ERR: Form ["+the_form_id+"] was not found");return null}if(url==""){url=_Utils$.stringPureVal($form.attr("action"),true)}}if(url==""||url=="#"){_p$.error(_N$,_m$,"ERR: Invalid or Empty URL");return null}if(the_form_id==""){ajax=AjaxRequestFromURL(url,"GET",data_type,"")}else{const fMethod=_Utils$.stringPureVal($form.attr("method"),true);const fEncType=_Utils$.stringPureVal($form.attr("enctype"),true);let isMultipart=false;if(fMethod.toLowerCase()=="post"&&fEncType.toLowerCase()=="multipart/form-data"){let haveFiles=$form.find("input:file");if(typeof haveFiles!="undefined"){if(typeof haveFiles.get(0)!="undefined"){isMultipart=true}}}if(isMultipart!==true){data=$form.serialize();ajax=AjaxRequestFromURL(url,"POST",data_type,data)}else{try{data=new FormData($form.get(0));ajax=AjaxPostMultiPartToURL(url,data_type,data)}catch(err){data=$form.serialize();ajax=AjaxRequestFromURL(url,"POST",data_type,data);const warnMsg="ERR: "+_m$+" FormData Object Failed. File Attachments were NOT sent ! Try to upgrade / change your browser. It may not support HTML5 File Uploads.";_p$.error(_N$,warnMsg," # Form:",the_form_id);AlertDialog(_Utils$.escape_html(warnMsg),null,"Form: "+the_form_id)}}}return ajax};_C$.AjaxRequestByForm=AjaxRequestByForm;const AjaxPostMultiPartToURL=function(y_url,y_data_type,y_data_formData,y_withCredentials=false){const _m$="AjaxPostMultiPartToURL";y_url=_Utils$.stringPureVal(y_url,true);if(y_url==""||y_url=="#"){_p$.error(_N$,_m$,"ERR: Empty URL");return null}y_data_type=getValidjQueryAjaxType(y_data_type);let ajxOpts={async:true,type:"POST",url:String(y_url),contentType:false,processData:false,data:y_data_formData,dataType:String(y_data_type)};if(y_withCredentials===true){ajxOpts.xhrFields={withCredentials:true}}return $.ajax(ajxOpts)};_C$.AjaxPostMultiPartToURL=AjaxPostMultiPartToURL;const AjaxRequestFromURL=function(y_url,y_method,y_data_type,y_data_arr_or_serialized,y_AuthUser=null,y_AuthPass=null,y_Headers=null,y_withCredentials=false){const _m$="AjaxRequestFromURL";y_url=_Utils$.stringPureVal(y_url,true);if(y_url==""){_p$.error(_N$,_m$,"ERR: Empty URL");return null}y_method=_Utils$.stringPureVal(y_method,true).toUpperCase();switch(y_method){case"OPTIONS":case"DELETE":case"PUT":case"HEAD":case"POST":case"GET":break;default:y_method="GET"}y_data_type=getValidjQueryAjaxType(y_data_type);if(typeof y_data_arr_or_serialized!="object"){y_data_arr_or_serialized=_Utils$.stringPureVal(y_data_arr_or_serialized)}let the_headers={};if(typeof y_Headers=="object"){the_headers=y_Headers}let the_user="";let the_pass="";y_AuthUser=_Utils$.stringPureVal(y_AuthUser,true);y_AuthPass=_Utils$.stringPureVal(y_AuthPass);if(y_AuthUser&&y_AuthPass){the_user=String(y_AuthUser);the_pass=String(y_AuthPass)}let ajxOpts={async:true,type:String(y_method),url:String(y_url),headers:the_headers,username:String(the_user),password:String(the_pass),data:y_data_arr_or_serialized,dataType:String(y_data_type)};if(y_withCredentials===true){ajxOpts.xhrFields={withCredentials:true}}return $.ajax(ajxOpts)};_C$.AjaxRequestFromURL=AjaxRequestFromURL;const LoadElementContentByAjax=function(y_elemID,y_img_loader,y_url,y_method,y_data_type,y_data_arr_or_serialized,y_replace=false,y_notifyerr=null){const _m$="LoadElementContentByAjax";y_elemID=_Utils$.stringPureVal(y_elemID,true);y_elemID=_Utils$.create_htmid(y_elemID);if(y_elemID==""){_p$.error(_N$,_m$,"ERR: Empty Element ID");return}if(y_img_loader===true){y_img_loader=_C$.param_LoaderImg}y_img_loader=_Utils$.stringPureVal(y_img_loader,true);if(y_img_loader!=""){if($("#"+y_elemID+"__"+_Utils$.create_htmid(_m$)).length==0){$("#"+y_elemID).prepend('<span id="'+_Utils$.escape_html(y_elemID)+"__"+_Utils$.create_htmid(_m$)+'"><img src="'+_Utils$.escape_html(y_img_loader)+'" title="Loading ..." alt="Loading ..."></span><br>')}}let ajax=AjaxRequestFromURL(y_url,y_method,y_data_type,y_data_arr_or_serialized);ajax.done(msg=>{let divContent="";if(y_data_type==="json"){if(msg.hasOwnProperty("div_content_html")){divContent=String(msg.div_content_html)}}else{divContent=String(msg)}if(y_replace===true){$("#"+y_elemID).replaceWith(divContent)}else{$("#"+y_elemID).empty().html(divContent)}}).fail(msg=>{let notifyErr=!!_C$.param_NotifyLoadError;if(y_notifyerr===true||y_notifyerr===false){notifyErr=!!y_notifyerr}const errDetails="ElementID: "+y_elemID+" ; "+"URL: "+y_url+" ; "+"Method: "+y_method+" ; "+"DataType: "+y_data_type;if(notifyErr===true){GrowlNotificationAdd("HTTP&nbsp;Status: "+_Utils$.escape_html(msg.status)+_Utils$.escape_html(HTTP_STATUS_CODES[String(msg.status)]?" "+HTTP_STATUS_CODES[String(msg.status)]:"Unknown"),"FAIL: Invalid Server Response for: "+_Utils$.escape_html(_m$)+"<br>"+"<b><i>Details:</i></b><br>"+_Utils$.nl2br(_Utils$.escape_html(_Utils$.stringReplaceAll(" ; ","\n",errDetails))),_C$.param_ImgNotOK,0,true,"dark")}else{_p$.error(_N$,_m$,"ERR: Invalid Server Response","HTTP Status Code:",msg.status,";",errDetails)}$("#"+y_elemID).empty().html("")})};_C$.LoadElementContentByAjax=LoadElementContentByAjax;const windwScrollDown=function(wnd,offset){let scrollY=_Utils$.format_number_int(parseInt(offset));if(scrollY<0){scrollY=_Utils$.format_number_int(parseInt($(document).height()));if(scrollY<0){scrollY=0}}try{wnd.scrollBy(0,scrollY)}catch(err){}};_C$.windwScrollDown=windwScrollDown;const WayPoint=function(elSelector,evcode){const _m$="WayPoint";elSelector=_Utils$.stringPureVal(elSelector,true);if(elSelector==""||elSelector=="."||elSelector=="#"){_p$.error(_N$,_m$,"ERR: invalid selector:",elSelector);return}if(typeof evcode!=="function"){evcode=_Utils$.stringPureVal(evcode);if(_Utils$.stringTrim(evcode)==""){_p$.error(_N$,_m$,"ERR: empty evcode");return}}let scrollTrigger=true;const $w=$(window);$(window).scroll(()=>{if(!scrollTrigger){return}const $e=$(String(elSelector));if(!$e.length||$e.is(":hidden")){return false}const wt=$w.scrollTop(),wb=wt+$w.height(),et=$e.offset().top,eb=et+$e.height(),th=0;const shouldLoad=eb>=wt-th&&et<=wb+th;if(shouldLoad){scrollTrigger=false;_Utils$.evalJsFxCode(_N$+"."+_m$,typeof evcode==="function"?()=>{"use strict";evcode($e,elSelector)}:()=>{"use strict";!!evcode?eval(evcode):null})}})};_C$.WayPoint=WayPoint;const VirtualFileDownload=function(data,fileName,mimeType,charset=null,binary=false){const _m$="VirtualFileDownload";data=_Utils$.stringPureVal(data);fileName=_Utils$.stringPureVal(fileName,true);if(!fileName){fileName="file.none"}mimeType=_Utils$.stringPureVal(mimeType,true);if(!mimeType){mimeType="application/octet-stream"}if(charset===null){charset=String(_C$.param_Charset)}charset=_Utils$.stringPureVal(charset,true);if(binary===true){charset=""}else{binary=false;if(charset==""){charset="UTF-8"}}let link=null;try{link=document.createElement("a");if(link){link.href=String("data:"+String(mimeType)+(charset?";charset="+charset:"")+";base64,"+_Ba$e64.encode(data,binary));link.target="_blank";link.setAttribute("download",String(fileName));document.body.appendChild(link);link.style="display:none";link.click()}}catch(err){link=false;_p$.error(_N$,_m$,"ERR: Create Failed:",err)}if(link){setTimeout(()=>{try{document.body.removeChild(link)}catch(e){_p$.warn(_N$,_m$,"WARN: Remove Failed:",e)}},250)}};_C$.VirtualFileDownload=VirtualFileDownload;const VirtualImageUploadHandler=function(inputUpldFileId,previewPlaceholderId,imgQuality,imgMaxResizeMBSize,imgMaxResizeW,imgMaxResizeH,fxDone,clearPreview,widthPreview,heightPreview,preserveGifs){const _m$="VirtualImageUploadHandler";const txtWarn="Image Uploader WARNING: ";inputUpldFileId=_Utils$.stringPureVal(inputUpldFileId,true);inputUpldFileId=_Utils$.create_htmid(inputUpldFileId);if(inputUpldFileId==""){_p$.error(_N$,_m$,"ERR:","Invalid uploadInput ID");return}previewPlaceholderId=_Utils$.stringPureVal(previewPlaceholderId,true);previewPlaceholderId=_Utils$.create_htmid(previewPlaceholderId);if(previewPlaceholderId==""){_p$.error(_N$,_m$,"ERR:","Invalid uploadPreview ID");return}if(!imgQuality){imgQuality=.85}imgQuality=_Utils$.format_number_float(imgQuality);if(imgQuality<.1){imgQuality=.1}else if(imgQuality>1){imgQuality=1}if(!imgMaxResizeMBSize){imgMaxResizeMBSize=.1}imgMaxResizeMBSize=_Utils$.format_number_float(imgMaxResizeMBSize);if(imgMaxResizeMBSize<.01){imgMaxResizeMBSize=.01}else if(imgMaxResizeMBSize>2){imgMaxResizeMBSize=2}imgMaxResizeW=_Utils$.format_number_int(imgMaxResizeW);if(imgMaxResizeW<=0){imgMaxResizeW=800}imgMaxResizeH=_Utils$.format_number_int(imgMaxResizeH);if(imgMaxResizeH<=0){imgMaxResizeH=600}if(clearPreview!==false){clearPreview=true}widthPreview=_Utils$.format_number_int(widthPreview);if(widthPreview<=0){widthPreview=imgMaxResizeW}heightPreview=_Utils$.format_number_int(heightPreview);if(heightPreview<=0){heightPreview=heightPreview}if(preserveGifs!==true){preserveGifs=false}if(typeof fxDone!="function"){fxDone=null}const $upldr=$("#"+inputUpldFileId);const $imgpw=$("#"+previewPlaceholderId);$upldr.on("change",()=>{const the_file=$upldr[0].files[0];if(!the_file){$upldr.val("");_p$.error(_N$,_m$,"ERR:","Invalid File Uploader");return}let the_name_of_file=String(the_file.name||"");let the_type_of_file=String(the_file.type||"").toLowerCase();let the_size_of_file=_Utils$.format_number_int(the_file.size,false);const the_filter=/^(image\/svg\+xml|image\/webp|image\/jpeg|image\/png|image\/gif)$/i;if(!the_filter.test(the_type_of_file)){$upldr.val("");$imgpw.text(txtWarn+"Invalid File Type - Only SVG / JPEG / WEBP / PNG or GIF Images are allowed): "+the_type_of_file);return}if(the_size_of_file<43){$upldr.val("");$imgpw.text(txtWarn+"Invalid File Size - Image size is empty or too small");return}else if(the_size_of_file>1024*1024*32){$upldr.val("");$imgpw.text(txtWarn+"Invalid File Size - Image is larger than 32MB");return}const imgRemoveBtn='<div title="Remove the Image" style="width:20px; height:20px; line-height:20px; font-size:15px; font-weight:bold; color:#111111; cursor:pointer;" onClick="jQuery(\'#'+_Utils$.escape_js(inputUpldFileId)+"').val(''); jQuery('#"+_Utils$.escape_js(previewPlaceholderId)+"').html('');\">&times;</div>";$imgpw.html(imgRemoveBtn);try{const the_frd=new FileReader;the_frd.onloadend=()=>{$imgpw.append('<img id="uxm-img-uploader-result-img" src="'+_Utils$.escape_html(the_frd.result)+'" style="max-width:'+_Utils$.escape_html(imgMaxResizeW)+"px; max-height:"+_Utils$.escape_html(imgMaxResizeH)+'px; width:auto !important; height:auto !important;">');setTimeout(()=>{const isSVG=String(the_type_of_file).toLowerCase()==="image/svg+xml"?true:false;const img=$("#uxm-img-uploader-result-img");let isOK=false;let w=Math.round(img.width())||1;let h=Math.round(img.height())||1;let isPreservedGif=false;if(preserveGifs===true){if(the_type_of_file==="image/gif"){isPreservedGif=true}}if(isSVG||isPreservedGif){if(String(the_frd.result).length<=1024*1024*imgMaxResizeMBSize){isOK=true;if(typeof fxDone=="function"){try{fxDone(String(the_frd.result),w,h,isSVG,String(the_type_of_file),String(the_frd.result).length,String(the_name_of_file))}catch(e){$upldr.val("");_p$.error(_N$,_m$,"ERR:","SVG CallBack Failed:",e);return}}}else{$upldr.val("");$imgpw.text(txtWarn+"Size is higher than allowed size: "+String(the_frd.result).length+" Bytes")}if(isOK){$imgpw.empty().html("");if(!clearPreview){$imgpw.html(String(imgRemoveBtn)+"\n"+'<img id="uxm-img-uploader-result-img" src="'+_Utils$.escape_html(the_frd.result)+'" style="max-width:'+_Utils$.escape_html(widthPreview)+"px; max-height:"+_Utils$.escape_html(heightPreview)+'px; width:auto !important; height:auto !important;">')}}}else{$("#uxm-img-uploader-result-img").remove();$imgpw.append('<canvas id="uxm-img-uploader-result-cnvs" width="'+_Utils$.escape_html(w)+'" height="'+_Utils$.escape_html(h)+'" style="border: 1px dotted #ECECEC;"></canvas>');const im=new Image;im.width=w;im.height=h;im.onload=()=>{const cnv=$("#uxm-img-uploader-result-cnvs")[0];if(!cnv){$upldr.val("");_p$.error(_N$,_m$,"ERR:","Failed to Get Resizable Container");return}const ctx=cnv.getContext("2d");if(!ctx){$upldr.val("");_p$.error(_N$,_m$,"ERR:","Failed to Get Resizable Container Context");return}try{ctx.drawImage(im,0,0,w,h)}catch(imgerr){$upldr.val("");_p$.error(_N$,_m$,"ERR:","Failed to Draw Canvas Image:",imgerr);return}const imgResizedB64=cnv.toDataURL(String(the_type_of_file),imgQuality);if(String(imgResizedB64).length<=1024*1024*imgMaxResizeMBSize){isOK=true;if(typeof fxDone=="function"){try{fxDone(String(imgResizedB64),w,h,false,String(the_type_of_file),String(imgResizedB64).length,String(the_name_of_file))}catch(e){$upldr.val("");_p$.error(_N$,_m$,"ERR:","IMG CallBack Failed:",e);return}}if(isOK){$imgpw.empty().html("");if(!clearPreview){$imgpw.html(String(imgRemoveBtn)+"\n"+'<img id="uxm-img-uploader-result-img" src="'+_Utils$.escape_html(imgResizedB64)+'" style="max-width:'+_Utils$.escape_html(widthPreview)+"px; max-height:"+_Utils$.escape_html(heightPreview)+'px; width:auto !important; height:auto !important;">')}}}else{$upldr.val("");$imgpw.text(txtWarn+"Image Size after resize is higher than allowed size: "+String(imgResizedB64).length+" Bytes");return}};im.src=String(the_frd.result)}},500)};try{the_frd.readAsDataURL(the_file)}catch(fail){$upldr.val("");_p$.error(_N$,_m$,"ERR: Failed to Read Data URL:",fail);return}}catch(err){$upldr.val("");_p$.error(_N$,_m$,"ERR:",err);return}})};_C$.VirtualImageUploadHandler=VirtualImageUploadHandler;const allowModalBox=function(){let isActive=false;if(_C$.param_ModalBoxActive==1&&!_Te$tBrowser.checkIsMobileDevice()){isActive=!!_C$.param_ModalBoxActive}else if(_C$.param_ModalBoxActive>1){isActive=!!_C$.param_ModalBoxActive}return!!isActive};const allowModalCascading=function(){const _m$="allowModalCascading";let cascadeModal=true;if(!!_C$.param_ModalBoxNoCascade){cascadeModal=false}try{if(typeof smartJ$ModalBox!="undefined"){if(self.name){if(self.name==smartJ$ModalBox.getName()){return cascadeModal}}}}catch(err){_p$.error(_N$,_m$,"ERR: Failed for Self:",err)}try{if(typeof parent.smartJ$ModalBox!="undefined"){if(parent.name){if(parent.name==parent.smartJ$ModalBox.getName()){return cascadeModal}}}}catch(err){_p$.error(_N$,_m$,"ERR: Failed for Parent:",err)}return true};const OverlayValidID=overlay_id=>{overlay_id=_Utils$.stringPureVal(overlay_id,true);overlay_id=_Utils$.create_htmid(overlay_id);if(overlay_id==""){overlay_id=String(sfOverlayID)}return String(overlay_id)};const DialogSelectType=()=>{switch(_C$.param_NotificationDialogType){case"ui":if(typeof smartJ$UI!="undefined"){return"ui"}break;case"dialog":if(typeof SmartSimpleDialog!="undefined"){return"dialog"}break;case"alertable":if($.alertable){return"alertable"}break;case"auto":if(typeof smartJ$UI!="undefined"){return"ui"}else if(typeof SmartSimpleDialog!="undefined"){return"dialog"}else if($.alertable){return"alertable"}break}return"native"};const GrowlSelectType=()=>{if(_C$.param_Notifications!=="growl"){return""}switch(_C$.param_NotificationGrowlType){case"gritter":if(typeof $.gritter!="undefined"){return"gritter"}break;case"toastr":if(typeof $.toastr!="undefined"){return"toastr"}break;case"auto":if(typeof $.gritter!="undefined"){return"gritter"}else if(typeof $.toastr!="undefined"){return"toastr"}break}return""};const getValidjQueryAjaxType=y_data_type=>{y_data_type=_Utils$.stringPureVal(y_data_type,true);switch(y_data_type){case"json":case"jsonp":case"script":case"html":case"xml":case"text":break;default:y_data_type="text"}return String(y_data_type)};const initModalOrPopUp=function(strUrl,strTarget,windowWidth,windowHeight,forcePopUp,forceDims){const _m$="initModalOrPopUp";strUrl=_Utils$.stringPureVal(strUrl);strTarget=_Utils$.stringPureVal(strTarget);windowWidth=_Utils$.format_number_int(parseInt(windowWidth),false);windowHeight=_Utils$.format_number_int(parseInt(windowHeight),false);if((typeof smartJ$ModalBox!="undefined"&&allowModalCascading()&&forcePopUp!=1||forcePopUp==-1)&&allowModalBox()){smartJ$ModalBox.setRefreshParent(_C$.getFlag("RefreshState"),_C$.getFlag("RefreshURL"));_C$.setFlag("RefreshState",0);_C$.setFlag("RefreshURL","");if(forceDims!=1){smartJ$ModalBox.LoadURL(strUrl,_C$.param_ModalBoxProtected)}else{smartJ$ModalBox.LoadURL(strUrl,_C$.param_ModalBoxProtected,windowWidth,windowHeight)}}else{if(strTarget==""){strTarget=String(defSmartPopupTarget)}let the_screen_width=0;try{the_screen_width=_Utils$.format_number_int(parseInt(screen.width))}catch(e){}if(the_screen_width<=0){the_screen_width=920}let the_screen_height=0;try{the_screen_height=_Utils$.format_number_int(parseInt(screen.height))}catch(e){}if(the_screen_height<=0){the_screen_height=700}let maxW=_Utils$.format_number_int(Math.round(the_screen_width*.9));if(windowWidth>maxW){windowWidth=maxW}let maxH=_Utils$.format_number_int(Math.round(the_screen_height*.8));if(windowHeight>maxH){windowHeight=maxH}if(windowWidth<200||windowHeight<100){windowWidth=maxW;windowHeight=maxH}let windowTop=50;let windowLeft=_Utils$.format_number_int(Math.round(the_screen_width/2-windowWidth/2));if(windowLeft<10){windowLeft=10}if(objRefWinPopup){windowFocus(objRefWinPopup)}try{objRefWinPopup=window.open(String(_C$.param_LoaderBlank),strTarget,"top="+windowTop+",left="+windowLeft+",width="+windowWidth+",height="+windowHeight+",toolbar=0,scrollbars=1,resizable=1")}catch(err){_p$.error(_N$,_m$,"ERROR raising a new PopUp Window:",err)}if(objRefWinPopup){windowFocus(objRefWinPopup);try{setTimeout(()=>{objRefWinPopup.location=strUrl},_C$.param_TimeDelayCloseWnd)}catch(err){_p$.error(_N$,_m$,"ERROR redirecting the PopUp Window to ["+strUrl+"]:",err)}try{const wnd_popup_timer=setInterval(()=>{if(getFlag("PageAway")!==true){let pop=_C$.getRefPopup();if(pop&&pop.closed){clearInterval(wnd_popup_timer);try{if(_C$.getFlag("RefreshState")){if(!_C$.getFlag("RefreshURL")){self.location=self.location}else{self.location=String(_C$.getFlag("RefreshURL"))}_C$.setFlag("RefreshState",0);_C$.setFlag("RefreshURL","")}}catch(err){_p$.warn(_N$,_m$,"WARN: Failed to Set Refresh on Self:",err)}return false}}},250)}catch(err){}}}}}};smartJ$Browser.secureClass();window.smartJ$Browser=smartJ$Browser;
// #END
