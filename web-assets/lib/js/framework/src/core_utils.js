// JS-Script (UM): core_utils.js @ 2023-11-25 11:00:13 +0000
const smartJ$Utils=new class{constructor(){"use strict";const _N$="smartJ$Utils";const _C$=this;const _p$=console;let SECURED=false;_C$.secureClass=()=>{if(SECURED===true){_p$.warn(_N$,"Class is already SECURED")}else{SECURED=true;Object.freeze(_C$)}};const debug=false;const evalJsFxCode=(fxContext,jsCode,alertErr=false)=>{const _m$="evalJsFxCode";if(jsCode!=undefined){const errMsg="Js Code Eval FAILED";const errHint="See the javascript console for more details ...";fxContext=stringPureVal(fxContext);if(typeof jsCode==="function"){try{jsCode()}catch(err){_p$.error(_N$,_m$,"ERR:",errMsg,"Context:",fxContext,"[F]","JS Errors:",err);if(alertErr===true){alert("JS Errors: "+errMsg+" in [F] Context: "+fxContext+"\n"+errHint)}return false}}else{jsCode=stringPureVal(jsCode,true);if(stringIStartsWith(jsCode,"javascript:")){jsCode=jsCode.substring(11);jsCode=stringTrim(jsCode)}if(typeof jsCode==="string"&&jsCode!="undefined"&&jsCode!=""){try{eval("(() => { "+"\n"+" 'use strict';"+"\n"+String(jsCode)+"\n"+" })();")}catch(err){_p$.error(_N$,_m$,"ERR:",errMsg,"Context:",fxContext,"[S]","JS Errors:",err);if(alertErr===true){alert("JS Errors: "+errMsg+" in [S] Context: "+fxContext+"\n"+errHint)}return false}}}}return true};_C$.evalJsFxCode=evalJsFxCode;const isFiniteNumber=e=>!!(typeof e!="number")?false:!!(Number.isFinite(e)&&!Number.isNaN(e));_C$.isFiniteNumber=isFiniteNumber;const stringPureVal=(e,r)=>{if(typeof e=="undefined"||e===undefined||e===null||e===false||typeof e==="object"||typeof e==="function"){e=""}else if(e===true){e="1"}else{e=String(e)}if(r===true){e=stringTrim(e)}return String(e)};_C$.stringPureVal=stringPureVal;const stringTrim=e=>{e=String(e==undefined?"":e);if(e==""){return""}return String(e.replace(/^\s+|\s+$/g,""))};_C$.stringTrim=stringTrim;const stringLeftTrim=e=>{e=String(e==undefined?"":e);if(e==""){return""}return String(e.replace(/^\s+/,""))};_C$.stringLeftTrim=stringLeftTrim;const stringRightTrim=e=>{e=String(e==undefined?"":e);if(e==""){return""}return String(e.replace(/\s+$/,""))};_C$.stringRightTrim=stringRightTrim;const stringUcFirst=e=>{e=String(e==undefined?"":e);if(e==""){return""}if(e.length>1){return String(e.charAt(0).toUpperCase()+e.substring(1))}else{return String(e.toUpperCase())}};_C$.stringUcFirst=stringUcFirst;const stringUcWords=e=>{e=String(e==undefined?"":e);if(e==""){return""}return String(e.toLowerCase().replace(/^(.)|\s+(.)/g,e=>e?String(e).toUpperCase():""))};_C$.stringUcWords=stringUcWords;const stringReplaceAll=(e,r,t)=>{t=String(t==undefined?"":t);if(t==""){return""}return String(t.split(e).join(r))};_C$.stringReplaceAll=stringReplaceAll;const stringIReplaceAll=function(r,t,n){n=String(n==undefined?"":n);if(n==""){return""}if(typeof r==="string"&&typeof t==="string"){r=r.toLowerCase();let e=-1;while((e=n.toLowerCase().indexOf(r,e>=0?e+t.length:0))!==-1){n=String(n.substring(0,e)+t+n.substring(e+r.length))}}return String(n)};_C$.stringIReplaceAll=stringIReplaceAll;const stringRegexMatchAll=function(t,n){t=String(t==undefined?"":t);if(t==""){return[]}if(n==undefined){return[]}if(!(n instanceof RegExp)){_p$.error(_N$,"ERR: stringRegexMatchAll: 2nd param must be a Regex and is not");return[]}let i=[];if(String.prototype.matchAll){try{i=Array.from(t.matchAll(n))}catch(e){_p$.error(_N$,"ERR: stringRegexMatchAll (1):",e);return[]}}else{const s=()=>{const e=8e5;const r=1e5;const t=r*10;let n=e;if(n<r){n=r}else if(n>t){n=t}return n};const l=s();let e=null;let r=0;try{while((e=n.exec(t))!==null){if(e.index===n.lastIndex){n.lastIndex++}i.push(e);r++;if(r>=l){_p$.warn(_N$,"WARN: stringRegexMatchAll hardlimit loop (2). Max recursion depth is",l);break}}}catch(e){_p$.error(_N$,"ERR: stringRegexMatchAll (2):",e);return[]}}return i};_C$.stringRegexMatchAll=stringRegexMatchAll;const strContains=(e,r,t=0,n=false)=>{e=String(e==undefined?"":e);if(e==""){return false}r=String(r==undefined?"":r);if(r==""){return false}if(t==undefined){t=0}t=format_number_int(t);if(t<0){_p$.error(_N$,"ERR: strContains: Position is Negative:",t);return false}if(n===true){e=e.toLowerCase();r=r.toLowerCase()}return!!e.includes(r,t)};const stringContains=(e,r,t=0)=>!!strContains(e,r,t,false);_C$.stringContains=stringContains;const stringIContains=(e,r,t=0)=>!!strContains(e,r,t,true);_C$.stringIContains=stringIContains;const strStartsWith=(e,r,t=false)=>{e=String(e==undefined?"":e);if(e==""){return false}r=String(r==undefined?"":r);if(r==""){return false}if(t===true){e=e.toLowerCase();r=r.toLowerCase()}return!!e.startsWith(r,0)};const stringStartsWith=(e,r)=>!!strStartsWith(e,r,false);_C$.stringStartsWith=stringStartsWith;const stringIStartsWith=(e,r)=>!!strStartsWith(e,r,true);_C$.stringIStartsWith=stringIStartsWith;const strEndsWith=(e,r,t=false)=>{e=String(e==undefined?"":e);if(e==""){return false}r=String(r==undefined?"":r);if(r==""){return false}if(t===true){e=e.toLowerCase();r=r.toLowerCase()}return!!e.endsWith(r)};const stringEndsWith=(e,r)=>!!strEndsWith(e,r,false);_C$.stringEndsWith=stringEndsWith;const stringIEndsWith=(e,r)=>!!strEndsWith(e,r,true);_C$.stringIEndsWith=stringIEndsWith;const preg_quote=e=>{e=String(e==undefined?"":e);if(e==""){return""}return String(e.replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:\-\#])/g,"\\$1"))};_C$.preg_quote=preg_quote;const stringSplitbyChar=function(e,r){e=String(e==undefined?"":e);if(e==""){return[]}r=String(r==undefined?"":r);let t=false;switch(r){case"=":t=true;break;case":":t=true;break;case";":t=true;break;case",":t=true;break;default:t=false}if(!t){return[]}t=new RegExp("\\s*"+preg_quote(r)+"\\s*");e=stringTrim(e);return e.split(t)};const stringSplitbyEqual=e=>stringSplitbyChar(e,"=");_C$.stringSplitbyEqual=stringSplitbyEqual;const stringSplitbyColon=e=>stringSplitbyChar(e,":");_C$.stringSplitbyColon=stringSplitbyColon;const stringSplitbySemicolon=e=>stringSplitbyChar(e,";");_C$.stringSplitbySemicolon=stringSplitbySemicolon;const stringSplitbyComma=e=>stringSplitbyChar(e,",");_C$.stringSplitbyComma=stringSplitbyComma;const arrayGetFirst=e=>e instanceof Array?e.shift():null;_C$.arrayGetFirst=arrayGetFirst;const arrayGetLast=e=>e instanceof Array?e.pop():null;_C$.arrayGetLast=arrayGetLast;const format_number_float=(e,r=true)=>{if(e==undefined){e=0}e=Number(e);e=isFiniteNumber(e)?e:0;if(r!==true){if(e<0){e=0}}e=Number(e);return isFiniteNumber(e)?e:0};_C$.format_number_float=format_number_float;const format_number_int=(e,r=true)=>{if(e==undefined){e=0}e=Number(e);e=isFiniteNumber(e)?Math.round(e):0;if(!Number.isInteger(e)){e=0}if(r!==true){if(e<0){e=0}}if(!Number.isSafeInteger(e)){if(e>0){e=Number.MAX_SAFE_INTEGER}else if(e<0){e=Number.MIN_SAFE_INTEGER}}e=Number(e);return isFiniteNumber(e)&&Number.isInteger(e)?e:0};_C$.format_number_int=format_number_int;const format_number_dec=(e,r=2,t=true,n=false)=>{if(e==undefined){e=0}if(r==undefined){r=2}r=format_number_int(r,false);if(r<1){r=1}else if(r>13){r=13}if(t!==false){t=true}if(n!==true){n=false}e=format_number_float(e,t);if(t!==true){if(e<0){e=0}}e=e.toFixed(r);if(n!==false){e=Number.parseFloat(e)}return String(e)};_C$.format_number_dec=format_number_dec;const randNum=(e,r)=>{e=format_number_int(e,false);r=format_number_int(r,false);if(e<0){return 0}if(r<1){return 0}if(e===r){return e}else if(e>r){return r}return format_number_int(e+Math.floor(Math.random()*(r-e+1)),false)};_C$.randNum=randNum;const stripslashes=function(e){e=String(e==undefined?"":e);if(e==""){return""}const r=(e,r)=>{switch(r){case"\\":return"\\";case"0":return"\0";case"":return"";default:return String(r)}};return String(e.replace(/\\(.?)/g,r))};_C$.stripslashes=stripslashes;const addcslashes=function(e,r){e=String(e==undefined?"":e);if(e==""){return""}r=String(r==undefined?"":r);if(r==""){return""}let t="",n=[],i=0,s=0,l="",a="",c="",o="",u="",g=0,f=0,p=0,d=0,S=0,m=[],C="";const _=/%([\dA-Fa-f]+)/g;const h=(e,r)=>{if((e=String(e)).length<r){return new Array(++r-e.length).join("0")+e}return e};for(i=0;i<r.length;i++){l=r.charAt(i);a=r.charAt(i+1);if(l==="\\"&&a&&/\d/.test(a)){c=r.slice(i+1).match(/^\d+/)[0];p=c.length;d=i+p+1;if(r.charAt(d)+r.charAt(d+1)===".."){g=c.charCodeAt(0);if(/\\\d/.test(r.charAt(d+2)+r.charAt(d+3))){o=r.slice(d+3).match(/^\d+/)[0];i+=1}else if(r.charAt(d+2)){o=r.charAt(d+2)}else{_p$.error(_N$,"ERR: addcslashes: Range with no end point (1)")}f=o.charCodeAt(0);if(f>g){for(s=g;s<=f;s++){n.push(String.fromCharCode(s))}}else{n.push(".",c,o)}i+=o.length+2}else{u=String.fromCharCode(parseInt(c,8));n.push(u)}i+=p}else if(a+r.charAt(i+2)===".."){c=l;g=c.charCodeAt(0);if(/\\\d/.test(r.charAt(i+3)+r.charAt(i+4))){o=r.slice(i+4).match(/^\d+/)[0];i+=1}else if(r.charAt(i+3)){o=r.charAt(i+3)}else{_p$.error(_N$,"ERR: addcslashes: Range with no end point (2)")}f=o.charCodeAt(0);if(f>g){for(s=g;s<=f;s++){n.push(String.fromCharCode(s))}}else{n.push(".",c,o)}i+=o.length+2}else{n.push(l)}}for(i=0;i<e.length;i++){l=e.charAt(i);if(n.indexOf(l)!==-1){t+="\\";S=l.charCodeAt(0);if(S<32||S>126){switch(l){case"\n":t+="n";break;case"\t":t+="t";break;case"\r":t+="r";break;case"\x07":t+="a";break;case"\v":t+="v";break;case"\b":t+="b";break;case"\f":t+="f";break;default:C=encodeURIComponent(l);let e=stringRegexMatchAll(C,_);let r;for(r=0;r<e.length;r++){if(r>0){t+="\\"}t+=h(parseInt(e[r][1],16).toString(8),3)}break}}else{t+=l}}else{t+=l}}return String(t?t:"")};_C$.addcslashes=addcslashes;const escape_css=e=>{e=String(e==undefined?"":e);if(e==""){return""}return String(addcslashes(String(e==undefined?"":e),"\0..\x1f!\"#$%&'()*+,./:;<=>?@[\\]^`{|}~"))};_C$.escape_css=escape_css;const htmlspecialchars=(e,r="ENT_COMPAT")=>{e=String(e==undefined?"":e);if(e==""){return""}r=String(r==undefined?"":r);if(r==""){r="ENT_COMPAT"}e=e.replace(/&/g,"&amp;");e=e.replace(/\</g,"&lt;");e=e.replace(/\>/g,"&gt;");if(r=="ENT_QUOTES"){e=e.replace(/"/g,"&quot;");e=e.replace(/'/g,"&#039;")}else if(r!="ENT_NOQUOTES"){e=e.replace(/"/g,"&quot;")}return String(e)};_C$.htmlspecialchars=htmlspecialchars;const escape_html=e=>String(htmlspecialchars(e,"ENT_COMPAT"));_C$.escape_html=escape_html;const escape_js=function(e){e=String(e==undefined?"":e);if(e==""){return""}const r=e=>{e=String(e==undefined?"":e);if(e==""){return""}return String("\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4).toLowerCase())};const t=e=>{e=String(e==undefined?"":e);if(e==""){return""}switch(e){case"\b":e="\\b";break;case"\t":e="\\t";break;case"\n":e="\\n";break;case"\f":e="\\f";break;case"\r":e="\\r";break;case"\\":e="\\\\";break;default:e=r(e)}return String(e)};let n="";n=e.replace(/[\x00-\x1f\x7f-\x9f\\]/g,e=>t(e));n=n.replace(/[\u007F-\uFFFF]/g,e=>r(e));n=n.replace(/[\u0026]/g,"\\u0026");n=n.replace(/[\u0022]/g,"\\u0022");n=n.replace(/[\u0027]/g,"\\u0027");n=n.replace(/[\u003C]/g,"\\u003C");n=n.replace(/[\u003E]/g,"\\u003E");n=n.replace(/[\/]/g,"\\/");return String(n)};_C$.escape_js=escape_js;const escape_url=e=>{e=String(e==undefined?"":e);if(e==""){return""}e=String(encodeURIComponent(e));e=e.replace("!","%21");e=e.replace("'","%27");e=e.replace("(","%28");e=e.replace(")","%29");e=e.replace("*","%2A");return String(e)};_C$.escape_url=escape_url;const nl2br=e=>{e=String(e==undefined?"":e);if(e==""){return""}return String(e.replace(/\r\n/g,/\n/).replace(/\r/g,/\n/).replace(/\n/g,"<br>"))};_C$.nl2br=nl2br;const stripTags=function(e){const r="stripTags";e=String(e==undefined?"":e);if(e==""){return""}let t="";try{const n=(new DOMParser).parseFromString(e,"text/html");t=n.body.textContent||""}catch(e){t="";_p$.error(_N$,r,e)}return String(t)};_C$.stripTags=stripTags;const utf8Enc=e=>{const r="utf8Enc";e=String(e==undefined?"":e);if(e==""){return""}let t="";try{t=encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(e,r)=>{return String.fromCharCode("0x"+r)})}catch(e){t="";_p$.error(_N$,r,e)}return String(t||"")};_C$.utf8Enc=utf8Enc;const utf8Dec=e=>{const r="utf8Dec";e=String(e==undefined?"":e);if(e==""){return""}let t="";try{t=decodeURIComponent(e.split("").map(e=>{return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))}catch(e){t="";_p$.error(_N$,r,e)}return String(t||"")};_C$.utf8Dec=utf8Dec;const deaccent_str=function(r){r=String(r==undefined?"":r);if(r==""){return""}const t="\xe1\xe2\xe3\xe4\xe5\u0101\u0103\u0105\xc1\xc2\xc3\xc4\xc5\u0100\u0102\u0104\u0107\u0109\u010d\xe7\u0106\u0108\u010c\xc7\u010f\u010e\xe8\xe9\xea\xeb\u0113\u0115\u0117\u011b\u0119\xc8\xc9\xca\xcb\u0112\u0114\u0116\u011a\u0118\u011d\u0123\u011c\u0122\u0125\u0127\u0124\u0126\xec\xed\xee\xef\u0129\u012b\u012d\u0209\u020b\u012f\xcc\xcd\xce\xcf\u0128\u012a\u012c\u0208\u020a\u012e\u0133\u0135\u0132\u0134\u0137\u0136\u013a\u013c\u013e\u0142\u0139\u013b\u013d\u0141\xf1\u0144\u0146\u0148\xd1\u0143\u0145\u0147\xf3\xf4\xf5\xf6\u014d\u014f\u0151\xf8\u0153\xd2\xd3\xd4\xd5\xd6\u014c\u014e\u0150\xd8\u0152\u0155\u0157\u0159\u0154\u0156\u0158\u0219\u015f\u0161\u015b\u015d\u0161\u0218\u015e\u0160\u015a\u015c\u0160\u021b\u0163\u0165\u021a\u0162\u0164\xf9\xfa\xfb\xfc\u0169\u016b\u016d\u016f\u0171\u0173\xd9\xda\xdb\xdc\u0168\u016a\u016c\u016e\u0170\u0172\u0175\u0174\u1e8f\u1ef3\u0177\xff\xfd\u1e8e\u1ef2\u0176\u0178\xdd\u017a\u017c\u017e\u0179\u017b\u017d";const n="aaaaaaaaAAAAAAAAccccCCCCdDeeeeeeeeeEEEEEEEEEggGGhhHHiiiiiiiiiiIIIIIIIIIIjjJJkKllllLLLLnnnnNNNNoooooooooOOOOOOOOOOrrrRRRssssssSSSSSStttTTTuuuuuuuuuuUUUUUUUUUUwWyyyyyYYYYYzzzZZZ";r=r.split("");let i=r.length;let s=new Array;let l=-1;for(let e=0;e<i;e++){l=t.indexOf(r[e]);if(l!==-1){s[e]=n.substring(l,l+1)}else{s[e]=r[e]}}s=s.join("");return String(s)};_C$.deaccent_str=deaccent_str;const bin2hex=function(e,r=false){e=String(e==undefined?"":e);if(e==""){return""}if(r!==true){e=String(utf8Enc(e))}let t="";let n,i,s;for(n=0,i=e.length;n<i;n++){s=e.charCodeAt(n).toString(16);t+=s.length<2?"0"+s:s}return String(t).toLowerCase()};_C$.bin2hex=bin2hex;const hex2bin=function(r,e=false){r=String(r==undefined?"":r);r=String(stringTrim(r)).toLowerCase();if(r==""){return""}let t=[],n;for(let e=0;e<r.length-1;e+=2){t.push(parseInt(r.substring(e,e+2),16))}if(e!==true){return String(utf8Dec(String.fromCharCode.apply(String,t)))}else{return String.fromCharCode.apply(String,t)}};_C$.hex2bin=hex2bin;const b64Enc=function(r,e=false){const t="b64Enc";r=String(r==undefined?"":r);if(r==""){return""}if(e!==true){r=utf8Enc(r)}try{r=btoa(r)}catch(e){r="";_p$.error(_N$,t,e)}return String(r||"")};_C$.b64Enc=b64Enc;const b64Dec=function(r,e=false){const t="b64Dec";r=stringPureVal(r,true);if(r==""){return""}try{r=atob(r)}catch(e){r="";_p$.error(_N$,t,e)}if(e!==true){r=utf8Dec(r)}return String(r||"")};_C$.b64Dec=b64Dec;const strRev=e=>{e=String(e==undefined?"":e);if(e==""){return""}return e.split("").reverse().join("")};_C$.strRev=strRev;const strRot13=e=>{e=String(e==undefined?"":e);if(e==""){return""}return String(e.replace(/[a-z]/gi,e=>{return String.fromCharCode(e.charCodeAt(0)+(e.toLowerCase()<"n"?13:-13))}))};_C$.strRot13=strRot13;const strRRot13=e=>String(strRev(strRot13(e)));_C$.strRRot13=strRRot13;let tseed=(new Date).valueOf();const uuid=function(){tseed++;let r=String(tseed.toString(36));r=r.toUpperCase().substring(r.length-10);if(r.length<10){for(let e=0;e<r.length;e++){if(r.length<10){r=String("0"+r)}else{break}}}return String(r)};_C$.uuid=uuid;const addToList=function(r,e,t){r=String(r==undefined?"":stringTrim(r));if(r==""){return""}e=String(e==undefined?"":e);let n=[];t=String(t==undefined?"":t);switch(t){case",":n=stringSplitbyComma(e);break;case";":n=stringSplitbySemicolon(e);break;default:_p$.error(_N$,"ERR: addToList: Invalid splitBy separator. Must be any of [,;] and is:",t);return""}let i=false;if(n.length>0){n.pop();for(let e=0;e<n.length;e++){if(n[e]==r){i=true;break}}}if(!i){n.push(r)}n.push("");return String(n.join(t+" "))};_C$.addToList=addToList;const textSort=function(i,s=false){return(e,r)=>{e[i]=String(e[i]);r[i]=String(r[i]);let t=0;let n=false;if(s===true){try{t=e[i].localeCompare(r[i]);if(t<0){t=-1}else if(t>0){t=1}else{t=0}}catch(e){n=true}}if(s!==true||n===true){t=(e[i]<r[i]?-1:e[i]>r[i])?1:0}return t}};_C$.textSort=textSort;const numericSort=t=>{return(e,r)=>{if(!isFiniteNumber(e[t])||!isFiniteNumber(r[t])){return 0}if(e[t]>r[t]){return 1}else if(e[t]<r[t]){return-1}else{return 0}}};_C$.numericSort=numericSort;const url_add_suffix=function(e,r){e=stringPureVal(e,true);r=stringPureVal(r,true);if(stringStartsWith(r,"?")||stringStartsWith(r,"&")){r=stringPureVal(r.substring(1),true)}if(r==""){return String(e)}let t="";if(stringContains(e,"?")){t="&"}else{t="?"}return String(e+t+r)};_C$.url_add_suffix=url_add_suffix;const create_slug=(e,r=false,t=0)=>{e=stringPureVal(e,true);if(e==""){return""}e=String(deaccent_str(stringTrim(e)));e=e.replace(/[^a-zA-Z0-9_\-]/g,"-");e=e.replace(/[\-]+/g,"-");e=e.replace(/^[\-]+/,"").replace(/[\-]+$/,"");e=String(stringTrim(e));if(r===true){e=e.toLowerCase()}t=format_number_int(t,false);if(t>0){e=e.substring(0,t);e=e.replace(/(\-)+$/,"")}return String(e)};_C$.create_slug=create_slug;const create_htmid=e=>{e=stringPureVal(e,true);if(e==""){return""}e=e.replace(/[^a-zA-Z0-9_\-]/g,"");e=stringTrim(e);return String(e)};_C$.create_htmid=create_htmid;const create_jsvar=e=>{e=stringPureVal(e,true);if(e==""){return""}e=e.replace(/[^a-zA-Z0-9_\$]/g,"");e=String(stringTrim(e));return String(e)};_C$.create_jsvar=create_jsvar;const revertNosyntaxContentMarkersTpl=e=>{if(typeof e!=="string"){return""}e=String(e);e=stringReplaceAll("\uff3b"+"###","["+"###",e);e=stringReplaceAll("###"+"\uff3d","###"+"]",e);e=stringReplaceAll("\uff3b"+"%%%","["+"%%%",e);e=stringReplaceAll("%%%"+"\uff3d","%%%"+"]",e);e=stringReplaceAll("\uff3b"+"@@@","["+"@@@",e);e=stringReplaceAll("@@@"+"\uff3d","@@@"+"]",e);e=stringReplaceAll("\uff3b"+":::","["+":::",e);e=stringReplaceAll(":::"+"\uff3d",":::"+"]",e);return String(e)};_C$.revertNosyntaxContentMarkersTpl=revertNosyntaxContentMarkersTpl;const prepareNosyntaxContentMarkersTpl=e=>{if(typeof e!=="string"){return""}e=String(e);e=stringReplaceAll("["+"###","\uff3b"+"###",e);e=stringReplaceAll("###"+"]","###"+"\uff3d",e);e=stringReplaceAll("["+"%%%","\uff3b"+"%%%",e);e=stringReplaceAll("%%%"+"]","%%%"+"\uff3d",e);e=stringReplaceAll("["+"@@@","\uff3b"+"@@@",e);e=stringReplaceAll("@@@"+"]","@@@"+"\uff3d",e);e=stringReplaceAll("["+":::","\uff3b"+":::",e);e=stringReplaceAll(":::"+"]",":::"+"\uff3d",e);return String(e)};_C$.prepareNosyntaxContentMarkersTpl=prepareNosyntaxContentMarkersTpl;const prepareNosyntaxHtmlMarkersTpl=e=>{if(typeof e!=="string"){return""}e=String(e);e=stringReplaceAll("["+"###","&lbrack;&num;&num;&num;",e);e=stringReplaceAll("###"+"]","&num;&num;&num;&rbrack;",e);e=stringReplaceAll("["+"%%%","&lbrack;&percnt;&percnt;&percnt;",e);e=stringReplaceAll("%%%"+"]","&percnt;&percnt;&percnt;&rbrack;",e);e=stringReplaceAll("["+"@@@","&lbrack;&commat;&commat;&commat;",e);e=stringReplaceAll("@@@"+"]","&commat;&commat;&commat;&rbrack;",e);e=stringReplaceAll("["+":::","&lbrack;&colon;&colon;&colon;",e);e=stringReplaceAll(":::"+"]","&colon;&colon;&colon;&rbrack;",e);e=stringReplaceAll("\uff3b"+"###","&lbrack;&num;&num;&num;",e);e=stringReplaceAll("###"+"\uff3d","&num;&num;&num;&rbrack;",e);e=stringReplaceAll("\uff3b"+"%%%","&lbrack;&percnt;&percnt;&percnt;",e);e=stringReplaceAll("%%%"+"\uff3d","&percnt;&percnt;&percnt;&rbrack;",e);e=stringReplaceAll("\uff3b"+"@@@","&lbrack;&commat;&commat;&commat;",e);e=stringReplaceAll("@@@"+"\uff3d","&commat;&commat;&commat;&rbrack;",e);e=stringReplaceAll("\uff3b"+":::","&lbrack;&colon;&colon;&colon;",e);e=stringReplaceAll(":::"+"\uff3d","&colon;&colon;&colon;&rbrack;",e);return String(e)};_C$.prepareNosyntaxHtmlMarkersTpl=prepareNosyntaxHtmlMarkersTpl;const renderMarkersTpl=function(f,p,e=false,r=false){if(typeof f==="string"&&typeof p==="object"){if(e===true){f=String(decodeURIComponent(f))}if(r===true){f=String(revertNosyntaxContentMarkersTpl(f))}f=stringTrim(f);if(stringContains(f,"["+"%%%COMMENT%%%"+"]")&&stringContains(f,"["+"%%%/COMMENT%%%"+"]")){let r=[];r=f.split("["+"%%%COMMENT%%%"+"]");for(let e=0;e<r.length;e++){if(stringContains(r[e],"["+"%%%/COMMENT%%%"+"]")){r[e]="["+"%%%COMMENT%%%"+"]"+r[e];r[e]=r[e].replace(/[\s\S]?\[\%\%\%COMMENT\%\%\%\]([\s\S]*?)\[\%\%\%\/COMMENT\%\%\%\][\s\S]?/g,"")}}f=stringTrim(r.join(""));r=null}if(f!=""){const t=/\[\#\#\#([A-Z0-9_\-\.]+)((\|[a-z0-9]+)*)\#\#\#\]/g;let g=stringRegexMatchAll(f,t);if(g.length){let r,t;let n,i,s,l,a;let c,o,u;for(let e=0;e<g.length;e++){r=g[e];if(r.length){n="";i=r[0]?String(r[0]):"";s=r[1]?String(r[1]):"";l=r[2]?String(r[2]):"";a=[];if(i!=null&&i!=""&&s!=null&&s!=""&&stringContains(f,i)){if(s in p){n=p[s]?p[s]:"";n=String(n);n=String(prepareNosyntaxContentMarkersTpl(n));if(l){if(stringStartsWith(l,"|")){l=l.substring(1)}if(l){a=l.split(/\|/);if(a.length){for(let e=0;e<a.length;e++){t=String("|"+String(a[e]));if(t=="|bool"){if(n){n="true"}else{n="false"}}else if(t=="|int"){n=String(format_number_int(n))}else if(t.substring(0,4)=="|dec"){c=format_number_int(t.substring(4));if(c<1){c=1}if(c>4){c=4}n=String(format_number_dec(n,c,true,false));c=null}else if(t=="|num"){n=String(format_number_float(n))}else if(t=="|idtxt"){n=String(stringReplaceAll("_","-",n));n=String(stringUcWords(n))}else if(t=="|slug"){n=String(create_slug(n,false))}else if(t=="|htmid"){n=String(create_htmid(n))}else if(t=="|jsvar"){n=String(create_jsvar(n))}else if(t.substring(0,7)=="|substr"||t.substring(0,7)=="|subtxt"){c=format_number_int(t.substring(7));if(c<1){c=1}if(c>65535){c=65535}if(c>=1&&c<=65535){o=n.length;if(t.substring(0,7)=="|subtxt"){if(c<5){c=5}c=c-3;if(o>c){n=n.substring(0,c);n=n.replace(/\s+?(\S+)?$/,"");n=String(n)+"..."}}else{if(o>c){n=n.substring(0,c)}}o=null}c=null;n=String(n)}else if(t=="|lower"){n=String(n).toLowerCase()}else if(t=="|upper"){n=String(n).toUpperCase()}else if(t=="|ucfirst"){n=String(stringUcFirst(n))}else if(t=="|ucwords"){n=String(stringUcWords(n))}else if(t=="|trim"){n=String(stringTrim(n))}else if(t=="|url"){n=String(escape_url(n))}else if(t=="|json"){u=null;try{u=JSON.parse(n)}catch(e){u=null}n=JSON.stringify(u,null,null);n=String(n);n=n.replace(/[\u0026]/g,"\\u0026");n=n.replace(/[\u003C]/g,"\\u003C");n=n.replace(/[\u003E]/g,"\\u003E");n=n.replace(/[\/]/g,"\\/");n=String(stringTrim(n));if(n==""){n="null"}}else if(t=="|js"){n=String(escape_js(n))}else if(t=="|html"){n=String(escape_html(n))}else if(t=="|css"){n=String(escape_css(n))}else if(t=="|nl2br"){n=String(nl2br(n))}else if(t=="|striptags"){n=String(stripTags(n))}else if(t=="|emptye"){if(stringTrim(n)==""){n="[EMPTY]"}}else if(t=="|emptyna"){if(stringTrim(n)==""){n="[N/A]"}}else if(t=="|smartlist"){n=String(stringReplaceAll("<","\u2039",n));n=String(stringReplaceAll(">","\u203a",n))}else if(t=="|syntaxhtml"){n=String(prepareNosyntaxHtmlMarkersTpl(n))}else if(t=="|hex"){n=String(bin2hex(n))}else if(t=="|b64"){n=String(b64Enc(n))}else{_p$.warn(_N$,"WARN: renderMarkersTpl: {### Invalid or Undefined Escaping for Marker: "+t+" - detected in Replacement Key: "+i+" @ "+n+" detected in Template: ^"+"\n"+f.substring(0,512)+"$(0..512)... ###}")}}}}}f=stringReplaceAll(i,n,f)}}}r=null;t=null;n=null;i=null;s=null;l=null;a=null}}g=null;if(stringContains(f,"["+"%%%|")){f=stringReplaceAll("["+"%%%|SB-L%%%"+"]","\uff3b",f);f=stringReplaceAll("["+"%%%|SB-R%%%"+"]","\uff3d",f);f=stringReplaceAll("["+"%%%|R%%%"+"]","\r",f);f=stringReplaceAll("["+"%%%|N%%%"+"]","\n",f);f=stringReplaceAll("["+"%%%|T%%%"+"]","\t",f);f=stringReplaceAll("["+"%%%|SPACE%%%"+"]"," ",f)}if(stringContains(f,"["+"###")){_p$.warn(_N$,"WARN: renderMarkersTpl:",stringRegexMatchAll(f,t),"{### Undefined Markers detected in Template:"+"\n"+f.substring(0,512)+"$(0..512)... ###}")}if(stringContains(f,"["+"%%%")){_p$.warn(_N$,"WARN: renderMarkersTpl: {### Undefined Marker Syntax detected in Template: ^"+"\n"+f.substring(0,512)+"$(0..512)... ###}")}if(stringContains(f,"["+"@@@")){_p$.warn(_N$,"WARN: renderMarkersTpl: {### Undefined Marker Sub-Templates detected in Template: ^"+"\n"+f.substring(0,512)+"$(0..512)... ###}")}}}else{_p$.error(_N$,"ERR: renderMarkersTpl: {### Invalid Marker-TPL Arguments ###}");f=""}return String(f)};_C$.renderMarkersTpl=renderMarkersTpl}};smartJ$Utils.secureClass();if(typeof window!="undefined"){window.smartJ$Utils=smartJ$Utils}
// #END
