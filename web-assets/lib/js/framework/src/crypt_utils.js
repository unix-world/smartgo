// JS-Script (UM): crypt_utils.js @ 2022-09-20 09:50:56 +0000
const smartJ$TestCrypto=new class{constructor(){"use strict";const t="smartJ$TestCrypto";const e=this;const r=console;let n=false;e.secureClass=()=>{if(n===true){r.warn(t,"Class is already SECURED")}else{n=true;Object.freeze(e)}};const s=e=>{r.error(t,"ERR: Browser FAILED with:",e)};e.raiseError=s;const i=()=>{return"VW5pY29kZSBTdHJpbmc6CQnFn8WexaPFosSDxILDrsOOw6LDgsiZyJjIm8iaICgwNS0wOSM="};e.testBase64=i;const o=(e=false)=>{if(e===true){return"01hcnnc"}else{return"055757b8"}};e.testCRC32B=o;const c=(e=false)=>{if(e===true){return"PW7773idgEOjkmVB/rmhjA=="}else{return"3d6efbef789d8043a3926541feb9a18c"}};e.testMD5=c;const l=(e=false)=>{if(e===true){return"WgoSffvbg0kbn7wO453JRwZsQmw="}else{return"5a0a127dfbdb83491b9fbc0ee39dc947066c426c"}};e.testSHA1=l;const a=(e=false)=>{if(e===true){return"GTvIwHM9xKaYl7+tgXkV22cyONrQnWDMkSm7PMsiVKg="}else{return"193bc8c0733dc4a69897bfad817915db673238dad09d60cc9129bb3ccb2254a8"}};e.testSHA256=a;const u=(e=false)=>{if(e===true){return"tRt7Uw8rciM8Vf4P08PES7q+TbboJq/Fi0hmilLqef5fvSclO5iu287kAdu4qgCpcFbdCIpWtEugozIN8ttcHg=="}else{return"b51b7b530f2b72233c55fe0fd3c3c44bbabe4db6e826afc58b48668a52ea79fe5fbd27253b98aedbcee401dbb8aa00a97056dd088a56b44ba0a3320df2db5c1e"}};e.testSHA512=u;const f=()=>{return"Unicode String:\t\t\u015f\u015e\u0163\u0162\u0103\u0102\xee\xce\xe2\xc2\u0219\u0218\u021b\u021a (05-09#"};e.unicodeString=f}};smartJ$TestCrypto.secureClass();if(typeof window!="undefined"){window.smartJ$TestCrypto=smartJ$TestCrypto}const smartJ$Base64=new class{constructor(){"use strict";const e="smartJ$Base64";const t=this;const r=console;let n=false;t.secureClass=()=>{if(n===true){r.warn(e,"Class is already SECURED")}else{n=true;Object.freeze(t)}};const h=smartJ$Utils;const s=smartJ$TestCrypto;let i=false;let o=false;const c=function(e,t=false){if(i!==true){if(a(s.unicodeString())==s.testBase64()){i=true}else{s.raiseError("Base64/Encode");return""}}return String(a(e,t))};t.encode=c;const l=function(e,t=false){if(o!==true){if(u(s.testBase64())==s.unicodeString()){o=true}else{s.raiseError("Base64/Decode");return""}}return String(u(e,t))};t.decode=l;const g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";const a=function(e,t){e=h.stringPureVal(e);if(e==""){return""}if(t!==true){e=h.utf8_encode(e)}const r=String(g);let n="";let s,i,o;let c,l,a,u;let f=0;do{s=e.charCodeAt(f++);i=e.charCodeAt(f++);o=e.charCodeAt(f++);c=s>>2;l=(s&3)<<4|i>>4;a=(i&15)<<2|o>>6;u=o&63;if(isNaN(i)){a=u=64}else if(isNaN(o)){u=64}n=n+r.charAt(c)+r.charAt(l)+r.charAt(a)+r.charAt(u)}while(f<e.length);return String(n)};const u=function(e,t){e=h.stringPureVal(e);if(e==""){return""}const r=String(g);let n="";let s,i,o;let c,l,a,u;let f=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");do{c=r.indexOf(e.charAt(f++));l=r.indexOf(e.charAt(f++));a=r.indexOf(e.charAt(f++));u=r.indexOf(e.charAt(f++));s=c<<2|l>>4;i=(l&15)<<4|a>>2;o=(a&3)<<6|u;n=n+String.fromCharCode(s);if(a!=64){n=n+String.fromCharCode(i)}if(u!=64){n=n+String.fromCharCode(o)}}while(f<e.length);if(t!==true){n=h.utf8_decode(n)}return String(n)}}};smartJ$Base64.secureClass();if(typeof window!="undefined"){window.smartJ$Base64=smartJ$Base64}const smartJ$BaseEncode=new class{constructor(){"use strict";const a="smartJ$BaseEncode";const e=this;const u=console;let t=false;e.secureClass=()=>{if(t===true){u.warn(a,"Class is already SECURED")}else{t=true;Object.freeze(e)}};const f=smartJ$Utils;const r=smartJ$Base64;const n=function(e,t=false){return r.encode(e,t).replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,".")};e.b64s_enc=n;const s=function(e,t=false){return r.decode(f.stringPureVal(e).replace(/\-/g,"+").replace(/_/g,"/").replace(/\./g,"="),t)};e.b64s_dec=s;const i=function(e,t){const r="base_to_hex_convert";e=f.stringPureVal(e,true);if(e==""){u.warn(a,r,"Empty Input");return""}let n=c(t);if(n==""){u.warn(a,r,"Invalid Current Base:",t);return""}t=n.length;let s=e.split("");e=null;s=s.map(e=>{const t=String(n).indexOf(e);if(t<0){u.warn(a,r,"Invalid Base Character:",e)}return t});let i=0;while(s.length&&0===s[0]){i++;s.shift()}let o=l(s,t,256);s=null;if(0<i){let e=new Array(i).fill(0,0,i);o=[].concat(e,o)}o=o.map(e=>String.fromCharCode(e)).join("");return String(f.bin2hex(o,true))};e.base_to_hex_convert=i;const o=function(e,t){const r="base_from_hex_convert";e=f.stringPureVal(e,true);if(e==""){u.warn(a,r,"Empty Input");return""}let n=c(t);if(n==""){u.warn(a,r,"Invalid Target Base:",t);return""}t=n.length;let s=String(f.hex2bin(e,true));if(s==""){u.warn(a,r,"Invalid Input, NOT HEX:",e);return""}e=null;s=s.split("");s=s.map(e=>String(e).charCodeAt(0));let i=0;while(s.length&&0===s[0]){i++;s.shift()}let o=l(s,256,t);s=null;if(0<i){let e=new Array(i).fill(0,0,i);o=[].concat(e,o)}n=n.split("");return String(o.map(e=>n[e]).join(""))};e.base_from_hex_convert=o;const c=function(e){const t="0123456789abcdefghijklmnopqrstuv";const r="wxyz";const n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";const s=".-:+=^!/*?&<>()[]{}@%$#";const i='|;,_~`"';const o="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";const c=f.stringPureVal(e,true);let l="";switch(c){case"32":l=String(t).toUpperCase();break;case"36":l=String(t)+String(r);break;case"58":l=String(o);break;case"62":l=String(t)+String(r)+String(n);break;case"85":l=String(t)+String(r)+String(n)+String(s);break;case"92":l=String(t)+String(r)+String(n)+String(s)+String(i);break;default:u.error(a,"base_get_alphabet","Invalid Base:",c)}return String(l)};const l=function(i,o,c){let e=[];let t;while(t=i.length){let n=[];let s=0;for(let r=0;r!==t;r++){let e=i[r]+s*o;let t=(e-e%c)/c;s=e%c;if(n.length||t){n.push(t)}}e.unshift(s);i=n}return e}}};smartJ$BaseEncode.secureClass();if(typeof window!="undefined"){window.smartJ$BaseEncode=smartJ$BaseEncode}const smartJ$CryptoHash=new class{constructor(){"use strict";const e="smartJ$CryptoHash";const t=this;const r=console;let n=false;t.secureClass=()=>{if(n===true){r.warn(e,"Class is already SECURED")}else{n=true;Object.freeze(t)}};const g=smartJ$Utils;const s=smartJ$Base64;const i=smartJ$TestCrypto;let o=false;let c=false;let l=false;let a=false;let u=false;let f=false;let h=false;let d=false;let F=false;let w=false;const p=()=>{return 8};const C=function(e,t){let r=(e&65535)+(t&65535);let n=(e>>16)+(t>>16)+(r>>16);return n<<16|r&65535};const B=(e,t)=>{return e<<t|e>>>32-t};const S=function(t){let r=Array();let n=(1<<p())-1;for(let e=0;e<t.length*p();e+=p()){r[e>>5]|=(t.charCodeAt(e/p())&n)<<e%32}return r};const A=function(t){let r="";let n=(1<<p())-1;for(let e=0;e<t.length*32;e+=p()){r+=String.fromCharCode(t[e>>5]>>>e%32&n)}return r};const E=function(t){const r=(1<<p())-1;let n=Array();for(let e=0;e<t.length*p();e+=p()){n[e>>5]|=(t.charCodeAt(e/p())&r)<<32-p()-e%32}return n};const D=function(t){const r=(1<<p())-1;let n="";for(let e=0;e<t.length*32;e+=p()){n+=String.fromCharCode(t[e>>5]>>>32-p()-e%32&r)}return n};const b=function(t){const r=t.length;let n=new Array(r);for(let e=0;e<r;e++){n[e]=t.charCodeAt(e)}return n};const m=function(e,t=false){if(t===true){if(c!==true){if(x(i.unicodeString())==i.testCRC32B(true)){c=true}else{i.raiseError("CRC32B/Hash/B36");return""}}return String(x(e))}else{if(o!==true){if(y(i.unicodeString())==i.testCRC32B()){o=true}else{i.raiseError("CRC32B/Hash/Hex");return""}}return String(y(e))}};t.crc32b=m;let O=null;const _=function(){if(O!==null){return}O=new Array(256);let e=0,t=0,r=0;for(e=0;e<256;e++){t=e;r=8;while(r--){t=t>>>1^(t&1?3988292384:0)}O[e]=t}};const y=function(e){e=g.stringPureVal(e);e=g.utf8_encode(e);let t=String(I(e).toString(16));const r=8-t.length;if(r>0){for(let e=0;e<r;e++){t="0"+t}}return String(t)};const x=function(e){e=g.stringPureVal(e);e=g.utf8_encode(e);let t=String(I(e).toString(36));const r=7-t.length;if(r>0){for(let e=0;e<r;e++){t="0"+t}}return String(t)};const I=function(e){let t=b(e),r=-1,n=0,s=t.length,i=typeof t[0]==="object",o=0;_();for(n=0;n<s;n++){o=i?t[n].id>>>0:t[n];r=O[(r^o)&255]^r>>>8}r=~r>>>0;return r};const J=e=>{e=g.stringPureVal(e);e=g.utf8_encode(e);return g.bin2hex(A(z(S(e),e.length*p())),true)};const v=e=>{e=g.stringPureVal(e);e=g.utf8_encode(e);return s.encode(A(z(S(e),e.length*p())),true)};const P=(e,t,r,n,s,i)=>{return C(B(C(C(t,e),C(n,i)),s),r)};const $=(e,t,r,n,s,i,o)=>{return P(t&r|~t&n,e,t,s,i,o)};const H=(e,t,r,n,s,i,o)=>{return P(t&n|r&~n,e,t,s,i,o)};const V=(e,t,r,n,s,i,o)=>{return P(t^r^n,e,t,s,i,o)};const M=(e,t,r,n,s,i,o)=>{return P(r^(t|~n),e,t,s,i,o)};const z=function(i,e){i[e>>5]|=128<<e%32;i[(e+64>>>9<<4)+14]=e;let o=1732584193;let c=-271733879;let l=-1732584194;let a=271733878;for(let s=0;s<i.length;s+=16){let e=o;let t=c;let r=l;let n=a;o=$(o,c,l,a,i[s+0],7,-680876936);a=$(a,o,c,l,i[s+1],12,-389564586);l=$(l,a,o,c,i[s+2],17,606105819);c=$(c,l,a,o,i[s+3],22,-1044525330);o=$(o,c,l,a,i[s+4],7,-176418897);a=$(a,o,c,l,i[s+5],12,1200080426);l=$(l,a,o,c,i[s+6],17,-1473231341);c=$(c,l,a,o,i[s+7],22,-45705983);o=$(o,c,l,a,i[s+8],7,1770035416);a=$(a,o,c,l,i[s+9],12,-1958414417);l=$(l,a,o,c,i[s+10],17,-42063);c=$(c,l,a,o,i[s+11],22,-1990404162);o=$(o,c,l,a,i[s+12],7,1804603682);a=$(a,o,c,l,i[s+13],12,-40341101);l=$(l,a,o,c,i[s+14],17,-1502002290);c=$(c,l,a,o,i[s+15],22,1236535329);o=H(o,c,l,a,i[s+1],5,-165796510);a=H(a,o,c,l,i[s+6],9,-1069501632);l=H(l,a,o,c,i[s+11],14,643717713);c=H(c,l,a,o,i[s+0],20,-373897302);o=H(o,c,l,a,i[s+5],5,-701558691);a=H(a,o,c,l,i[s+10],9,38016083);l=H(l,a,o,c,i[s+15],14,-660478335);c=H(c,l,a,o,i[s+4],20,-405537848);o=H(o,c,l,a,i[s+9],5,568446438);a=H(a,o,c,l,i[s+14],9,-1019803690);l=H(l,a,o,c,i[s+3],14,-187363961);c=H(c,l,a,o,i[s+8],20,1163531501);o=H(o,c,l,a,i[s+13],5,-1444681467);a=H(a,o,c,l,i[s+2],9,-51403784);l=H(l,a,o,c,i[s+7],14,1735328473);c=H(c,l,a,o,i[s+12],20,-1926607734);o=V(o,c,l,a,i[s+5],4,-378558);a=V(a,o,c,l,i[s+8],11,-2022574463);l=V(l,a,o,c,i[s+11],16,1839030562);c=V(c,l,a,o,i[s+14],23,-35309556);o=V(o,c,l,a,i[s+1],4,-1530992060);a=V(a,o,c,l,i[s+4],11,1272893353);l=V(l,a,o,c,i[s+7],16,-155497632);c=V(c,l,a,o,i[s+10],23,-1094730640);o=V(o,c,l,a,i[s+13],4,681279174);a=V(a,o,c,l,i[s+0],11,-358537222);l=V(l,a,o,c,i[s+3],16,-722521979);c=V(c,l,a,o,i[s+6],23,76029189);o=V(o,c,l,a,i[s+9],4,-640364487);a=V(a,o,c,l,i[s+12],11,-421815835);l=V(l,a,o,c,i[s+15],16,530742520);c=V(c,l,a,o,i[s+2],23,-995338651);o=M(o,c,l,a,i[s+0],6,-198630844);a=M(a,o,c,l,i[s+7],10,1126891415);l=M(l,a,o,c,i[s+14],15,-1416354905);c=M(c,l,a,o,i[s+5],21,-57434055);o=M(o,c,l,a,i[s+12],6,1700485571);a=M(a,o,c,l,i[s+3],10,-1894986606);l=M(l,a,o,c,i[s+10],15,-1051523);c=M(c,l,a,o,i[s+1],21,-2054922799);o=M(o,c,l,a,i[s+8],6,1873313359);a=M(a,o,c,l,i[s+15],10,-30611744);l=M(l,a,o,c,i[s+6],15,-1560198380);c=M(c,l,a,o,i[s+13],21,1309151649);o=M(o,c,l,a,i[s+4],6,-145523070);a=M(a,o,c,l,i[s+11],10,-1120210379);l=M(l,a,o,c,i[s+2],15,718787259);c=M(c,l,a,o,i[s+9],21,-343485551);o=C(o,e);c=C(c,t);l=C(l,r);a=C(a,n)}return Array(o,c,l,a)};const U=function(e,t=false){if(t===true){if(a!==true){if(v(i.unicodeString())==i.testMD5(true)){a=true}else{i.raiseError("MD5/Hash/B64");return""}}return String(v(e))}else{if(l!==true){if(J(i.unicodeString())==i.testMD5()){l=true}else{i.raiseError("MD5/Hash/Hex");return""}}return String(J(e))}};t.md5=U;const T=e=>{e=g.stringPureVal(e);e=g.utf8_encode(e);return g.bin2hex(D(R(E(e),e.length*p())),true)};const K=e=>{e=g.stringPureVal(e);e=g.utf8_encode(e);return s.encode(D(R(E(e),e.length*p())),true)};const j=(e,t,r,n)=>{if(e<20){return t&r|~t&n}if(e<40){return t^r^n}if(e<60){return t&r|t&n|r&n}return t^r^n};const k=e=>{return e<20?1518500249:e<40?1859775393:e<60?-1894007588:-899497514};const R=function(o,e){o[e>>5]|=128<<24-e%32;o[(e+64>>9<<4)+15]=e;let c=1732584193;let l=-271733879;let a=-1732584194;let u=271733878;let f=-1009589776;let h=Array(80);for(let i=0;i<o.length;i+=16){let e=c;let t=l;let r=a;let n=u;let s=f;for(let t=0;t<80;t++){if(t<16){h[t]=o[i+t]}else{h[t]=B(h[t-3]^h[t-8]^h[t-14]^h[t-16],1)}let e=C(C(B(c,5),j(t,l,a,u)),C(C(f,h[t]),k(t)));f=u;u=a;a=B(l,30);l=c;c=e}c=C(c,e);l=C(l,t);a=C(a,r);u=C(u,n);f=C(f,s)}return Array(c,l,a,u,f)};const Z=function(e,t=false){if(t===true){if(f!==true){if(K(i.unicodeString())==i.testSHA1(true)){f=true}else{i.raiseError("SHA1/Hash/B64");return""}}return String(K(e))}else{if(u!==true){if(T(i.unicodeString())==i.testSHA1()){u=true}else{i.raiseError("SHA1/Hash/Hex");return""}}return String(T(e))}};t.sha1=Z;const N=e=>{e=g.stringPureVal(e);e=g.utf8_encode(e);return g.bin2hex(D(o1(e)),true)};const q=e=>{e=g.stringPureVal(e);e=g.utf8_encode(e);return s.encode(D(o1(e)),true)};const L=function(e,t){const r=this;r.highOrder=e;r.lowOrder=t};const W=function(e,t){let r,n,s,i;r=(e.lowOrder&65535)+(t.lowOrder&65535);n=(e.lowOrder>>>16)+(t.lowOrder>>>16)+(r>>>16);s=(n&65535)<<16|r&65535;r=(e.highOrder&65535)+(t.highOrder&65535)+(n>>>16);n=(e.highOrder>>>16)+(t.highOrder>>>16)+(r>>>16);i=(n&65535)<<16|r&65535;return new L(i,s)};const Q=function(e,t,r,n){let s,i,o,c;s=(e.lowOrder&65535)+(t.lowOrder&65535)+(r.lowOrder&65535)+(n.lowOrder&65535);i=(e.lowOrder>>>16)+(t.lowOrder>>>16)+(r.lowOrder>>>16)+(n.lowOrder>>>16)+(s>>>16);o=(i&65535)<<16|s&65535;s=(e.highOrder&65535)+(t.highOrder&65535)+(r.highOrder&65535)+(n.highOrder&65535)+(i>>>16);i=(e.highOrder>>>16)+(t.highOrder>>>16)+(r.highOrder>>>16)+(n.highOrder>>>16)+(s>>>16);c=(i&65535)<<16|s&65535;return new L(c,o)};const G=function(e,t,r,n,s){let i,o,c,l;i=(e.lowOrder&65535)+(t.lowOrder&65535)+(r.lowOrder&65535)+(n.lowOrder&65535)+(s.lowOrder&65535);o=(e.lowOrder>>>16)+(t.lowOrder>>>16)+(r.lowOrder>>>16)+(n.lowOrder>>>16)+(s.lowOrder>>>16)+(i>>>16);c=(o&65535)<<16|i&65535;i=(e.highOrder&65535)+(t.highOrder&65535)+(r.highOrder&65535)+(n.highOrder&65535)+(s.highOrder&65535)+(o>>>16);o=(e.highOrder>>>16)+(t.highOrder>>>16)+(r.highOrder>>>16)+(n.highOrder>>>16)+(s.highOrder>>>16)+(i>>>16);l=(o&65535)<<16|i&65535;return new L(l,c)};const X=(e,t,r)=>{return new L(e.highOrder&t.highOrder^e.highOrder&r.highOrder^t.highOrder&r.highOrder,e.lowOrder&t.lowOrder^e.lowOrder&r.lowOrder^t.lowOrder&r.lowOrder)};const Y=(e,t,r)=>{return new L(e.highOrder&t.highOrder^~e.highOrder&r.highOrder,e.lowOrder&t.lowOrder^~e.lowOrder&r.lowOrder)};const e1=(e,t)=>{if(t<=32){return new L(e.highOrder>>>t|e.lowOrder<<32-t,e.lowOrder>>>t|e.highOrder<<32-t)}else{return new L(e.lowOrder>>>t|e.highOrder<<32-t,e.highOrder>>>t|e.lowOrder<<32-t)}};const t1=(e,t)=>{if(t<=32){return new L(e.highOrder>>>t,e.lowOrder>>>t|e.highOrder<<32-t)}else{return new L(0,e.highOrder<<32-t)}};const r1=function(e){let t=e1(e,28);let r=e1(e,34);let n=e1(e,39);return new L(t.highOrder^r.highOrder^n.highOrder,t.lowOrder^r.lowOrder^n.lowOrder)};const n1=function(e){let t=e1(e,14);let r=e1(e,18);let n=e1(e,41);return new L(t.highOrder^r.highOrder^n.highOrder,t.lowOrder^r.lowOrder^n.lowOrder)};const s1=function(e){let t=e1(e,1),r=e1(e,8),n=t1(e,7);return new L(t.highOrder^r.highOrder^n.highOrder,t.lowOrder^r.lowOrder^n.lowOrder)};const i1=function(e){let t=e1(e,19);let r=e1(e,61);let n=t1(e,6);return new L(t.highOrder^r.highOrder^n.highOrder,t.lowOrder^r.lowOrder^n.lowOrder)};const o1=function(r){let n=[new L(1779033703,4089235720),new L(3144134277,2227873595),new L(1013904242,4271175723),new L(2773480762,1595750129),new L(1359893119,2917565137),new L(2600822924,725511199),new L(528734635,4215389547),new L(1541459225,327033209)];let s=[new L(1116352408,3609767458),new L(1899447441,602891725),new L(3049323471,3964484399),new L(3921009573,2173295548),new L(961987163,4081628472),new L(1508970993,3053834265),new L(2453635748,2937671579),new L(2870763221,3664609560),new L(3624381080,2734883394),new L(310598401,1164996542),new L(607225278,1323610764),new L(1426881987,3590304994),new L(1925078388,4068182383),new L(2162078206,991336113),new L(2614888103,633803317),new L(3248222580,3479774868),new L(3835390401,2666613458),new L(4022224774,944711139),new L(264347078,2341262773),new L(604807628,2007800933),new L(770255983,1495990901),new L(1249150122,1856431235),new L(1555081692,3175218132),new L(1996064986,2198950837),new L(2554220882,3999719339),new L(2821834349,766784016),new L(2952996808,2566594879),new L(3210313671,3203337956),new L(3336571891,1034457026),new L(3584528711,2466948901),new L(113926993,3758326383),new L(338241895,168717936),new L(666307205,1188179964),new L(773529912,1546045734),new L(1294757372,1522805485),new L(1396182291,2643833823),new L(1695183700,2343527390),new L(1986661051,1014477480),new L(2177026350,1206759142),new L(2456956037,344077627),new L(2730485921,1290863460),new L(2820302411,3158454273),new L(3259730800,3505952657),new L(3345764771,106217008),new L(3516065817,3606008344),new L(3600352804,1432725776),new L(4094571909,1467031594),new L(275423344,851169720),new L(430227734,3100823752),new L(506948616,1363258195),new L(659060556,3750685593),new L(883997877,3785050280),new L(958139571,3318307427),new L(1322822218,3812723403),new L(1537002063,2003034995),new L(1747873779,3602036899),new L(1955562222,1575990012),new L(2024104815,1125592928),new L(2227730452,2716904306),new L(2361852424,442776044),new L(2428436474,593698344),new L(2756734187,3733110249),new L(3204031479,2999351573),new L(3329325298,3815920427),new L(3391569614,3928383900),new L(3515267271,566280711),new L(3940187606,3454069534),new L(4118630271,4000239992),new L(116418474,1914138554),new L(174292421,2731055270),new L(289380356,3203993006),new L(460393269,320620315),new L(685471733,587496836),new L(852142971,1086792851),new L(1017036298,365543100),new L(1126000580,2618297676),new L(1288033470,3409855158),new L(1501505948,4234509866),new L(1607167915,987167468),new L(1816402316,1246189591)];let i=new Array(64);let o,c,l,a,u,f,h,g,e,t;let d,F;const w=r.length*p();r=E(r);r[w>>5]|=128<<24-w%32;r[(w+128>>10<<5)+31]=w;for(let t=0;t<r.length;t+=32){o=n[0];c=n[1];l=n[2];a=n[3];u=n[4];f=n[5];h=n[6];g=n[7];for(let e=0;e<80;e++){if(e<16){i[e]=new L(r[e*2+t],r[e*2+t+1])}else{i[e]=Q(i1(i[e-2]),i[e-7],s1(i[e-15]),i[e-16])}d=G(g,n1(u),Y(u,f,h),s[e],i[e]);F=W(r1(o),X(o,c,l));g=h;h=f;f=u;u=W(a,d);a=l;l=c;c=o;o=W(d,F)}n[0]=W(o,n[0]);n[1]=W(c,n[1]);n[2]=W(l,n[2]);n[3]=W(a,n[3]);n[4]=W(u,n[4]);n[5]=W(f,n[5]);n[6]=W(h,n[6]);n[7]=W(g,n[7])}let C=[];for(let e=0;e<n.length;e++){C.push(n[e].highOrder);C.push(n[e].lowOrder)}return C};const c1=function(e,t=false){if(t===true){if(w!==true){if(q(i.unicodeString())==i.testSHA512(true)){w=true}else{i.raiseError("SHA512/Hash/B64");return""}}return String(q(e))}else{if(F!==true){if(N(i.unicodeString())==i.testSHA512()){F=true}else{i.raiseError("SHA512/Hash/Hex");return""}}return String(N(e))}};t.sha512=c1;let l1=[];let a1=[];const u1=function(e){e=g.stringPureVal(e);e=g.utf8_encode(e);const l=(e,t)=>e>>>t|e<<32-t;const r=Math.pow;const n=r(2,32);const t="length";const s=e[t]*8;let a,u;let i="";let o=[];let f=l1=l1||[];let h=a1=a1||[];let c=h[t];if(c<=0){let t={};for(let e=2;c<64;e++){if(!t[e]){for(a=0;a<313;a+=e){t[a]=e}f[c]=r(e,.5)*n|0;h[c++]=r(e,1/3)*n|0}}}e+="\x80";while(e[t]%64-56){e+="\0"}for(a=0;a<e[t];a++){u=e.charCodeAt(a);if(u>>8){return""}o[a>>2]|=u<<(3-a)%4*8}o[o[t]]=s/n|0;o[o[t]]=s;for(u=0;u<o[t];){let c=o.slice(u,u+=16);let e=f;f=f.slice(0,8);for(a=0;a<64;a++){let e=a+u;let t=c[a-15],r=c[a-2];let n=f[0],s=f[4];let i=f[7]+(l(s,6)^l(s,11)^l(s,25))+(s&f[5]^~s&f[6])+h[a]+(c[a]=a<16?c[a]:c[a-16]+(l(t,7)^l(t,18)^t>>>3)+c[a-7]+(l(r,17)^l(r,19)^r>>>10)|0);let o=(l(n,2)^l(n,13)^l(n,22))+(n&f[1]^n&f[2]^f[1]&f[2]);f=[i+o|0].concat(f);f[4]=f[4]+i|0}for(a=0;a<8;a++){f[a]=f[a]+e[a]|0}}for(a=0;a<8;a++){for(u=3;u+1;u--){let e=f[a]>>u*8&255;i+=(e<16?0:"")+e.toString(16)}}return String(i||"")};const f1=e=>s.encode(g.hex2bin(u1(e),true),true);const h1=function(e,t=false){if(t===true){if(d!==true){if(f1(i.unicodeString())==i.testSHA256(true)){d=true}else{i.raiseError("SHA256/Hash/B64");return""}}return String(f1(e))}else{if(h!==true){if(u1(i.unicodeString())==i.testSHA256()){h=true}else{i.raiseError("SHA256/Hash/Hex");return""}}return String(u1(e))}};t.sha256=h1}};smartJ$CryptoHash.secureClass();if(typeof window!="undefined"){window.smartJ$CryptoHash=smartJ$CryptoHash}smartJ$CryptoBlowfish=new class{constructor(){"use strict";const w="smartJ$CryptoBlowfish";const e=this;const C=console;let t=false;e.secureClass=()=>{if(t===true){C.warn(w,"Class is already SECURED")}else{t=true;Object.freeze(e)}};const p=smartJ$Utils;const B=smartJ$Base64;const S=smartJ$BaseEncode;const A=smartJ$CryptoHash;const E={CBC:1};const r=Math.pow(2,2);const n=Math.pow(2,3);const s=Math.pow(2,4);const D=Math.pow(2,8);const b=Math.pow(2,16);const m=Math.pow(2,24);let O=null;let i=null;const a={p:[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],s0:[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],s1:[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],s2:[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],s3:[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]};const _="b"+"f"+56*8+"."+"v"+16/8;const y=function(e,t,r,n){let s=0,i=e&&e.length||0,o=new(n||Array)(i);if(i&&typeof e=="string"){e=e.split("")}if(typeof t=="string"){t=cache[t]||buildFn(t)}if(r){for(;s<i;++s){o[s]=t.call(r,e[s],s,e)}}else{for(;s<i;++s){o[s]=t(e[s],s,e)}}return o};const o=(e,t)=>{return(e>>16)+(t>>16)+((e&65535)+(t&65535)>>16)<<16|(e&65535)+(t&65535)&65535};const c=(e,t)=>{return(e>>16^t>>16)<<16|(e&65535^t&65535)&65535};const l=function(e,t){let r=t.s3[e&255];e>>=8;let n=t.s2[e&255];e>>=8;let s=t.s1[e&255];e>>=8;let i=t.s0[e&255];let o;o=(i>>16)+(s>>16)+((i&65535)+(s&65535)>>16)<<16|(i&65535)+(s&65535)&65535;o=(o>>16^n>>16)<<16|(o&65535^n&65535)&65535;return(o>>16)+(r>>16)+((o&65535)+(r&65535)>>16)<<16|(o&65535)+(r&65535)&65535};const g=function(e,t){let r=e.left;let n=e.right;r=c(r,t.p[0]);n=c(n,c(l(r,t),t.p[1]));r=c(r,c(l(n,t),t.p[2]));n=c(n,c(l(r,t),t.p[3]));r=c(r,c(l(n,t),t.p[4]));n=c(n,c(l(r,t),t.p[5]));r=c(r,c(l(n,t),t.p[6]));n=c(n,c(l(r,t),t.p[7]));r=c(r,c(l(n,t),t.p[8]));n=c(n,c(l(r,t),t.p[9]));r=c(r,c(l(n,t),t.p[10]));n=c(n,c(l(r,t),t.p[11]));r=c(r,c(l(n,t),t.p[12]));n=c(n,c(l(r,t),t.p[13]));r=c(r,c(l(n,t),t.p[14]));n=c(n,c(l(r,t),t.p[15]));r=c(r,c(l(n,t),t.p[16]));e.right=r;e.left=c(n,t.p[17])};const x=function(e,t){let r=e.left;let n=e.right;r=c(r,t.p[17]);n=c(n,c(l(r,t),t.p[16]));r=c(r,c(l(n,t),t.p[15]));n=c(n,c(l(r,t),t.p[14]));r=c(r,c(l(n,t),t.p[13]));n=c(n,c(l(r,t),t.p[12]));r=c(r,c(l(n,t),t.p[11]));n=c(n,c(l(r,t),t.p[10]));r=c(r,c(l(n,t),t.p[9]));n=c(n,c(l(r,t),t.p[8]));r=c(r,c(l(n,t),t.p[7]));n=c(n,c(l(r,t),t.p[6]));r=c(r,c(l(n,t),t.p[5]));n=c(n,c(l(r,t),t.p[4]));r=c(r,c(l(n,t),t.p[3]));n=c(n,c(l(r,t),t.p[2]));r=c(r,c(l(n,t),t.p[1]));e.right=r;e.left=c(n,t.p[0])};const u=e=>{return typeof e=="string"||e instanceof String};const I=function(e){let n=e;if(u(n)){n=y(n.split(""),e=>{return e.charCodeAt(0)&255})}let s=0,i=0;let t={left:0,right:0};let r,o,c;let l={p:y(a.p.slice(0),e=>{let t=n.length,r;for(r=0;r<4;r++){i=i*D|n[s++%t]}return(e>>16^i>>16)<<16|(e&65535^i&65535)&65535}),s0:a.s0.slice(0),s1:a.s1.slice(0),s2:a.s2.slice(0),s3:a.s3.slice(0)};for(r=0,c=l.p.length;r<c;){g(t,l);l.p[r++]=t.left,l.p[r++]=t.right}for(r=0;r<4;r++){for(o=0,c=l["s"+r].length;o<c;){g(t,l);l["s"+r][o++]=t.left,l["s"+r][o++]=t.right}}return l};const J=function(e){const t="setKey";e=p.stringPureVal(e,true);let r=e.length;if(r<7){C.warn(w,t,"Key Size is lower than 7 bytes ("+r+") !");return""}else if(r>4096){C.warn(w,t,"Key Size is higher than 4096 bytes ("+r+") !");return""}const n="\0";const s=String(n+e);const i=String(A.crc32b(e)+n+A.md5(e)+n+A.sha1(e)+n+A.sha256(e)+n+A.sha512(e));const o=String(A.crc32b(s)+n+A.md5(s)+n+A.sha1(s)+n+A.sha256(s)+n+A.sha512(s));const c=String(i+n+o);const l=String(S.base_from_hex_convert(A.sha256(c),92))+"'"+String(S.base_from_hex_convert(A.md5(c),92));const a=String(l).substr(0,448/8);return String(a)};const v=function(e){const t="setIV";e=p.stringPureVal(e,true);let r=e.length;if(r<7){C.warn(w,t,"Key Size is lower than 7 bytes ("+r+") !");return""}else if(r>4096){C.warn(w,t,"Key Size is higher than 4096 bytes ("+r+") !");return""}const n=String(A.crc32b(e,true)).padStart(8,"0");i=String(String(n)+":"+A.sha1(e,true)).substr(0,64/8);const s=y(i.split(""),e=>{return e.charCodeAt(0)});O={};O.left=s[0]*m|s[1]*b|s[2]*D|s[3];O.right=s[4]*m|s[5]*b|s[6]*D|s[7];return String(i)};const f=function(t,e){const r="encrypt";t=p.stringPureVal(t);if(t==""){return""}t=B.encode(t);e=p.stringPureVal(e);const n=v(e);e=J(e);if(e.length!=56){C.error(w,r,"Invalid Key Length (req. 448 bytes)");return""}if(n.length!=8){C.error(w,r,"Invalid iV Length (req. 64 bytes)");return""}const s=E.CBC;const i=I(e);t=String(t+"#CKSUM256#"+A.sha256(t,true));const o=8-(t.length&7);for(let e=0;e<o;e++){t+=" "}let c=[];const l=t.length>>3;let a=0,u={};const f=s==E.CBC;const h={left:O.left||null,right:O.right||null};for(let e=0;e<l;e++){u.left=t.charCodeAt(a)*m|t.charCodeAt(a+1)*b|t.charCodeAt(a+2)*D|t.charCodeAt(a+3);u.right=t.charCodeAt(a+4)*m|t.charCodeAt(a+5)*b|t.charCodeAt(a+6)*D|t.charCodeAt(a+7);if(f){u.left=(u.left>>16^h.left>>16)<<16|(u.left&65535^h.left&65535)&65535;u.right=(u.right>>16^h.right>>16)<<16|(u.right&65535^h.right&65535)&65535}g(u,i);if(f){h.left=u.left;h.right=u.right}c.push(u.left>>24&255);c.push(u.left>>16&255);c.push(u.left>>8&255);c.push(u.left&255);c.push(u.right>>24&255);c.push(u.right>>16&255);c.push(u.right>>8&255);c.push(u.right&255);a+=8}return _+"!"+S.b64s_enc(y(c,e=>String.fromCharCode(e)).join(""),true)};e.encrypt=f;const h=function(e,t){const r="decrypt";e=p.stringPureVal(e,true);if(e==""){return""}if(!p.stringStartsWith(e,_+"!")){return""}e=e.split("!",2);e=p.stringPureVal(e[1],true);t=p.stringPureVal(t);const n=v(t);t=J(t);if(t.length!=56){C.error(w,r,"Invalid Key Length (req. 448 bytes)");return""}if(n.length!=8){C.error(w,r,"Invalid iV Length (req. 64 bytes)",n);return""}const s=E.CBC;const i=I(t);let o=[];let c=null;c=y(S.b64s_dec(e,true).split(""),function(e){return e.charCodeAt(0)});e=null;const l=c.length>>3;let a=0,u={};const f=s==E.CBC;const h={left:O.left||null,right:O.right||null};for(let e=0;e<l;e++){u.left=c[a]*m|c[a+1]*b|c[a+2]*D|c[a+3];u.right=c[a+4]*m|c[a+5]*b|c[a+6]*D|c[a+7];let e=null,t=null;if(f){e=u.left;t=u.right}x(u,i);if(f){u.left=(u.left>>16^h.left>>16)<<16|(u.left&65535^h.left&65535)&65535;u.right=(u.right>>16^h.right>>16)<<16|(u.right&65535^h.right&65535)&65535;h.left=e;h.right=t}o.push(u.left>>24&255);o.push(u.left>>16&255);o.push(u.left>>8&255);o.push(u.left&255);o.push(u.right>>24&255);o.push(u.right>>16&255);o.push(u.right>>8&255);o.push(u.right&255);a+=8}let g=String(p.stringTrim(y(o,e=>String.fromCharCode(e)).join("")));let d=g.split("#CKSUM256#",2);g=p.stringPureVal(d[0],true);const F=p.stringPureVal(d[1],true);d=null;if(A.sha256(g,true)!==String(F)){C.warn(w,"decrypt","Checksum Failed");return""}return String(B.decode(g))};e.decrypt=h}};smartJ$CryptoBlowfish.secureClass();if(typeof window!="undefined"){window.smartJ$CryptoBlowfish=smartJ$CryptoBlowfish}const smartJ$DhKx=new class{constructor(){"use strict";const u="smartJ$DhKx";const l=this;const f=console;let e=false;l.secureClass=()=>{if(e===true){f.warn(u,"Class is already SECURED")}else{e=true;Object.freeze(l)}};let t=typeof window!="undefined"?window:null;const h=smartJ$Utils;const c=smartJ$BaseEncode;const a=smartJ$CryptoHash;const g=smartJ$CryptoBlowfish;const r=typeof smartJ$Options!="undefined"&&smartJ$Options&&smartJ$Options.DhKx!=undefined&&typeof smartJ$Options==="object"&&typeof smartJ$Options.DhKx==="object"?smartJ$Options.DhKx:null;const n=r&&!!r.BigIntSupport||t&&t.crypto&&t.crypto.getRandomValues&&t.BigInt?true:false;l.param_Size=r&&typeof r.Size=="string"&&r.Size?h.stringTrim(r.Size):"default";l.param_Prix=r&&typeof r.Prix=="string"&&r.Prix?h.stringTrim(r.Prix):"default";l.param_UseBigInt=n&&(r&&!!r.UseBigInt)?true:false;l.param_DevMode=r&&!!r.DevMode?true:false;t=null;const d=function(){let e="??";if(l.param_UseBigInt===true){e="BigInt"}else{e="Int64"}return String(e)};l.getMode=d;const F=function(e){e=h.stringPureVal(e,true);if(e===""||e==="default"){e=l.param_Size}return D(String(e))};l.getBaseGen=F;const w=function(e){const t=String(l.param_Size);const r=String(l.param_Prix);const n=m(r);const s=D(t);const i=b(e,s,n);return{base:e,prix:r,sec:s,pub:i}};l.getSrvData=w;const C=function(e,t){const r=String(l.param_Prix);const n=m(r);const s=b(t,e,n);return E(s)};l.getSrvShad=C;const p=function(e){const t=String(l.param_Size);const r=String(l.param_Prix);const n=m(r);const s=D(t);const i=b(e,s,n);return{base:e,prix:r,sec:s,pub:i}};l.getCliData=p;const B=function(e,t){const r=String(l.param_Prix);const n=m(r);const s=b(t,e,n);return E(s)};l.getCliShad=B;const s=function(t){t=h.stringPureVal(t,true);let r="";let n="";if(t==""){r="Empty Idz"}else{let e=o(t);if(e.err&&e.err!=""){r=String(e.err)}else{n=h.stringPureVal(B(e.csec,e.spub),true);if(n==""){r="Empty Shad"}}}return{type:"IdzShadData",mode:String(d()),size:String(l.param_Size),prix:String(l.param_Prix),shad:String(n),err:String(r)}};l.getIdzShadData=s;const i=function(){const e=String(d());if(l.param_DevMode!==true){const c="Development Mode is N/A";f.warn(u,"getData",c);return{err:String(c)}}f.log(u,"[NOTICE]: getData: development mode is enabled","["+e+"]");const t=F(l.param_Size);const r=w(t);const n=p(t);const s=C(r.sec,n.pub);const i=B(n.sec,r.pub);let o="";if(s==undefined||s==""||s=="0"||s!==i){o="Shad Mismatch"}return{type:"Data",mode:String(e),size:String(l.param_Size),prix:String(l.param_Prix),prim:String(m(String(l.param_Prix))),basegen:String(t),srv:{sec:String(r.sec),pub:String(r.pub),shad:String(s)},cli:{sec:String(n.sec),pub:String(n.pub),shad:String(i)},idz:String(S(n.sec,r.pub)),err:String(o)}};l.getData=i;const o=function(e){e=h.stringPureVal(e,true);if(e==""){return{err:"Invalid IDZ (1)"}}if(!h.stringContains(e,"!")){return{err:"Invalid IDZ (2)"}}const t=e.split("!");if(t.length!==3){return{err:"Invalid IDZ (3)"}}const r="dH.";const n="v1";let s="";let i="0";if(l.param_UseBigInt===true){s="iHg.";i="1"}else{s="i64.";i="2"}if(t[0]!==r+s+n){return{err:"Invalid IDZ (4."+i+")"}}t[1]=h.stringPureVal(c.b64s_dec(t[1]),true);if(t[1]==""){return{err:"Invalid IDZ (5)"}}t[2]=h.stringPureVal(c.b64s_dec(t[2]),true);if(t[2]==""){return{err:"Invalid IDZ (6)"}}const o=h.stringTrim(c.base_to_hex_convert(t[2],85));if(o==""){return{err:"Invalid IDZ (7)"}}t[2]=h.stringTrim(String(h.stringTrim(h.hex2bin(o))).substr(1));if(t[2]==""){return{err:"Invalid IDZ (8)"}}t[1]=h.stringPureVal(g.decrypt(String(t[1]),c.base_from_hex_convert(a.sha256("&="+o+"#"),92)),true);if(t[1]==""){return{err:"Invalid IDZ (9)"}}t[1]=h.stringTrim(String(h.hex2bin(h.stringTrim(c.base_to_hex_convert(t[1],92)))).substr(1));if(t[1]==""){return{err:"Invalid IDZ (10)"}}return{csec:String(t[1]),spub:String(t[2])}};const S=function(e,t){let r="dH";if(l.param_UseBigInt===true){r+=".iHg"}else{r+=".i64"}const n=h.bin2hex("@"+t);return String(r+".v1!"+c.b64s_enc(g.encrypt(c.base_from_hex_convert(h.bin2hex("$"+e),92),c.base_from_hex_convert(a.sha256("&="+n+"#"),92)))+"!"+c.b64s_enc(c.base_from_hex_convert(n,85)))};const A=function(e){e=h.stringPureVal(e,true);const t=e.length;if(t<=0){e="00"}else if(t%2!==0){e="0"+e}return String(e)};const E=function(e){let t="";if(l.param_UseBigInt===true){const r=String(A(e.toString(16)));t=c.base_from_hex_convert(r,92)}else{const r=String(A(e.toString(16)));t=c.base_from_hex_convert(r,85)+"'"+c.base_from_hex_convert(r,62)+"'"+c.base_from_hex_convert(r,92)+"'"+c.base_from_hex_convert(r,58)}return String(t)};const D=e=>{if(l.param_UseBigInt===true){return _(e)}else{return O(e)}};const b=(e,t,r)=>{if(l.param_UseBigInt===true){return x(e,t,r)}else{return y(e,t,r)}};const m=e=>{if(l.param_UseBigInt===true){return J(e)}else{return I(e)}};const O=function(e){e=h.stringPureVal(e,true);if(e===""||e==="default"){e=24}e=Math.ceil(e);switch(e){case 12:case 16:case 24:break;default:e=24;f.warn(u,"rngInt64: Invalid Size Selection, using defaults:",e)}let t=~~(Math.random()*(Math.pow(2,e)-1))>>>0;if(t<=0){t=1}return t};const _=function(e){e=h.stringPureVal(e,true);if(e===""||e==="default"){e=16}e=Math.ceil(e);switch(e){case 128:case 96:case 64:case 48:case 32:case 16:case 8:break;default:e=16;f.warn(u,"rngBigint: Invalid Size Selection, using defaults:",e)}const r=new Uint32Array(e);for(let e=0,t=r.length;e<t;e++){r[e]=Math.floor(Math.random()*256)}return String(Array.from(r).map(e=>String(e)).join(""))};const y=(e,t,r)=>{if(t<=0){return 1}else if(t===1){return e%r}else if(t%2===0){return y(e*e%r,t/2|0,r)%r}else{return y(e*e%r,t/2|0,r)*e%r}};const x=(e,t,r)=>{e=BigInt(e);t=BigInt(t);r=BigInt(r);if(t<=BigInt(0)){return BigInt(1)}else if(t==BigInt(1)){return e%r}else if(t%BigInt(2)==BigInt(0)){return x(e*e%r,t/BigInt(2),r)%r}else{return x(e*e%r,t/BigInt(2),r)*e%r}};const I=function(e){const t=[72419213,54795931,32926051,21801887,77635013,25470191,77639819,42010253,33563273,32792339,15923857,67022173,84250253,67680727,63438329,52164643,51603269,61444631,58831133,55711141,73596863,48905489,61642963,53812273,16600799,79158229,56490361,73391389,64351751,14227727,40517299,95234563,42913363,63566527,52338703,80146337,37597201,93581269,32547497,75587359,26024821,57042743,13862969,46496719,42787387,29830469,59912407,75206447,40343341,72357113,23434063,24336373,39422399,12866611,11592293,83937899,79746883,37997129,76431193,67774627,72107393,31363271,30388361,25149569,54104161,50575709,70327973,54960077,92119793,80615231,38967139,65609657,66432673,56145097,73864853,70708361,23913011,35283481,58352201,57881491,89206109,70619069,96913759,66156679,63395257,70022237,93547543,10891057,75492367,86902223,33054397,36325571,49119293,64100537,31986431,16636237];e=h.stringPureVal(e,true);if(e===""||e==="default"){e=-1}e=Math.floor(e);let r=t[47];if(e>=0&&e<t.length){r=t[e]}else if(e!==-1){f.warn(u,"prime: Invalid Prime Selection (Int64), using defaults:",e)}return"0x"+r.toString(16)};const J=function(e){const t="FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A63";const r="7ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE";const n="45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D670C354E4ABC9804F1746C08CA";const s="18217C32905E462E36CE3BE39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF6955817183995497CEA956AE515D2261898FA051015728E5A8AA";const i="AC42DAD33170D04507A33A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6BF12FFA06D98A0864D87602733EC86A64521F2B18177B200CBBE117577A615D6C770988C0BAD946E208E24FA074E5AB3143DB5BFCE0FD108E4B82D120A9";const o="2108011A723C12A787E6D788719A10BDBA5B2699C327186AF4E23C1A946834B6150BDA2583E9CA2AD44CE8DBBBC2DB04DE8EF92E8EFC141FBECAA6287C59474E6BC05D99B2964FA090C3A2233BA186515BE7ED1F612970CEE2D7AFB81BDD762170481CD0069127D5B05AA993B4EA988D8FDDC186FFB7DC90A6C08F4DF435C9340";const c="2849236C3FAB4D27C7026C1D4DCB2602646DEC9751E763DBA37BDF8FF9406AD9E530EE5DB382F413001AEB06A53ED9027D831179727B0865A8918DA3EDBEBCF9B14ED44CE6CBACED4BB1BDB7F1447E6CC254B332051512BD7AF426FB8F401378CD2BF5983CA01C64B92ECF032EA15D1721D03F482D7CE6E74FEF6D55E702F46980C82B5A84031900B1C9E59E7C97FBEC7E8F323A97A7E36CC88BE0F1D45B7FF585AC54BD407B22B4154AACC8F6D7EBF48E1D814CC5ED20F8037E0A79715EEF29BE32806A1D58BB7C5DA76F550AA3D8A1FBFF0EB19CCB1A313D55CDA56C9EC2EF29632387FE8D76E3C0468043E8F663F4860EE12BF2D5B0B7474D6E694F91E6D";const l={h017:"0x1141317432f7b89",h031:"0x6febe061005175e46c896e4079",h047:"0xf3f2b0ee30050c5f6bfcb9df1b9454e77bc3503",h061:"0x4771cfc3c2b8ad4561cb5437132e35e8398e8f956a2f2c94c51",h097:"0x426f09b2b25aba6bbcbf9ca5edb660b91d033440916732af9ae175a84afb665a25b392361c6952119",h127:"0x2c6121e6b14ecf756c083544de0e0933cac90dbeb6239905bfbec764527bbb4166ff832a2bcc3b4d6f634eddd30e40634adbbb5bfd",h257:"0x279e569032f0c7256218b58ad6418aa0e9436be424ab8f1431b1f9e6b5814e0ebda0ff65ef085d7e73fee51744dec07fe08c1a1cc65855630ca983927ca277406ac42094064387d65aeaa849f9bf449e04df8cb0e99a44b004ce0efca3386f1e82c078723cd265288d9a41",h232c1:"0x"+t+"A3620FFFFFFFFFFFFFFFF",h309c2:"0x"+t+r+"65381FFFFFFFFFFFFFFFF",h463c5:"0x"+t+r+n+"237327FFFFFFFFFFFFFFFF",h617c14:"0x"+t+r+n+s+"CAA68FFFFFFFFFFFFFFFF",h925c15:"0x"+t+r+n+s+i+"3AD2CAFFFFFFFFFFFFFFFF",h1234c16:"0x"+t+r+n+s+i+o+"63199FFFFFFFFFFFFFFFF",h1850c17:"0x"+t+r+n+s+i+o+c+"CC4024FFFFFFFFFFFFFFFF",h2467c18:"0x"+t+r+n+s+i+o+c+"BE115974A3926F12FEE5E438777CB6A932DF8CD8BEC4D073B931BA3BC832B68D9DD300741FA7BF8AFC47ED2576F6936BA424663AAB639C5AE4F5683423B4742BF1C978238F16CBE39D652DE3FDB8BEFC848AD922222E04A4037C0713EB57A81A23F0C73473FC646CEA306B4BCBC8862F8385DDFA9D4B7FA2C087E879683303ED5BDD3A062B3CF5B3A278A66D2A13F83F44F82DDF310EE074AB6A364597E899A0255DC164F31CC50846851DF9AB48195DED7EA1B1D510BD7EE74D73FAF36BC31ECFA268359046F4EB879F924009438B481C6CD7889A002ED5EE382BC9190DA6FC026E479558E4475677E9AA9E3050E2765694DFC81F56E880B96E7160C980DD98EDD3DFFFFFFFFFFFFFFFFF"};let a=null;e=h.stringPureVal(e,true);if(e===""){e="default"}switch(String(e)){case"h017":case"h031":case"h047":case"h061":case"h097":case"h127":case"h257":case"h232c1":case"h309c2":case"h463c5":case"h617c14":case"h925c15":case"h1234c16":case"h1850c17":case"h2467c18":a=l[String(e)];break;default:if(e!=="default"){f.warn(u,"prime: Invalid Prime Selection (Bigint), using defaults:",e)}a=l["h127"]}return String(a)}}};smartJ$DhKx.secureClass();if(typeof window!="undefined"){window.smartJ$DhKx=smartJ$DhKx}
// #END
